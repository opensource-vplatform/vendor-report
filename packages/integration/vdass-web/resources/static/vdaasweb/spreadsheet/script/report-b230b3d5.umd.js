!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom/client")):"function"==typeof define&&define.amd?define(["react","react-dom/client"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).TOONE=e.TOONE||{},e.TOONE.Report=t(e.React,e.ReactDOM))}(this,(function(e,t){"use strict";var r=".",n=function(e){r=e},o=function(){return r},a=function(){return window.GC},i=function(e,t){if(e){e.suspendPaint(),e.suspendCalcService();var r=e.getActiveSheet();try{t(r)}finally{e.resumeCalcService(!1),e.resumePaint()}}},u={print:["print.min.js"]};var l=function(){var e=a().Spread.Sheets.productInfo.productVersion;return`${o()}/vendor/excel/${e}`},s=function(e){return`${l()}/plugins/${e}`},c=a(),f={dashed:c.Spread.Sheets.LineStyle.dashed,dotted:c.Spread.Sheets.LineStyle.dotted,double:c.Spread.Sheets.LineStyle.double,empty:c.Spread.Sheets.LineStyle.empty,thick:c.Spread.Sheets.LineStyle.thick,thin:c.Spread.Sheets.LineStyle.thin},h={center:c.Spread.Sheets.HorizontalAlign.center,left:c.Spread.Sheets.HorizontalAlign.left,right:c.Spread.Sheets.HorizontalAlign.right},d={center:c.Spread.Sheets.VerticalAlign.center,bottom:c.Spread.Sheets.VerticalAlign.bottom,top:c.Spread.Sheets.VerticalAlign.top};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:String(t)}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function w(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var m=function(){function e(t,r){p(this,e),this.color=t,this.style=r}return w(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStyle",value:function(e){this.style=e}},{key:"getStyle",value:function(){return this.style}},{key:"_to",value:function(){return new(a().Spread.Sheets.LineBorder)(this.color,this.style)}}]),e}();document.createElement("span");var b=function(e,t){return null==e?t:e},S=function(e,t,r){var n=a(),o=r.fontWeight,i=r.fontStyle,u=r.fontFamily,l=r.fontSize,s=r.textDecoration,c=r.backColor,f=r.foreColor,h=r.wordWrap;!function(e,t,r){for(var n=e.col,o=e.row,a=e.rowCount,i=e.colCount,u=0;u<a;u++)for(var l=0;l<i;l++)r(t,o+u,n+l)}(t,e,(function(e,t,r){var a=new n.Spread.Sheets.Style,d=e.getStyle(t,r),p=function(e){var t="normal",r="normal",n="normal",o="Calibri";if(e)for(var a,i=e.split(/\s+/);a=i.shift();)switch(a){case"normal":break;case"italic":case"oblique":t=a;break;case"small-caps":r=a;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":n=a;break;default:o=a,i.length&&(o+=" "+i.join(" "))}return{fontStyle:t,fontVariant:r,fontWeight:n,fontSize:11,lineHeight:"normal",fontFamily:o}}(d.font);Object.assign(a,d),u=b(u,p.fontFamily),l=b(l,p.fontSize),i=b(i,p.fontStyle),o=b(o,p.fontWeight),s=b(s,d.textDecoration),c=b(c,d.backColor),f=b(f,d.foreColor);var v=function(e){return e&&-1===e.indexOf("'")&&-1===e.indexOf('"')?`"${e}"`:e}(u),g=function(e){var t=e.fontFamily,r=void 0===t?"":t,n=e.fontStyle,o=void 0===n?"":n,a=e.fontVariant,i=void 0===a?"":a,u=e.fontWeight,l=void 0===u?"":u,s=e.fontSize,c=void 0===s?"":s,f=e.lineHeight,h=[o,i,l,c,void 0===f?"":f,r].join(" "),d=document.createElement("span");return d.style.font=h,d.style.font}({fontFamily:v,fontSize:l?`${l}pt`:"",fontStyle:i,fontWeight:o});a.font=g,a.textDecoration=s,a.backColor=c,a.foreColor=f,a.wordWrap=h,e.setStyle(t,r,a)}))},C=function(){function e(t,r){p(this,e),this.sheet=t,this.cellRange=r}return w(e,[{key:"hAlign",value:function(e){this.cellRange.hAlign(e)}},{key:"vAlign",value:function(e){this.cellRange.vAlign(e)}},{key:"setBorder",value:function(e,t){this.cellRange.setBorder(e,t)}},{key:"fontFamily",value:function(e){S(this.sheet,this.cellRange,{fontFamily:e})}},{key:"fontSize",value:function(e){S(this.sheet,this.cellRange,{fontSize:e})}},{key:"fontStyle",value:function(e){S(this.sheet,this.cellRange,{fontStyle:e})}},{key:"fontWeight",value:function(e){S(this.sheet,this.cellRange,{fontWeight:e})}},{key:"wordWrap",value:function(e){S(this.sheet,this.cellRange,{wordWrap:e})}}]),e}(),O=function(){function e(t){p(this,e),this.sheet=t}return w(e,[{key:"name",value:function(e){this.sheet.name(e)}},{key:"getCell",value:function(e,t){var r=this.sheet.getCell(e,t);return new C(this.sheet,r)}},{key:"getRange",value:function(e,t,r,n){var o=this.sheet.getRange(e,t,r,n);return new C(this.sheet,o)}},{key:"addSpan",value:function(e,t,r,n){this.sheet.addSpan(e,t,r,n)}},{key:"addRows",value:function(e,t){this.sheet.addRows(e,t)}},{key:"addColumns",value:function(e,t){this.sheet.addColumns(e,t)}},{key:"setValue",value:function(e,t,r){this.sheet.setValue(e,t,r)}},{key:"setFormula",value:function(e,t,r){this.sheet.setFormula(e,t,r)}},{key:"setRowCount",value:function(e){this.sheet.setRowCount(e)}},{key:"setRowHeight",value:function(e,t){this.sheet.setRowHeight(e,t)}},{key:"setColumnCount",value:function(e){this.sheet.setColumnCount(e)}},{key:"setColumnWidth",value:function(e,t){this.sheet.setColumnWidth(e,t)}},{key:"setDefaults",value:function(e){Object.assign(this.sheet.defaults,e)}},{key:"setOptions",value:function(e){var t=e.colHeaderVisible,r=void 0===t||t,n=e.rowHeaderVisible,o=void 0===n||n,a=e.showHorizontalGridline,i=void 0===a||a,u=e.showVerticalGridline,l=void 0===u||u,s=e.isProtected,c=void 0!==s&&s;Object.assign(this.sheet.options,{colHeaderVisible:r,rowHeaderVisible:o,isProtected:c}),Object.assign(this.sheet.options.gridline,{showHorizontalGridline:i,showVerticalGridline:l})}}]),e}(),E=function(){function e(t){p(this,e),this.spread=t}return w(e,[{key:"addSheet",value:function(e){this.spread.addSheet(e)}},{key:"getSheet",value:function(e){var t=this.spread.getSheet(e);return t?new O(t):null}},{key:"setOptions",value:function(e){var t=e.newTabVisible,r=void 0===t||t,n=e.tabStripVisible,o=void 0===n||n,a=e.showHorizontalScrollbar,i=void 0===a||a,u=e.showVerticalScrollbar,l=void 0===u||u;Object.assign(this.spread.options,{newTabVisible:r,tabStripVisible:o,showHorizontalScrollbar:i,showVerticalScrollbar:l})}}]),e}();function R(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function A(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e,t,r,n,o,a,i){try{var u=e[a](i),l=u.value}catch(s){return void r(s)}u.done?t(l):Promise.resolve(l).then(n,o)}function x(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){j(a,n,o,i,u,"next",e)}function u(e){j(a,n,o,i,u,"throw",e)}i(void 0)}))}}function k(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P={exports:{}},M={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(M);var I=M.exports;!function(e){var t=I.default;function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=r=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var n,o={},a=Object.prototype,i=a.hasOwnProperty,u=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},s=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(N){h=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),i=new T(n||[]);return u(a,"_invoke",{value:k(e,r,i)}),a}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}o.wrap=d;var v="suspendedStart",g="suspendedYield",y="executing",w="completed",m={};function b(){}function S(){}function C(){}var O={};h(O,s,(function(){return this}));var E=Object.getPrototypeOf,R=E&&E(E(D([])));R&&R!==a&&i.call(R,s)&&(O=R);var A=C.prototype=b.prototype=Object.create(O);function j(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,r){function n(o,a,u,l){var s=p(e[o],e,a);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==t(f)&&i.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,u,l)}),(function(e){n("throw",e,u,l)})):r.resolve(f).then((function(e){c.value=e,u(c)}),(function(e){return n("throw",e,u,l)}))}l(s.arg)}var o;u(this,"_invoke",{value:function(e,t){function a(){return new r((function(r,o){n(e,t,r,o)}))}return o=o?o.then(a,a):a()}})}function k(e,t,r){var o=v;return function(a,i){if(o===y)throw new Error("Generator is already running");if(o===w){if("throw"===a)throw i;return{value:n,done:!0}}for(r.method=a,r.arg=i;;){var u=r.delegate;if(u){var l=P(u,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===v)throw o=w,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var s=p(e,t,r);if("normal"===s.type){if(o=r.done?w:g,s.arg===m)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=w,r.method="throw",r.arg=s.arg)}}}function P(e,t){var r=t.method,o=e.iterator[r];if(o===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var a=p(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,m;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(i.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=C,u(A,"constructor",{value:C,configurable:!0}),u(C,"constructor",{value:S,configurable:!0}),S.displayName=h(C,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,h(e,f,"GeneratorFunction")),e.prototype=Object.create(A),e},o.awrap=function(e){return{__await:e}},j(x.prototype),h(x.prototype,c,(function(){return this})),o.AsyncIterator=x,o.async=function(e,t,r,n,a){void 0===a&&(a=Promise);var i=new x(d(e,t,r,n),a);return o.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},j(A),h(A,f,"Generator"),h(A,s,(function(){return this})),h(A,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},o.values=D,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return u.type="throw",u.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(l&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),m}},o}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(P);var T=(0,P.exports)(),D=T;try{regeneratorRuntime=T}catch(it){"object"==typeof globalThis?globalThis.regeneratorRuntime=T:Function("r","regeneratorRuntime = r")(T)}const N=k(D);var F=function(e){return e?"string"==typeof e&&(e=[e]):e=[],e},V=function(){function e(){p(this,e),this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptMaps={},this._dataPromises={}}var t,r,n,o,a,i,u,l;return w(e,[{key:"loadScript",value:(l=x(N.mark((function e(t){var r,n,o,a=this;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],(t=F(t)).forEach((function(e){(n=a._scriptMaps[e]=a._scriptMaps[e]||{}).promise||(n.path=e,n.promise=new Promise((function(t){(r=a.createScriptElement()).setAttribute("type","text/javascript"),r.src=e,r.addEventListener("load",t),a._head.appendChild(r)}))),o.push(n.promise)})),e.abrupt("return",Promise.all(o));case 4:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"unloadScript",value:(u=x(N.mark((function e(t){var r,n=this;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=F(t)).forEach((function(e){(r=n._head.querySelectorAll('script[src="'+e+'"]')[0])&&(n._head.removeChild(r),delete n._scriptMaps[e])})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"createScriptElement",value:function(){return document.createElement("script")}},{key:"fetchData",value:(i=x(N.mark((function e(t){var r,n,o=arguments;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},n=t+JSON.stringify(r),r.cache=void 0===r.cache||r.cache,t){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this._dataPromises[n]&&r.cache){e.next=16;break}return e.prev=6,e.next=9,fetch(t,r);case 9:this._dataPromises[n]=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),this._dataPromises[n]=null,e.t0;case 16:return e.abrupt("return",this._dataPromises[n]);case 17:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return i.apply(this,arguments)})},{key:"loadCss",value:(a=x(N.mark((function e(t){var r=this;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=F(t)).forEach((function(e){if(!r._cssPaths[e]){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),r._head.appendChild(t),r._cssPaths[e]=t}})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"unloadCss",value:(o=x(N.mark((function e(t){var r,n=this;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=F(t)).forEach((function(e){(r=n._cssPaths[e])&&(n._head.removeChild(r),n._cssPaths[e]=null)})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadTemplate",value:(n=x(N.mark((function e(t,r){var n;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.fetchTemplate(t);case 4:if(n=e.sent,!r){e.next=8;break}return r.innerHTML=n,e.abrupt("return",r);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchTemplate",value:(r=x(N.mark((function e(t){var r;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"flush",value:(t=x(N.mark((function e(){var t,r;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadCss(Object.getOwnPropertyNames(this._cssPaths));case 2:this._cssPaths={},e.t0=N.keys(this._scriptMaps);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(t=e.t1.value,!this._scriptMaps.hasOwnProperty(t)){e.next=10;break}return r=this._scriptMaps[t],e.next=10,this.unloadScript(r.path);case 10:e.next=4;break;case 12:this._scriptMaps={},this._dataPromises={};case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),L=new V;function J(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");e.dispatchEvent(t)}}function W(e,t){var r=window.URL||window.webkitURL,n=document.createElement("a");n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin==window.location.origin?J(n):function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return 200<=t.status&&t.status<=299}(n.href)||(n.target="_blank",J(n))):(n.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(n.href)}),4e4),setTimeout((function(){J(n)}),0))}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e,t){if(e){if("string"==typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(e,t):void 0}}function U(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,u=[],l=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(c){s=!0,o=c}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return u}}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var G,Q={exports:{}},Z={};Q.exports=function(){if(G)return Z;G=1;var t=e,r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var u,l={},s=null,c=null;for(u in void 0!==n&&(s=""+n),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,u)&&!i.hasOwnProperty(u)&&(l[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps)void 0===l[u]&&(l[u]=t[u]);return{$$typeof:r,type:e,key:s,ref:c,props:l,_owner:a.current}}return Z.Fragment=n,Z.jsx=u,Z.jsxs=u,Z}();var Y=Q.exports,X=a();function K(){this.name="TOONE.GET",this.maxArgs=2,this.minArgs=1}K.prototype=new X.Spread.CalcEngine.Functions.Function,K.prototype.isContextSensitive=function(){return!0},K.prototype.evaluate=function(e){var t,r,n=null==e||null===(t=e.source)||void 0===t?void 0:t.getSheet(),o=null==e||null===(r=e.Whe)||void 0===r?void 0:r.arguments;if(o&&n)if(1==o.length){var a=o[0].value,i=n.getDataSource();if(i)return i.getValue(a)}else{var u=o[0].value,l=o[1].value,s=n.getDataSource();if(s){var c=s.getValue(u);if(c&&c.length>0)return c[0][l]}}return""};var q=function(e){!function(e){var t=new K;e.addCustomFunction(t)}(e)};const _="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABkCAYAAACWy14QAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlBNDFDQzUzRkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlBNDFDQzU0RkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUE0MUNDNTFGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUE0MUNDNTJGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52RmQBAAAR1klEQVR42uxd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";var $=["children"],ee=["children"],te=["children"];function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oe,ae=function(e){return function(t){var r=t.children,n=R(t,$);return Y.jsx("div",ne(ne({style:e},n),{},{children:r}))}},ie=function(e){return function(t){var r=t.children,n=R(t,ee);return Y.jsx("span",ne(ne({style:e},n),{},{children:r}))}},ue=ae({color:"#6a6a6a",textAlign:"center",verticalAlign:"middle",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"440px",whiteSpace:"nowrap"}),le=(oe={display:"inline-block",width:"100px",height:"105px",verticalAlign:"middle"},function(e){var t=e.children,r=R(e,te);return Y.jsx("img",ne(ne({style:oe},r),{},{children:t}))}),se=ie({display:"inline-block",paddingLeft:"10px",textAlign:"left",verticalAlign:"middle",fontSize:"14px"}),ce=ie({display:"inline-block",fontSize:"20px",fontWeight:"600",opacity:"0.8"});function fe(){return Y.jsxs(ue,{children:[Y.jsx(le,{src:_}),Y.jsxs(se,{children:[Y.jsx(ce,{children:"未找到有效许可证！"}),Y.jsx("br",{}),"获取正式商业授权涉及费用，收费标准请发送邮件到",Y.jsx("br",{}),"vdept@toone.com.cn咨询。"]})]})}var he=ae({position:"absolute",bottom:"50px",right:"50px",color:"#6a6a6a",zIndex:"999",textAlign:"right",fontSize:"14px",pointerEvents:"none"});function de(){return Y.jsxs(he,{children:["获取正式商业授权涉及费用，收费标准请发送邮件到",Y.jsx("br",{}),"vdept@toone.com.cn咨询"]})}function pe(e,t){return(pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ve(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}function ge(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=function(){function e(t){p(this,e),this.plugin=t}return w(e,[{key:"getConfig",value:function(){return this.plugin?this.plugin.config:null}},{key:"execute",value:function(e,t){return e}}]),e}();function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ye(e);if(t){var o=ye(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ge(this,r)}}var Se=[["url",""],["mode",1],["height",0],["width",0],["clipX",0],["clipY",0],["clipHeight",0],["clipWidth",0],["vAlign",1],["hAlign",1]],Ce=function(e){var t=["IMAGE("];return Se.forEach((function(r){var n,o=void 0;Array.isArray(r)?(n=r[0],o=r[1]):n=r;var a=e[n];a=a===o?void 0:a,t.push(function(e){return isNullOrUndef(e)?"":e}(a)),t.push(",")})),t.pop(),t.push(")"),t.join("")},Oe=function(e){ve(r,e);var t=be(r);function r(){return p(this,r),t.apply(this,arguments)}return w(r,[{key:"execute",value:function(e,t){var r=this.getConfig(),n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({url:"formula"==e.type?e.value:`"${e.value}"`},r);return{type:"formula",value:Ce(n)}}}]),r}(we);function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ye(e);if(t){var o=ye(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ge(this,r)}}var Re=function(e){ve(r,e);var t=Ee(r);function r(){return p(this,r),t.apply(this,arguments)}return w(r,[{key:"execute",value:function(e,t){return{type:"text",value:t.getPage()}}}]),r}(we);function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ye(e);if(t){var o=ye(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ge(this,r)}}var je=function(e){ve(r,e);var t=Ae(r);function r(){return p(this,r),t.apply(this,arguments)}return w(r,[{key:"execute",value:function(e,t){var r=this.getConfig(),n=r.functionNum,o=r.tableCode,i=r.fieldCode,u=t.getFieldIndex(o,i),l=u.row,s=u.col,c=t.getDataCount(o),f=a(),h=f.Spread.Sheets.CalcEngine.RangeReferenceRelative.allRelative;return{type:"formula",value:`SUBTOTAL(${n},${(0,f.Spread.Sheets.CalcEngine.rangesToFormula)([new f.Spread.Sheets.Range(l,s,c,1)],0,0,h,!1)})`}}}]),r}(we);function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ye(e);if(t){var o=ye(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ge(this,r)}}var ke=function(e){ve(r,e);var t=xe(r);function r(){return p(this,r),t.apply(this,arguments)}return w(r,[{key:"execute",value:function(e,t){return{type:"text",value:t.getTotalPages()}}}]),r}(we),Pe=function(){function e(){p(this,e)}return w(e,[{key:"setFieldIndexHandler",value:function(e){this.fieldIndexHandler=e}},{key:"setDataCountHandler",value:function(e){this.dataCountHandler=e}},{key:"setPageHandler",value:function(e){this.pageHandler=e}},{key:"setTotalPagesHandler",value:function(e){this.totalPagesHandler=e}},{key:"getFieldIndex",value:function(e,t){return this.fieldIndexHandler(e,t)}},{key:"getDataCount",value:function(e){return this.dataCountHandler(e)}},{key:"getPage",value:function(){return this.pageHandler()}},{key:"getTotalPages",value:function(){return this.totalPagesHandler()}}]),e}(),Me=function(e,t,r){return t.forEach((function(t){var n=function(e){var t=e.type;switch(t){case"cellImage":return new Oe(e);case"cellSubTotal":return new je(e);case"pageCellType":return new Re(e);case"totalPagesCellType":return new ke(e);default:throw Error("未识别插件类型【"+t+"】，请检查！")}}(t);e=n.execute(e,r)})),e},Ie=null,Te=function(){var e,t=a();try{(new t.Spread.Sheets.Workbook).getSheet(0).setValue(0,0,"test")}catch(r){return{success:!1,showError:!0}}return e=location.hostname,/^(127\.0\.0\.1|localhost)/g.test(e)?{success:!1,showWarn:!0}:{success:!0}};function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Fe=a().Spread.Sheets;function Ve(e,t,r,n){if(!e)return{datas:[],spansTree:[]};var o=t.map((function(e){return e.code})),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.length>0?function e(t,r){var n=U(r),o=new Map,a=n.shift();return t.forEach((function(e){var t=e[a];o.has(t)||o.set(t,{groupName:t,groupCode:a,allChildrens:[]}),o.get(t).allChildrens.push(e)})),o.forEach((function(t){n.length>0&&t.allChildrens.length>0&&(t.childrenGroups=e(t.allChildrens,n))})),o}(e,t):void 0;return new Map([["总",{groupName:"总",groupCode:null,allChildrens:U(e),childrenGroups:r}]])}(e,o),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=[],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).map((function(e){return e.code})),a=o.length>0,i=r.filter((function(e){var r=e.code;return!t.includes(r)&&!o.includes(r)})),u=i.length,l=function e(r){var l=null,s=0,c=[];return r.forEach((function(r,f,h){var d={children:[],verticalSpans:[]},p=r.childrenGroups,v=r.allChildrens,g=r.groupCode,y=r.groupName,w=0,m=t.indexOf(g);if(p){var b,S=e(p);l=S.lastChild,w+=S.totalRowCount,s+=S.totalRowCount,(b=d.children).push.apply(b,U(S.spansTree))}else v.forEach((function(e){l=e;var r=[];if(a){var c={};t.forEach((function(t){c[t]=e[t]}));for(var f=function(){var t=i[h].code;c[t]=e[t];var n=i[h+1].code,a=Ne(Ne({},c),{},A({},n,"小计"));o.forEach((function(t){var r=Number(e[t]);e[t]=Number.isNaN(r)?0:r,Object.defineProperty(a,t,{get:()=>e[t]})})),r.unshift(a),d.verticalSpans[h]||(d.verticalSpans[h]=[]),d.verticalSpans[h].push({rowCount:u-h,col:m+h+1,colCount:1,row:0,subtotalSpan:{rowCount:1,col:m+h+1+1,colCount:u-h-1,row:0},style:{vAlign:1}}),w++,s++},h=0;h<u-1;h++)f()}w++,s++,n.push.apply(n,[e].concat(r))}));var C={};if(g){if(a){var O=t.indexOf(g);t.forEach((function(e,t){t<=O&&(C[e]=l[e])}));var E=t[O+1];O+1===t.length&&(E=i[0].code),C[g]=y,C[E]="小计",d.subtotalSpan={row:0,col:O+1,rowCount:1,colCount:u+(t.length-O)-1},w++,s++}var R={rowCount:w,col:m,colCount:1,row:0,style:{vAlign:1}};d=Ne(Ne({},d),R)}else a&&(C[t[0]||(null==i?void 0:i[0].code)]="小计",d=Ne(Ne({},d),{},{row:s,rowCount:1,col:0,colCount:t.length+u,isTotal:!0}));a&&(o.forEach((function(e){Object.defineProperty(C,e,{get:()=>v.reduce((function(t,r){return t+r[e]}),0)})})),n.push(C)),c.push(d)})),{lastChild:l,totalRowCount:s,spansTree:c}}(e),s=l.spansTree;return{datas:n,spansTree:s}}(a,o,r,n);return{datas:i.datas,spansTree:i.spansTree}}var Le=function(e){return null==e};function Je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var He=a().Spread.Sheets,Be=ae({position:"relative",width:"100%",height:"100%",overflow:"visible",userSelect:"none"}),Ue=function(e,t,r){if(r){var n=a().Spread.Sheets.Events[t];e.bind(n,r)}};function ze(e){var t=e.rules,r=e.row,n=t;return Number.isFinite(r)&&r>=0&&(n=t.filter((function(e){return e.ranges.some((function(e){var t=e.row,n=e.rowCount;return t<=r&&r<t+n}))}))||[]),n}function Ge(e){var t=ze(e);return t=function(e){var t=e.rules,r=e.col,n=e.colHandler,o=t;return Number.isFinite(r)&&r>=0&&(o=o.filter((function(e){var t=e.ranges.some((function(e){var t=e.col,n=e.colCount;return t<=r&&r<t+n}));return t&&"function"==typeof n&&n(JSON.parse(JSON.stringify(e))),t}))),o}(We(We({},e),{},{rules:t}))}function Qe(e){for(var t=e.row,r=e.rows,n=e.spans,o=e.pageRows,a=e.pageSpans,i=e.handler,u=e.startRow,l=void 0===u?0:u,s=e.currentPageRowIndex,c=void 0===s?0:s,f=e.headerDataTableObj,h=e.pageDataTable,d=e.headerRules,p=void 0===d?{}:d,v=e.pageRules,g=void 0===v?[]:v,y=e.pluginTool,w=function(e){c=e+l,f[e]&&(h[c]=JSON.parse(JSON.stringify(f[e])),Object.entries(h[c]).forEach((function(e){var t=z(e,2),r=t[0],n=t[1].tag;if(n){var o=JSON.parse(n).plugins;if(Array.isArray(o)){var a=Number(r),i=Me("",o,y);h[c][a].value=i.value}}}))),n.forEach((function(t){t.row===e&&a.push(We(We({},t),{},{row:c}))})),p[e]&&p[e].forEach((function(e){g.push(We(We({},e),{},{ranges:[We(We({},e.ranges[0]),{},{row:c})]}))})),r[e]&&(o[c]=r[e]),i()},m=0;m<t;m++)w(m);return{currentPageRowIndex:c}}function Ze(e){var t=e.rows,r=e.spans,n=e.pageRows,o=e.pageSpans,a=e.handler,i=e.currentPageRowIndex,u=void 0===i?0:i,l=e.page,s=e.pageDataTable,c=e.rules,f=void 0===c?[]:c,h=e.pageRules,d=void 0===h?[]:h,p=-1,v=-1,g=0;return Object.entries(l).forEach((function(e){var i=z(e,2),l=i[0],c=i[1],h=Number(l),y=1;-1!==p&&(y=h-p),v=u+=y,r.forEach((function(e){e.row===h&&o.push(We(We({},e),{},{row:v}))})),f.forEach((function(e){var t,r=null===(t=e.ranges)||void 0===t?void 0:t[0];(null==r?void 0:r.row)===h&&d.push(We(We({},e),{},{ranges:[We(We({},r),{},{row:v})]}))})),t[h]?(n[v]=t[h],g+=t[h]):g+=20,s[v]=c,p=h,a({addRowCount:y,tableEndRow:v+=y})})),{currentPageRowIndex:u,height:g}}function Ye(e){for(var t=e.rows,r=e.spans,n=e.pageRows,o=e.pageSpans,a=e.handler,i=e.currentPageRowIndex,u=void 0===i?0:i,l=e.pageDataTable,s=e.maxTableEndRow,c=e.oldSheetCount,f=e.footerDataTableObj,h=e.footerRules,d=void 0===h?{}:h,p=e.pageRules,v=void 0===p?[]:p,g=function(e){var i=u++;r.forEach((function(t){t.row===e&&o.push(We(We({},t),{},{row:i}))})),t[e]&&(n[i]=t[e]),d[e]&&d[e].forEach((function(e){v.push(We(We({},e),{},{ranges:[We(We({},e.ranges[0]),{},{row:i})]}))})),l[i]=JSON.parse(JSON.stringify(f[e])),a()},y=s+1;y<c;y++)g(y);return{currentPageRowIndex:u}}function Xe(e,t){e.rows?(Object.keys(e.rows).forEach((function(t){delete e.rows[t]})),Object.entries(t).forEach((function(t){var r=z(t,2),n=r[0],o=r[1];e.rows[n]=o}))):e.rows=t}function Ke(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={},o={},a={},i=e.sheetCount,u=We({},r),l=[];return Object.entries(r).forEach((function(r){var n,o=z(r,2),s=o[0],c=o[1],f=null==c?void 0:c.groups;if(f){var h=u[s],d={};Object.entries(f).some((function(e){var r=z(e,2),n=r[0],o=r[1];d[n]={};var a=t[n];if(Array.isArray(a)&&Array.isArray(o)&&o.length){var i,u=null==o||null===(i=o[0])||void 0===i?void 0:i.code;a.forEach((function(e){var t=e[u];Array.isArray(d[n][t])||(d[n][t]=[]),d[n][t].push(e)}))}}));var p=null==e||null===(n=e.sheets)||void 0===n?void 0:n[s];if(p){var v=JSON.stringify(p),g=Object.values(d)[0],y=Object.keys(g);y.forEach((function(t,r){for(var n=t,o=1;e.sheets[n];)n=`${t}${o++}`;for(;y.includes(n)&&n!==t||l.includes(n);)n=`${t}${o++}`;if(n!==t){var s=d[t];delete d[t],d[n]=s}if(l.push(n),a[n]=d,r<=0)p.name=n;else{var c=JSON.parse(v);c.name=n,c.isSelected=!1,c.index=i++,c.order=c.index,e.sheets[n]=c,e.sheetCount+=1}u[n]=h}))}return!0}})),Object.values(e.sheets).forEach((function(e){var r=e.name,l=e.spans,s=void 0===l?[]:l,c=e.data,f=e.tables,h=void 0===f?[]:f,d=e.rows,p=void 0===d?{}:d,v=e.conditionalFormats,g=void 0===v?{}:v,y=e.visible;if(0!==(void 0===y?1:y)){var w=JSON.parse(JSON.stringify(p)),m=u[r],b=!!m,S=c.dataTable,C=[],O=[],E=e.rowCount,R=-1,A=-1,j=g.rules||[],x=[],k={};S&&Object.entries(S).forEach((function(e){var t=z(e,2),r=t[0],n=t[1],o=Number(r);Object.entries(n).forEach((function(e){var t,r=z(e,2),n=r[0],a=r[1];a.style;var i=a.bindingPath,u=Number(n),l=s.find((function(e){return e.row===o&&e.col===u}))||{rowCount:1,colCount:1},c={oldRow:o,row:o,col:u,rowCount:l.rowCount,colCount:l.colCount,cellInfo:a,rows:p[o]};if(null!=i&&null!==(t=i.includes)&&void 0!==t&&t.call(i,".")){var f=z(i.split("."),2),h=f[0],d=f[1];C.push(We(We({},c),{},{tableCode:h,field:d})),(-1===R||R>o)&&(R=o),(-1===A||A<o)&&(A=o,l.rowCount>=1&&(A+=l.rowCount-1));for(var v=o;v<o+l.rowCount;v++)k[v]=!0}else a&&Object.keys(a).length&&O.push(c)}))})),-1===A&&(R=E,A=E);var P=function(e){var t=e.other_dataTable,r=e.minTableStartRow,n=e.maxTableEndRow,o=e.rules,a=e.rows,i=e.oldSheetCount,u={},l={},s={},c={};t.forEach((function(e){var t=e.row,a=e.col,i=e.cellInfo;if(!(t>=r&&t<=n)){var f=u,h=s;t>n&&-1!==n&&(f=l,h=c),f[t]=f[t]?f[t]:{},f[t][a]=JSON.parse(JSON.stringify(i));var d=Ge({rules:o,row:t,col:a});d&&(h[t]=h[t]?h[t]:[],d.forEach((function(e){h[t].push(We(We({},e),{},{ranges:[{row:t,col:a,rowCount:1,colCount:1}]}))})))}}));for(var f=0,h=0;h<r;h++){var d=null==a?void 0:a[h];f+=d?null==d?void 0:d.size:20}for(var p=0,v=n+1;v<i;v++){var g=null==a?void 0:a[v];p+=g?null==g?void 0:g.size:20}return{headerDataTableObj:u,footerDataTableObj:l,headerRules:s,footerRules:c,headerHeight:f,footerHeight:p}}({other_dataTable:O,minTableStartRow:R,maxTableEndRow:A,rules:j,rows:p,oldSheetCount:E}),M=P.headerDataTableObj,I=P.footerDataTableObj,T=P.headerRules,D=P.footerRules,N=P.headerHeight,F=P.footerHeight,V=e.rowCount||200,L=[{maxRowCount:0,tableCode:"",startRow:-1,oldStartRow:-1,endRow:-1,startCol:-1,endCol:-1,tableColumns:[]}];C.forEach((function(e){var t=e.tableCode,r=e.row,n=e.col,o=e.rowCount,a=e.colCount,i=L[L.length-1];if(i.tableColumns.length<=0)i.startRow=r,i.oldStartRow=r,i.endRow=r,i.maxRowCount=o,i.tableCode=t,i.startCol=n,i.endCol=n+a,i.tableColumns.push(e);else{var u=i.tableColumns[i.tableColumns.length-1],l=u.row,s=u.col,c=u.colCount;u.tableCode===t&&s+c===n&&r===l?(i.maxRowCount<o&&(i.maxRowCount=o),i.endCol=n+a,i.tableColumns.push(e)):L.push({maxRowCount:o,tableCode:t,startRow:r,oldStartRow:r,endRow:r,startCol:n,endCol:n+a,tableColumns:[e]})}}));var J={},W={},H=_e(1),B=new Pe,U=qe(1);B.setPageHandler(U),B.setTotalPagesHandler(H),B.setFieldIndexHandler((function(e,t){var r;return null==W||null===(r=W[e])||void 0===r?void 0:r[t]})),B.setDataCountHandler((function(e){return J[e]}));for(var G={},Q=[],Z={},Y=-1,X=-1,K={},q=[],_=function(){var e,n=L.shift(),o=n.tableCode,i=n.startRow,u=n.endRow,l=n.tableColumns,c=n.oldStartRow,f=n.maxRowCount,d=n.startCol;W[o]={},l.forEach((function(e,t){var r=e.field;W[o][r]={row:i,col:d+t}}));var v=null==t?void 0:t[o],g=null==a||null===(e=a[r])||void 0===e||null===(e=e[o])||void 0===e?void 0:e[r];if(Array.isArray(g)&&(v=g),Array.isArray(v)){J[o]=v.length;var y=ze({rules:j,row:c});v.forEach((function(e,t){var r=S[c];G[u]||(G[u]=JSON.parse(JSON.stringify(r)),Object.entries(G[u]).forEach((function(e){var t=z(e,2),r=t[0],n=t[1].tag;if(n){var o=JSON.parse(n).plugins;if(Array.isArray(o)){var a=Me("",o,B);"text"===a.type&&(G[u][r].value=a.value)}}})));for(var n=1,o=c+1;o<c+f;o++){var a=S[o];G[u+n]||(G[u+n]=a?JSON.parse(JSON.stringify(a)):{}),K[u+n]=G[u+n],q.push(u+n),n++}null!=p&&p[c]&&(Z[u]=We({},null==p?void 0:p[c])),s.forEach((function(e){e.row===c&&Q.push(We(We({},e),{},{row:u}))})),y.forEach((function(e){var t,r=(null==e||null===(t=e.ranges)||void 0===t?void 0:t[0])||{},n=r.col,o=r.rowCount,a=r.colCount;x.push(We(We({},e),{},{ranges:[{row:u,rowCount:o,col:n,colCount:a}]}))})),l.forEach((function(t){var r,n=t.field,o=t.col;null!==(r=G[u])&&void 0!==r&&null!==(r=r[o])&&void 0!==r&&r.bindingPath&&delete G[u][o].bindingPath,G[u][o]=G[u][o]?G[u][o]:{},G[u][o].value=e[n];var a=G[u][o].tag;if(a){var i=JSON.parse(a).hyperlinkInfo;i&&"document"===i.type&&i.isAutoDoc&&(G[u][o].hyperlink.url=`sjs://${e[n]}!A1`,G[u][o].hyperlink.tooltip&&(G[u][o].hyperlink.tooltip=e[n]))}})),K[u]=G[u],u+=f,t>0&&(V+=f)}))}if(i===Y&&X>=u)return 1;var w=u-i-1;i===Y&&X<u&&(w=u-X),Y=i,X=u;var m=i+(f>1?f:0);O.forEach((function(e){e.row>m&&e.row<=u&&(e.row+=w)})),L.forEach((function(e){e.startRow>m&&e.startRow<=u&&(e.startRow+=w,e.endRow=e.startRow)})),h.forEach((function(e){e.row>m&&e.row<=u&&(e.row+=w)}))};L.length;)_();O.forEach((function(e){var t=e.row,r=e.col,n=e.rowCount,o=e.colCount,a=e.cellInfo,i=e.rows,u=e.oldRow;if(!k[t]){G[t]=G[t]?G[t]:{},G[t][r]=We({},a),a.value&&(G[t][r].value=a.value);var l=a.tag;if(l){var s=JSON.parse(l).plugins;if(Array.isArray(s)){var c=Me("",s,B);"text"===c.type?G[t][r].value=c.value:"formula"===c.type&&(G[t][r].formula=c.value)}}(n>1||o>1)&&Q.push({row:t,col:r,rowCount:n,colCount:o}),i&&(Z[t]=i),Ge({rules:j,row:u,col:r,colHandler(e){x.push(We(We({},e),{},{ranges:[{row:t,rowCount:n,col:r,colCount:o}]}))}})}})),Xe(e,Z),e.conditionalFormats=e.conditionalFormats?e.conditionalFormats:{},e.conditionalFormats.rules=x,e.spans=Q,e.data=e.data?e.data:{},e.data.dataTable=G,e.rowCount=V,function(e){var t=e.sheet,r=e.templateInfo,n=e.minTableStartRow,o=e.maxTableEndRow,a=e.headerDataTableObj,i=e.footerDataTableObj,u=e.newRows,l=e.newSpans,s=e.cobyRows,c=e.oldSheetCount,f=e.sheetsInfo,h=e.isTemplate,d=e.sheetCount,p=e.newSheets,v=e.newRules,g=e.headerRules,y=e.footerRules,w=e.contentDataTable,m=e.headerHeight,b=e.footerHeight,S=e.spans,C=e.rows,O=e.virtualRows;if(!h)return;var E=t.printInfo,R=E.paperSize.height,A=void 0===R?1100:R,j=E.margin,x=void 0===j?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:j,k=x.bottom,P=x.footer,M=x.header,I=x.top,T=A-k-P-M-I-m-b,D=0,N=[],F=Object.entries(w),V={},L=[],J=function(){var e=z(F.shift(),2),t=e[0],r=e[1],n=Number(t);if(!O.includes(n)){var o,a=(null==u||null===(o=u[n])||void 0===o?void 0:o.size)||20,i=l.find((function(e){return Number(e.row)===n}));if(i&&i.rowCount>1)for(var s=1;s<i.rowCount;){var c;a+=(null==u||null===(c=u[n+s])||void 0===c?void 0:c.size)||20,s++}i&&(i.rowCount>1||i.colCount>1)&&L.push(i),D+a<T?D+=a:(N.push({dataTable:V,spans:L}),D=a,V={},L=[])}V[n]=r};for(;D<T&&F.length>0;)J();(N.length&&N[N.length-1]!==V||!N.length)&&N.push({dataTable:V,spans:L});var W=d+Object.keys(p).length,H={},B=-1,U=r.isCurrentSheet,G=0,Q=0,Z=0,Y=0;L=[];var X={},K=[],q=JSON.stringify(t),_=0,$=_e(N.length);for(;N.length;){_++;var ee=new Pe,te=qe(_);ee.setPageHandler(te),ee.setTotalPagesHandler($);var re=N.shift().dataTable;U||(G=0,Q=0,Y++,L=[],X={},K=[],H={});var ne={row:n,rows:C,spans:S,pageRows:X,pageSpans:L,handler(){Q++},headerDataTableObj:a,pageDataTable:H,pageRules:K,headerRules:g,pluginTool:ee};U&&(ne.startRow=Z);var oe=Qe(ne);G=oe.currentPageRowIndex,G=(oe=Ze({rows:u,spans:l,pageRows:X,pageSpans:L,handler(e){var t=e.addRowCount,r=e.tableEndRow;Q+=t,B=r},currentPageRowIndex:G,page:re,pageDataTable:H,pageRules:K,rules:v})).currentPageRowIndex+1;var ae=oe.height;if(o>-1&&(G=(oe=Ye({rows:s,spans:S,pageRows:X,pageSpans:L,handler(){Q++},currentPageRowIndex:G,pageDataTable:H,footerDataTableObj:i,maxTableEndRow:o,oldSheetCount:c,footerRules:y,pageRules:K})).currentPageRowIndex),!U){var ie=t;Y>1&&((ie=JSON.parse(q)).name+="_"+(Y-1),ie.index=W++,ie.isSelected=!1,p[ie.name]=ie),$e({_sheet:ie,pageDataTable:H,pageRules:K,tableEndRow:B,pageSpans:L,pageRows:X,sheetsInfo:f,pageTotalRow:Q})}if(U){var ue=T-ae;if(ue>0){var le,se=(null===(le=C[B])||void 0===le?void 0:le.size)||20;G+=Math.ceil(ue/se)}Z=G}}U&&$e({_sheet:t,pageDataTable:H,pageRules:K,tableEndRow:B,pageSpans:L,pageRows:X,sheetsInfo:f,pageTotalRow:Q+1})}({sheet:e,templateInfo:m,minTableStartRow:R,maxTableEndRow:A,rows:p,spans:s,headerDataTableObj:M,footerDataTableObj:I,newRows:Z,newSpans:Q,cobyRows:w,oldSheetCount:E,sheetsInfo:n,isTemplate:b,sheetCount:i,newSheets:o,newRules:x,headerRules:T,footerRules:D,contentDataTable:K,headerHeight:N,footerHeight:F,virtualRows:q})}})),Object.entries(o).forEach((function(t){var r=z(t,2),n=r[0],o=r[1];e.sheets[n]=o,e.sheetCount+=1})),n}function qe(e){return function(){return e}}function _e(e){return function(){return e}}function $e(e){var t=e._sheet,r=e.pageDataTable,n=e.pageRules,o=e.tableEndRow,a=e.pageSpans,i=e.pageRows,u=e.sheetsInfo,l=e.pageTotalRow,s=l>0?l:t.rowCount,c=t.name;t.data.dataTable=Object.keys(r).length?r:t.data.dataTable,t.rowCount=s,t.conditionalFormats=t.conditionalFormats?t.conditionalFormats:{},t.conditionalFormats.rules=n,t.spans=a,Xe(t,i),u[c]=u[c]?u[c]:{},u[c].tableEndRow=o}var et=function(e){var t=e.spread,r=e.dataSource,n=e.sumColumns,o=e.groupColumns,a=e.rowMerge,i=e.columnMerge,u=e.rowMergeColumns,l=void 0===u?{}:u,s=e.colMergeColumns,c=void 0===s?{}:s,f=e.isFillData,h=void 0!==f&&f,d=e.sheetsInfo;t&&t.sheets.forEach((function(e){var t,u=JSON.parse(JSON.stringify(r)),s=e.tables.all(),f=[],p=[],v=null;u&&(v=new He.Bindings.CellBindingSource(u),e.setDataSource(v)),s.length>0&&s.forEach((function(e){var t=e.name(),r=o[t],a=n[t],i=l[t]||[],s=c[t]||[];if(Array.isArray(r)&&r.length>0||Array.isArray(a)&&a.length>0){var h=e.bindingPath(),d=e.range(),v=d.row,g=d.col,y=[];if(e.BSt.forEach((function(e){y.push({code:e.dataField()})})),null!=u&&u[h]){var w=Ve(u[h],r,y,a),m=w.datas,b=w.spansTree;u[h]=m;var S=function(e){var t=[],r={};return function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=o;n.forEach((function(n){var u=n.row,l=void 0===u?0:u,s=n.col,c=void 0===s?0:s,f=n.rowCount,h=void 0===f?1:f,d=n.colCount,p=void 0===d?1:d,v=n.children,g=void 0===v?[]:v,y=n.verticalSpans,w=void 0===y?[]:y,m=n.subtotalSpan,b=n.isTotal,S=void 0!==b&&b;if(g.length>0&&e(g,i),w.length>0&&w.forEach((function(e,n){var o=i;e.forEach((function(e){if(e.hasOwnProperty("style")){var i=e.col,u=e.style;r[o]||(r[o]={}),r[o][i]||(r[o][i]={}),r[o][i].style=Ne({},u)}t.push({row:o,col:e.col+a,rowCount:e.rowCount,colCount:e.colCount}),e.subtotalSpan.colCount>1&&t.push({row:o+e.rowCount-1,col:e.subtotalSpan.col+a,rowCount:e.subtotalSpan.rowCount,colCount:e.subtotalSpan.colCount}),o+=e.rowCount+n}))})),n.hasOwnProperty("style")){var C=n.col,O=n.style;r[i]||(r[i]={}),r[i][C]||(r[i][C]={}),r[i][C].style=Ne({},O)}n.hasOwnProperty("row")&&((h>1||p>1)&&(S?t.push({row:l+o,col:c+a,rowCount:h,colCount:p}):t.push({row:i,col:c+a,rowCount:h,colCount:p})),m&&t.push({row:i+h-1,col:m.col+a,rowCount:m.rowCount,colCount:m.colCount}),i+=h)}))}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),{spans:t,dataTableStyle:r}}(b,v+1,g);f.push.apply(f,U(S.spans))}}if(i.length>0||s>0){var C=e.BSt.map((function(e){return{id:e.id(),code:e.dataField(),name:e.name()}})),O=e.range(),E=function(e){var t=e.rowMergeColumns,r=e.colMergeColumns,n=e.tableColumns,o=e.row,a=void 0===o?0:o;e.col;var i=e.rowCount,u=void 0===i?0:i,l=[];if(t.length||r.length){var s=t.map((function(e){return Ne(Ne({},e),{},{rowMerge:!0,colMerge:!1})}));r.forEach((function(e){var t=s.find((function(t){return t.code===(null==e?void 0:e.code)}));t?t.colMerge=!0:s.push(Ne(Ne({},e),{},{rowMerge:!1,colMerge:!0}))})),s.sort((function(e,t){return n.findIndex((function(t){return t.code===e.code}))-n.findIndex((function(e){return e.code===t.code}))}));var c=s[0],f=c.rowMerge,h=c.colMerge,d=Fe.AutoMerge.AutoMergeDirection.column,p=Fe.AutoMerge.AutoMergeMode.free,v=Fe.SheetArea.viewport,g=Fe.AutoMerge.SelectionMode.merged;f&&h?d=Fe.AutoMerge.AutoMergeDirection.rowColumn:f&&(d=Fe.AutoMerge.AutoMergeDirection.row);var y={row:a,col:-1,rowCount:u,colCount:1},w=-1;s.forEach((function(e){var t=e.code,r=e.rowMerge,o=e.colMerge,a=n.findIndex((function(e){return e.code===t}));-1===y.col?y.col=a:w+1===a&&f===r?y.colCount+=1:(l.push({range:y,direction:d,mode:p,sheetArea:v,selectionMode:g}),f=r,y={row:1,col:a,rowCount:u+1,colCount:1},d=Fe.AutoMerge.AutoMergeDirection.column,r&&o?d=Fe.AutoMerge.AutoMergeDirection.rowColumn:r&&(d=Fe.AutoMerge.AutoMergeDirection.row)),w=a})),(l.length>0&&l[l.length-1]!==y&&y.col>-1||l.length<=0&&y.col>-1)&&l.push({range:y,direction:d,mode:p,sheetArea:v,selectionMode:g})}return l}({rowMergeColumns:i,colMergeColumns:s,tableColumns:C,row:O.row+1,rowCount:O.rowCount});p.push.apply(p,U(E))}}));var g=e.toJSON();g.spans=Array.isArray(g.spans)?g.spans:[],(t=g.spans).push.apply(t,f),g.autoMergeRangeInfos=p,h&&function(e,t){for(var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.rows,a=void 0===o?{}:o,i=e.rowCount,u=e.printInfo,l=u.paperSize.height,s=void 0===l?1100:l,c=u.margin,f=void 0===c?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:c,h=e.tables,d=void 0===h?[]:h,p=e.data.dataTable,v=void 0===p?{}:p,g=e.name,y=s-f.bottom-f.footer-f.header-f.top,w=0,m=0,b=0,S="";w<i;){var C;m+=(null===(C=a[w])||void 0===C?void 0:C.size)||20,d.forEach((function(e){var t=e.row,r=e.rowCount,n=e.bindingPath;t+r-1===w&&(b=w,S=n)})),m>y?m=0:w++}var O=y-m;if(O>0&&S){var E,R=(null===(E=a[b])||void 0===E?void 0:E.size)||20,A=Math.floor(O/R);if(A>0)for(var j=t.getSource(),x=null==j?void 0:j[S],k=A;k>0;)x.push({}),k--}else if(O>0&&!S&&(null==n||null===(r=n[g])||void 0===r?void 0:r.tableEndRow)>=0){var P,M,I=(null==n||null===(P=n[g])||void 0===P?void 0:P.tableEndRow)-1,T=(null===(M=a[I])||void 0===M?void 0:M.size)||20,D=Math.floor(O/T);if(D>0){var N,F=[],V=null,L=JSON.parse(JSON.stringify(a));if(Object.entries(v).forEach((function(e){var t=z(e,2),r=t[0],n=t[1],o=Number(r);o>I&&F.push({row:o,value:n}),o===I&&(V=JSON.parse(JSON.stringify(n)))})),V){var J=1;for(Object.keys(V).forEach((function(e){V[e]=We(We({},V[e]),{},{value:""})}));J<=D;)v[I+J]=We({},JSON.parse(JSON.stringify(V))),a&&(a[I+J]={size:T}),J++}F.forEach((function(t){var r=t.row,n=t.value,o=r+D;v[o]=n,L[r]&&(e.rows[o]=L[r])})),e.spans&&e.spans.forEach((function(e){e.row>I&&(e.row=e.row+D)}));var W=null==e||null===(N=e.conditionalFormats)||void 0===N?void 0:N.rules;Array.isArray(W)&&W.forEach((function(e){var t,r=e.ranges;(null==r||null===(t=r[0])||void 0===t?void 0:t.row)>I&&(r[0].row=r[0].row+D)})),e.rowCount=e.rowCount+D}}}(g,v,d),e.fromJSON(g),v&&e.setDataSource(v),function(e){var t=e.sheet,r=e.rowMerge,n=e.columnMerge,o=t.tables.all();if(o.length>0&&(r||n)){var a=He.AutoMerge.AutoMergeDirection.column,i=He.AutoMerge.AutoMergeMode.free,u=He.SheetArea.viewport,l=He.AutoMerge.SelectionMode.merged;r&&n?a=He.AutoMerge.AutoMergeDirection.rowColumn:r&&(a=He.AutoMerge.AutoMergeDirection.row),t.suspendPaint(),o.forEach((function(e){var r=e.range();t.autoMerge(r,a,i,u,l)})),t.resumePaint()}}({sheet:e,rowMerge:a,columnMerge:i})}))};function tt(t){var r=t.newTabVisible,o=void 0===r||r,l=t.tabEditable,c=void 0===l||l,f=t.tabStripVisible,h=void 0===f||f,d=t.onInited,p=t.onEnterCell,v=t.onActiveSheetChanged,g=t.onValueChanged,y=t.onSelectionChanged,w=t.onSelectionChanging,m=t.onEditorStatusChanged,b=t.onSheetNameChanged,S=t.onSheetNameChanging,C=t.onActiveSheetChanging;t.onFetchData;var O=t.onUndo,E=t.onRedo,R=t.license,A=t.enablePrint,j=void 0!==A&&A,k=t.json,P=void 0===k?null:k,M=t.onPrintHandler,I=t.children,T=t.baseUrl,D=t.dataSource,F=void 0===D?null:D,V=t.sumColumns,J=void 0===V?[]:V,W=t.groupColumns,H=void 0===W?[]:W,B=t.rowMerge,U=void 0!==B&&B,G=t.columnMerge,Q=void 0!==G&&G,Z=t.rowMergeColumns,X=void 0===Z?{}:Z,K=t.colMergeColumns,_=void 0===K?{}:K,$=t.isFillData,ee=void 0!==$&&$,te=t.template;R&&function(e){Ie=e}(R),T&&n(T);var re=a(),ne=Ie||"593811994558535#B1dWhJlMLFTUwpXTsV6L03kcLpmNkR5VklDTz9mdnh4SmJ6c98WU9QEVrNDO5kTNOpUb9B7d9l5NjlWWsxmU9hHNmVTb9p5dU5UZmRkZXJlR4d5MENkVat4RKNWZMVlcuNmbph6SxYTUyoVcFBFeIlTe5QFSYhjShpneohmVoZTVhdFdBJGOuFDMsVDW8RjZrB5aQlFbSZVS48UNr5mY62EZ4UWYTFGbxpWZVBVMo3iaCZVNrcmYxlDZzIkWmNVc5FVRCl5KFFDMvMmSjRUUKpkTRRTdV3GOHZVY5llY9IUez2kTalFShN6cjFEOXZEeuVHcWxmWZtWViojITJCLiEkMygjR5UjI0ICSiwCO7YTMxYjM6ATM0IicfJye#4Xfd5nIVF4SRJiOiMkIsIyNx8idgMlSgQWYlJHcTJiOi8kI1tlOiQmcQJCLigDNyADOwAiNxQDM4IDMyIiOiQncDJCLiEjLw8CMucjMxIiOiMXbEJCLig1jlzahlDZmpnInmz9unHZvnfLsonLvlb1kpfbtmD0jnLiOiEmTDJCLiUzM5gTN5QTO9ETM8MTO5IiOiQWSiwSfdtlOicGbmJCLlNHbhZmOiI7ckJye0ICbuFkI1pjIEJCLi4TP7pXe62iNw34KDl5RVpHO8dVW7UESQN7Zl3ycj36V4NzbGJENV5kTtJDdEVjQjFnbutyRVhleuV6ZFVkRZxUdQZmdJlFZHpXWmhWYTZGSIF6LUJjdhZTMjNVVltbcYR";ne&&(re.Spread.Sheets.LicenseKey=ne);var oe=z(e.useState((function(){var e=Te(),t=!1,r=!1;return e.success||(t=e.showError,r=e.showWarn),{spread:null,showError:t,showWarn:r}})),1)[0],ae=e.useRef(null),ie=e.useMemo((function(){var e=null,t=JSON.parse(JSON.stringify(P));return t&&(e=F&&Ke(t,F,te)),{sheetsInfo:e,json:t}}),[P,F,JSON.stringify(te)]),ue=ie.json,le=ie.sheetsInfo,se=function(){var e=x(N.mark((function e(){var t,r,n;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=4;break}return t=u["print"].map((function(e){return s(e)})),e.next=4,L.loadScript(t);case 4:if(oe.spread||!ae.current||ae.showError){e.next=12;break}return r=a(),n=new r.Spread.Sheets.Workbook(ae.current,{sheetCount:0,newTabVisible:o,tabEditable:c,tabStripVisible:h}),oe.spread=n,n.suspendEvent(),q(n),n.resumeEvent(),e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){if(oe.spread){var e=oe.spread;e.unbindAll(),function(e,t){if(e&&t)for(var r=0,n=Object.entries(t);r<n.length;r++){var o=z(n[r],2),a=o[0],i=o[1];Ue(e,a,i)}}(e,{EnterCell:p,ActiveSheetChanged:v,ValueChanged:g,ActiveSheetChanging:C,SheetNameChanged:b,SheetNameChanging:S,SelectionChanged:y,SelectionChanging:w,EditorStatusChanged:m,WorkbookUndo:O,WorkbookRedo:E})}},he=function(e){if(oe.spread){var t=oe.spread;i(t,e?function(){t.fromJSON(e);var r=t.sheets;r&&r.length>0&&r.forEach((function(e){e.options.sheetAreaOffset={left:1,top:1},e.recalcAll(!0)}))}:function(){var e;e=I?Array.isArray(I)?I:[I]:[],t.clearSheets();var r=a();e.forEach((function(e,n){var o=e.props,a=o.name,i=void 0===a?`Sheet${n+1}`:a,u=o.rowCount,l=void 0===u?20:u,s=o.colCount,c=void 0===s?20:s,f=new r.Spread.Sheets.Worksheet(i);f.options.sheetAreaOffset={left:1,top:1},f.setRowCount(l),f.setColumnCount(c),t.addSheet(n,f)}))})}},pe=function(){if(oe.spread){var e=oe.spread;F&&et({spread:e,dataSource:F,sumColumns:J,groupColumns:H,rowMerge:U,columnMerge:Q,rowMergeColumns:X,colMergeColumns:_,isFillData:ee,sheetsInfo:le})}},ve=function(){if(oe.spread){var e=oe.spread;M&&M((function(t){return new Promise((function(r,n){e?j?(e.sheets.forEach((function(e){!function(e,t){var r=t.orientation,n=t.printQuality,o=t.scaleType,i=t.fitPagesTall,u=t.fitPagesWide,l=t.zoomFactor,s=t.firstPageNumber,c=t.paperKind,f=t.margin,h=t.headerAndFooter,d=t.showGridLine,p=t.showHeader,v=t.blackAndWhite,g=t.pageOrder,y=t.showBorder,w=e.printInfo(),m=function(e,t){Le(e)||("string"==typeof t?w[t](e):t(e))};m(r,"orientation"),m(n,"qualityFactor"),Le(o)||(1==o?(i=-1,u=-1,l/=100):0==o&&(l=1),w.zoomFactor(l),w.fitPagesWide(u),w.fitPagesTall(i)),m(s,"firstPageNumber"),m(c,(function(){var e=new(a().Spread.Sheets.Print.PaperSize)(parseInt(c));w.paperSize(e)})),m(f,(function(){var e=f.left,t=f.right,r=f.top,n=f.bottom,o=f.header,i=f.footer,u=f.centering;w.margin({left:100*e,right:100*t,top:100*r,bottom:100*n,header:100*o,footer:100*i});var l=null,s=a();l=null!=u&&u.horizontally?null!=u&&u.vertically?s.Spread.Sheets.Print.PrintCentering.both:s.Spread.Sheets.Print.PrintCentering.horizontal:null!=u&&u.vertically?s.Spread.Sheets.Print.PrintCentering.vertical:s.Spread.Sheets.Print.PrintCentering.none,w.centering(l)})),m(null==h?void 0:h.pageHeaderFooter,"pageHeaderFooter"),m(d,"showGridLine"),m(p,(function(){var e=a(),t=p?e.Spread.Sheets.Print.PrintVisibilityType.show:e.Spread.Sheets.Print.PrintVisibilityType.hide;w.showRowHeader(t),w.showColumnHeader(t)})),m(v,"blackAndWhite"),m(g,"pageOrder"),m(y,"showBorder");var b=w.rowStart();b=-1==b?0:b,w.rowStart(b);var S=w.rowEnd();S=-1==S?e.getRowCount():S,w.rowEnd(S);var C=w.columnStart();C=-1==C?0:C,w.columnStart(C);var O=w.columnEnd();O=-1==O?e.getColumnCount():O,w.columnEnd(O),e.printInfo(w)}(e,t||{})})),e.print(),r()):n(Error("打印失败，原因：初始化报表时未开启打印功能")):n(Error("打印失败，原因：报表未初始化"))}))}))}};return e.useEffect((function(){x(N.mark((function e(){var t,r;return N.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se();case 2:t=e.sent,ce(),t&&(he(ue),pe(),ve(),d&&(r=d(oe.spread))&&r.then&&r.then((function(e){he(e)})));case 5:case"end":return e.stop()}}),e)})))()}),[ue,F,p,v,g,C,b,S,y,w,m,O,E]),Y.jsxs(Be,{children:[oe.showError?Y.jsx(fe,{}):Y.jsx("div",{style:{width:"100%",height:"100%",overflow:"visible",userSelect:"none"},ref:ae}),!oe.showError&&oe.showWarn?Y.jsx(de,{}):null]})}var rt=["onInited","ready","dataSource"];function nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var at=function(){function r(e){p(this,r),A(this,"conf",{}),A(this,"spread",null),A(this,"printHandler",null),this.conf=e,e.baseUrl&&n(e.baseUrl)}return w(r,[{key:"replacer",value:function(e,t){if("cornerFold"!==e||"table"!==(null==t?void 0:t.markType))return t}},{key:"mount",value:function(r){var n,o,u,l,s=this;a().Spread.Common.CultureManager.culture("zh-cn");var c=this.conf||{},f=c.onInited,h=c.ready,d=c.dataSource,p=R(c,rt),v=null===(n=this.conf)||void 0===n||null===(n=n.json)||void 0===n?void 0:n.reportJson;v&&(v=JSON.parse(JSON.stringify(v,this.replacer)));var g=(null===(o=this.conf)||void 0===o||null===(o=o.json)||void 0===o||null===(o=o.context)||void 0===o?void 0:o.tableDesignSlice)||{},y=g.rowMerge,w=g.columnMerge,m=((null===(u=this.conf)||void 0===u?void 0:u.event)||{}).onFetchData,b=(null===(l=this.conf)||void 0===l||null===(l=l.json)||void 0===l||null===(l=l.context)||void 0===l?void 0:l.datasourceSlice)||{},S=b.sumColumns,C=b.tableGroups,O=b.rowMergeColumns,A=void 0===O?{}:O,j=b.colMergeColumns,x=void 0===j?{}:j;t.createRoot(r).render(e.createElement(tt,ot(ot({onInited:function(e){s.spread=e,f&&f(e),"function"==typeof h&&i(e,(function(){h(new E(e))}))},onPrintHandler:function(e){s.printHandler=e},onFetchData:m,rowMerge:y,columnMerge:w,sumColumns:S,groupColumns:C,rowMergeColumns:A,colMergeColumns:x,dataSource:d},p),{},{json:v})))}},{key:"exportExcel",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreFormula:!1,ignoreStyle:!1};return new Promise((function(n,i){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".xlsx")?e:e+".xlsx",L.loadScript([o()+"/vendor/plugins/excelio.min.js"]).then((function(){var o=new(a().Spread.Excel.IO),u=JSON.stringify(t.spread.toJSON());o.save(u,(function(t){W(t,e),n()}),(function(e){i(e)}),{columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeBindingSource:!1,includeCalcModelCache:!1,includeEmptyRegionCells:!0,includeFormulas:!r.ignoreFormula,includeStyles:!r.ignoreStyle,includeUnusedNames:!0,password:void 0,rowHeadersAsFrozenColumns:!1,saveAsView:!1})}))):i(Error("导出excel失败，原因:没有传递导出文件名"))}))}},{key:"exportPdf",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{author:"",creator:"",keywords:"",subject:"",title:"",sheetIndex:null};return new Promise((function(n,a){if("string"==typeof e&&""!==e.trim()){e=e.endsWith(".pdf")?e:e+".pdf";var i=o();L.loadScript([i+"/vendor/plugins/print.min.js",i+"/vendor/plugins/pdf.min.js"]).then((function(){t.spread.savePDF((function(t){W(t,e),n()}),(function(e){a(e)}),{author:r.auther,creator:r.application,keywords:r.keyword,subject:r.subject,title:r.title},null==r.sheetIndex?void 0:r.sheetIndex)}))}else a(Error("导出pdf失败，原因:没有传递导出文件名"))}))}},{key:"print",value:function(e){var t=this;return new Promise((function(r,n){t.printHandler?t.printHandler(e).then(r).catch(n):n(Error("打印失败，原因：报表未初始化"))}))}}]),r}();return{FontStyle:{normal:"normal",italic:"italic"},FontWeight:{normal:"normal",bold:"bold"},HAlign:h,LineBorder:m,LineStyle:f,Preview:at,VAlign:d,WorkBook:E,WorkSheet:O}}));
