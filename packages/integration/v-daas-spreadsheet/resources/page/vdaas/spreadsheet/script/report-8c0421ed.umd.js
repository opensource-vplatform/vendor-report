!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom/client")):"function"==typeof define&&define.amd?define(["react","react-dom/client"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).TOONE=e.TOONE||{},e.TOONE.Report=t(e.React,e.ReactDOM))}(this,(function(e,t){"use strict";var r=".",n=function(e){r=e},o=function(){return r},a=function(){return window.GC},i=function(e,t){if(e){e.suspendPaint(),e.suspendCalcService();var r=e.getActiveSheet();try{t(r)}finally{e.resumeCalcService(!1),e.resumePaint()}}},l={print:["/vendor/plugins/print.min.js"]},s=a(),u={dashed:s.Spread.Sheets.LineStyle.dashed,dotted:s.Spread.Sheets.LineStyle.dotted,double:s.Spread.Sheets.LineStyle.double,empty:s.Spread.Sheets.LineStyle.empty,thick:s.Spread.Sheets.LineStyle.thick,thin:s.Spread.Sheets.LineStyle.thin},c={center:s.Spread.Sheets.HorizontalAlign.center,left:s.Spread.Sheets.HorizontalAlign.left,right:s.Spread.Sheets.HorizontalAlign.right},f={center:s.Spread.Sheets.VerticalAlign.center,bottom:s.Spread.Sheets.VerticalAlign.bottom,top:s.Spread.Sheets.VerticalAlign.top};function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function g(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var w=function(){function e(t,r){h(this,e),this.color=t,this.style=r}return g(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStyle",value:function(e){this.style=e}},{key:"getStyle",value:function(){return this.style}},{key:"_to",value:function(){return new(a().Spread.Sheets.LineBorder)(this.color,this.style)}}]),e}();document.createElement("span");var y=function(e,t){return null==e?t:e},m=function(e,t,r){var n=a(),o=r.fontWeight,i=r.fontStyle,l=r.fontFamily,s=r.fontSize,u=r.textDecoration,c=r.backColor,f=r.foreColor,h=r.wordWrap;!function(e,t,r){for(var n=e.col,o=e.row,a=e.rowCount,i=e.colCount,l=0;l<a;l++)for(var s=0;s<i;s++)r(t,o+l,n+s)}(t,e,(function(e,t,r){var a=new n.Spread.Sheets.Style,d=e.getStyle(t,r),p=function(e){var t="normal",r="normal",n="normal",o="Calibri";if(e)for(var a,i=e.split(/\s+/);a=i.shift();)switch(a){case"normal":break;case"italic":case"oblique":t=a;break;case"small-caps":r=a;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":n=a;break;default:o=a,i.length&&(o+=" "+i.join(" "))}return{fontStyle:t,fontVariant:r,fontWeight:n,fontSize:11,lineHeight:"normal",fontFamily:o}}(d.font);Object.assign(a,d),l=y(l,p.fontFamily),s=y(s,p.fontSize),i=y(i,p.fontStyle),o=y(o,p.fontWeight),u=y(u,d.textDecoration),c=y(c,d.backColor),f=y(f,d.foreColor);var v=function(e){return e&&-1===e.indexOf("'")&&-1===e.indexOf('"')?`"${e}"`:e}(l),g=function(e){var t=e.fontFamily,r=void 0===t?"":t,n=e.fontStyle,o=void 0===n?"":n,a=e.fontVariant,i=void 0===a?"":a,l=e.fontWeight,s=void 0===l?"":l,u=e.fontSize,c=void 0===u?"":u,f=e.lineHeight,h=[o,i,s,c,void 0===f?"":f,r].join(" "),d=document.createElement("span");return d.style.font=h,d.style.font}({fontFamily:v,fontSize:s?`${s}pt`:"",fontStyle:i,fontWeight:o});a.font=g,a.textDecoration=u,a.backColor=c,a.foreColor=f,a.wordWrap=h,e.setStyle(t,r,a)}))},b=function(){function e(t,r){h(this,e),this.sheet=t,this.cellRange=r}return g(e,[{key:"hAlign",value:function(e){this.cellRange.hAlign(e)}},{key:"vAlign",value:function(e){this.cellRange.vAlign(e)}},{key:"setBorder",value:function(e,t){this.cellRange.setBorder(e,t)}},{key:"fontFamily",value:function(e){m(this.sheet,this.cellRange,{fontFamily:e})}},{key:"fontSize",value:function(e){m(this.sheet,this.cellRange,{fontSize:e})}},{key:"fontStyle",value:function(e){m(this.sheet,this.cellRange,{fontStyle:e})}},{key:"fontWeight",value:function(e){m(this.sheet,this.cellRange,{fontWeight:e})}},{key:"wordWrap",value:function(e){m(this.sheet,this.cellRange,{wordWrap:e})}}]),e}(),S=function(){function e(t){h(this,e),this.sheet=t}return g(e,[{key:"name",value:function(e){this.sheet.name(e)}},{key:"getCell",value:function(e,t){var r=this.sheet.getCell(e,t);return new b(this.sheet,r)}},{key:"getRange",value:function(e,t,r,n){var o=this.sheet.getRange(e,t,r,n);return new b(this.sheet,o)}},{key:"addSpan",value:function(e,t,r,n){this.sheet.addSpan(e,t,r,n)}},{key:"addRows",value:function(e,t){this.sheet.addRows(e,t)}},{key:"addColumns",value:function(e,t){this.sheet.addColumns(e,t)}},{key:"setValue",value:function(e,t,r){this.sheet.setValue(e,t,r)}},{key:"setFormula",value:function(e,t,r){this.sheet.setFormula(e,t,r)}},{key:"setRowCount",value:function(e){this.sheet.setRowCount(e)}},{key:"setRowHeight",value:function(e,t){this.sheet.setRowHeight(e,t)}},{key:"setColumnCount",value:function(e){this.sheet.setColumnCount(e)}},{key:"setColumnWidth",value:function(e,t){this.sheet.setColumnWidth(e,t)}},{key:"setDefaults",value:function(e){Object.assign(this.sheet.defaults,e)}},{key:"setOptions",value:function(e){var t=e.colHeaderVisible,r=void 0===t||t,n=e.rowHeaderVisible,o=void 0===n||n,a=e.showHorizontalGridline,i=void 0===a||a,l=e.showVerticalGridline,s=void 0===l||l,u=e.isProtected,c=void 0!==u&&u;Object.assign(this.sheet.options,{colHeaderVisible:r,rowHeaderVisible:o,isProtected:c}),Object.assign(this.sheet.options.gridline,{showHorizontalGridline:i,showVerticalGridline:s})}}]),e}(),C=function(){function e(t){h(this,e),this.spread=t}return g(e,[{key:"addSheet",value:function(e){this.spread.addSheet(e)}},{key:"getSheet",value:function(e){var t=this.spread.getSheet(e);return t?new S(t):null}},{key:"setOptions",value:function(e){var t=e.newTabVisible,r=void 0===t||t,n=e.tabStripVisible,o=void 0===n||n,a=e.showHorizontalScrollbar,i=void 0===a||a,l=e.showVerticalScrollbar,s=void 0===l||l;Object.assign(this.spread.options,{newTabVisible:r,tabStripVisible:o,showHorizontalScrollbar:i,showVerticalScrollbar:s})}}]),e}();function O(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function E(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e,t,r,n,o,a,i){try{var l=e[a](i),s=l.value}catch(u){return void r(u)}l.done?t(s):Promise.resolve(s).then(n,o)}function A(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){R(a,n,o,i,l,"next",e)}function l(e){R(a,n,o,i,l,"throw",e)}i(void 0)}))}}function j(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var x={exports:{}},M={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(M);var I=M.exports;!function(e){var t=I.default;function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=r=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var n,o={},a=Object.prototype,i=a.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(D){h=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),i=new T(n||[]);return l(a,"_invoke",{value:M(e,r,i)}),a}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}o.wrap=d;var v="suspendedStart",g="suspendedYield",w="executing",y="completed",m={};function b(){}function S(){}function C(){}var O={};h(O,u,(function(){return this}));var E=Object.getPrototypeOf,R=E&&E(E(N([])));R&&R!==a&&i.call(R,u)&&(O=R);var A=C.prototype=b.prototype=Object.create(O);function j(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,r){function n(o,a,l,s){var u=p(e[o],e,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==t(f)&&i.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,l,s)}),(function(e){n("throw",e,l,s)})):r.resolve(f).then((function(e){c.value=e,l(c)}),(function(e){return n("throw",e,l,s)}))}s(u.arg)}var o;l(this,"_invoke",{value:function(e,t){function a(){return new r((function(r,o){n(e,t,r,o)}))}return o=o?o.then(a,a):a()}})}function M(e,t,r){var o=v;return function(a,i){if(o===w)throw new Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:n,done:!0}}for(r.method=a,r.arg=i;;){var l=r.delegate;if(l){var s=I(l,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===v)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=w;var u=p(e,t,r);if("normal"===u.type){if(o=r.done?y:g,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function I(e,t){var r=t.method,o=e.iterator[r];if(o===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,I(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var a=p(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,m;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(i.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=C,l(A,"constructor",{value:C,configurable:!0}),l(C,"constructor",{value:S,configurable:!0}),S.displayName=h(C,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,h(e,f,"GeneratorFunction")),e.prototype=Object.create(A),e},o.awrap=function(e){return{__await:e}},j(x.prototype),h(x.prototype,c,(function(){return this})),o.AsyncIterator=x,o.async=function(e,t,r,n,a){void 0===a&&(a=Promise);var i=new x(d(e,t,r,n),a);return o.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},j(A),h(A,f,"Generator"),h(A,u,(function(){return this})),h(A,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},o.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return l.type="throw",l.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],l=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:N(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),m}},o}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(x);var k=(0,x.exports)(),P=k;try{regeneratorRuntime=k}catch(Le){"object"==typeof globalThis?globalThis.regeneratorRuntime=k:Function("r","regeneratorRuntime = r")(k)}const T=j(P);var N=function(e){return e?"string"==typeof e&&(e=[e]):e=[],e},D=function(){function e(){h(this,e),this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptMaps={},this._dataPromises={}}var t,r,n,o,a,i,l,s;return g(e,[{key:"loadScript",value:(s=A(T.mark((function e(t){var r,n,o,a=this;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],(t=N(t)).forEach((function(e){(n=a._scriptMaps[e]=a._scriptMaps[e]||{}).promise||(n.path=e,n.promise=new Promise((function(t){(r=a.createScriptElement()).setAttribute("type","text/javascript"),r.src=e,r.addEventListener("load",t),a._head.appendChild(r)}))),o.push(n.promise)})),e.abrupt("return",Promise.all(o));case 4:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"unloadScript",value:(l=A(T.mark((function e(t){var r,n=this;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(r=n._head.querySelectorAll('script[src="'+e+'"]')[0])&&(n._head.removeChild(r),delete n._scriptMaps[e])})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"createScriptElement",value:function(){return document.createElement("script")}},{key:"fetchData",value:(i=A(T.mark((function e(t){var r,n,o=arguments;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},n=t+JSON.stringify(r),r.cache=void 0===r.cache||r.cache,t){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this._dataPromises[n]&&r.cache){e.next=16;break}return e.prev=6,e.next=9,fetch(t,r);case 9:this._dataPromises[n]=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),this._dataPromises[n]=null,e.t0;case 16:return e.abrupt("return",this._dataPromises[n]);case 17:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return i.apply(this,arguments)})},{key:"loadCss",value:(a=A(T.mark((function e(t){var r=this;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){if(!r._cssPaths[e]){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),r._head.appendChild(t),r._cssPaths[e]=t}})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"unloadCss",value:(o=A(T.mark((function e(t){var r,n=this;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(r=n._cssPaths[e])&&(n._head.removeChild(r),n._cssPaths[e]=null)})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadTemplate",value:(n=A(T.mark((function e(t,r){var n;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.fetchTemplate(t);case 4:if(n=e.sent,!r){e.next=8;break}return r.innerHTML=n,e.abrupt("return",r);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchTemplate",value:(r=A(T.mark((function e(t){var r;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"flush",value:(t=A(T.mark((function e(){var t,r;return T.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadCss(Object.getOwnPropertyNames(this._cssPaths));case 2:this._cssPaths={},e.t0=T.keys(this._scriptMaps);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(t=e.t1.value,!this._scriptMaps.hasOwnProperty(t)){e.next=10;break}return r=this._scriptMaps[t],e.next=10,this.unloadScript(r.path);case 10:e.next=4;break;case 12:this._scriptMaps={},this._dataPromises={};case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),V=new D;function F(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");e.dispatchEvent(t)}}function L(e,t){var r=window.URL||window.webkitURL,n=document.createElement("a");n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin==window.location.origin?F(n):function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return 200<=t.status&&t.status<=299}(n.href)||(n.target="_blank",F(n))):(n.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(n.href)}),4e4),setTimeout((function(){F(n)}),0))}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e,t){if(e){if("string"==typeof e)return W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?W(e,t):void 0}}function z(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var U,Q={exports:{}},G={};Q.exports=function(){if(U)return G;U=1;var t=e,r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var l,s={},u=null,c=null;for(l in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,l)&&!i.hasOwnProperty(l)&&(s[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===s[l]&&(s[l]=t[l]);return{$$typeof:r,type:e,key:u,ref:c,props:s,_owner:a.current}}return G.Fragment=n,G.jsx=l,G.jsxs=l,G}();var H=Q.exports,Y=a();function Z(){this.name="TOONE.GET",this.maxArgs=2,this.minArgs=1}Z.prototype=new Y.Spread.CalcEngine.Functions.Function,Z.prototype.isContextSensitive=function(){return!0},Z.prototype.evaluate=function(e){var t,r,n=null==e||null===(t=e.source)||void 0===t?void 0:t.getSheet(),o=null==e||null===(r=e.Whe)||void 0===r?void 0:r.arguments;if(o&&n)if(1==o.length){var a=o[0].value,i=n.getDataSource();if(i)return i.getValue(a)}else{var l=o[0].value,s=o[1].value,u=n.getDataSource();if(u){var c=u.getValue(l);if(c&&c.length>0)return c[0][s]}}return""};var X=function(e){!function(e){var t=new Z;e.addCustomFunction(t)}(e)};const K="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABkCAYAAACWy14QAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlBNDFDQzUzRkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlBNDFDQzU0RkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUE0MUNDNTFGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUE0MUNDNTJGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52RmQBAAAR1klEQVR42uxd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";var q=["children"],_=["children"],$=["children"];function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re,ne=function(e){return function(t){var r=t.children,n=O(t,q);return H.jsx("div",te(te({style:e},n),{},{children:r}))}},oe=function(e){return function(t){var r=t.children,n=O(t,_);return H.jsx("span",te(te({style:e},n),{},{children:r}))}},ae=ne({color:"#6a6a6a",textAlign:"center",verticalAlign:"middle",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"440px",whiteSpace:"nowrap"}),ie=(re={display:"inline-block",width:"100px",height:"105px",verticalAlign:"middle"},function(e){var t=e.children,r=O(e,$);return H.jsx("img",te(te({style:re},r),{},{children:t}))}),le=oe({display:"inline-block",paddingLeft:"10px",textAlign:"left",verticalAlign:"middle",fontSize:"14px"}),se=oe({display:"inline-block",fontSize:"20px",fontWeight:"600",opacity:"0.8"});function ue(){return H.jsxs(ae,{children:[H.jsx(ie,{src:K}),H.jsxs(le,{children:[H.jsx(se,{children:"未找到有效许可证！"}),H.jsx("br",{}),"获取正式商业授权涉及费用，收费标准请发送邮件到",H.jsx("br",{}),"vdept@toone.com.cn咨询。"]})]})}var ce=ne({position:"absolute",bottom:"50px",right:"50px",color:"#6a6a6a",zIndex:"999",textAlign:"right",fontSize:"14px",pointerEvents:"none"});function fe(){return H.jsxs(ce,{children:["获取正式商业授权涉及费用，收费标准请发送邮件到",H.jsx("br",{}),"vdept@toone.com.cn咨询"]})}var he=null,de=function(){var e,t=a();try{(new t.Spread.Sheets.Workbook).getSheet(0).setValue(0,0,"test")}catch(r){return{success:!1,showError:!0}}return e=location.hostname,/^(127\.0\.0\.1|localhost)/g.test(e)?{success:!1,showWarn:!0}:{success:!0}};function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ge=a().Spread.Sheets;function we(e,t,r,n){if(!e)return{datas:[],spansTree:[]};var o=t.map((function(e){return e.code})),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.length>0?function e(t,r){var n=z(r),o=new Map,a=n.shift();return t.forEach((function(e){var t=e[a];o.has(t)||o.set(t,{groupName:t,groupCode:a,allChildrens:[]}),o.get(t).allChildrens.push(e)})),o.forEach((function(t){n.length>0&&t.allChildrens.length>0&&(t.childrenGroups=e(t.allChildrens,n))})),o}(e,t):void 0;return new Map([["总",{groupName:"总",groupCode:null,allChildrens:z(e),childrenGroups:r}]])}(e,o),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=[],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).map((function(e){return e.code})),a=o.length>0,i=r.filter((function(e){var r=e.code;return!t.includes(r)&&!o.includes(r)})),l=i.length,s=function e(r){var s=null,u=0,c=[];return r.forEach((function(r,f,h){var d={children:[],verticalSpans:[]},p=r.childrenGroups,v=r.allChildrens,g=r.groupCode,w=r.groupName,y=0,m=t.indexOf(g);if(p){var b,S=e(p);s=S.lastChild,y+=S.totalRowCount,u+=S.totalRowCount,(b=d.children).push.apply(b,z(S.spansTree))}else v.forEach((function(e){s=e;var r=[];if(a){var c={};t.forEach((function(t){c[t]=e[t]}));for(var f=function(){var t=i[h].code;c[t]=e[t];var n=i[h+1].code,a=ve(ve({},c),{},E({},n,"小计"));o.forEach((function(t){var r=Number(e[t]);e[t]=Number.isNaN(r)?0:r,Object.defineProperty(a,t,{get:()=>e[t]})})),r.unshift(a),d.verticalSpans[h]||(d.verticalSpans[h]=[]),d.verticalSpans[h].push({rowCount:l-h,col:m+h+1,colCount:1,row:0,subtotalSpan:{rowCount:1,col:m+h+1+1,colCount:l-h-1,row:0},style:{vAlign:1}}),y++,u++},h=0;h<l-1;h++)f()}y++,u++,n.push.apply(n,[e].concat(r))}));var C={};if(g){if(a){var O=t.indexOf(g);t.forEach((function(e,t){t<=O&&(C[e]=s[e])}));var R=t[O+1];O+1===t.length&&(R=i[0].code),C[g]=w,C[R]="小计",d.subtotalSpan={row:0,col:O+1,rowCount:1,colCount:l+(t.length-O)-1},y++,u++}var A={rowCount:y,col:m,colCount:1,row:0,style:{vAlign:1}};d=ve(ve({},d),A)}else a&&(C[t[0]||(null==i?void 0:i[0].code)]="小计",d=ve(ve({},d),{},{row:u,rowCount:1,col:0,colCount:t.length+l,isTotal:!0}));a&&(o.forEach((function(e){Object.defineProperty(C,e,{get:()=>v.reduce((function(t,r){return t+r[e]}),0)})})),n.push(C)),c.push(d)})),{lastChild:s,totalRowCount:u,spansTree:c}}(e),u=s.spansTree;return{datas:n,spansTree:u}}(a,o,r,n);return{datas:i.datas,spansTree:i.spansTree}}var ye=function(e){return null==e};function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Se=a().Spread.Sheets,Ce=ne({position:"relative",width:"100%",height:"100%",overflow:"visible",userSelect:"none"}),Oe=function(e,t,r){if(r){var n=a().Spread.Sheets.Events[t];e.bind(n,r)}};function Ee(e){var t=e.rules,r=e.row,n=t;return Number.isFinite(r)&&r>=0&&(n=t.filter((function(e){return e.ranges.some((function(e){var t=e.row,n=e.rowCount;return t<=r&&r<t+n}))}))||[]),n}function Re(e){var t=Ee(e);return t=function(e){var t=e.rules,r=e.col,n=e.colHandler,o=t;return Number.isFinite(r)&&r>=0&&(o=o.filter((function(e){var t=e.ranges.some((function(e){var t=e.col,n=e.colCount;return t<=r&&r<t+n}));return t&&"function"==typeof n&&n(JSON.parse(JSON.stringify(e))),t}))),o}(be(be({},e),{},{rules:t}))}function Ae(e){for(var t=e.row,r=e.rows,n=e.spans,o=e.pageRows,a=e.pageSpans,i=e.handler,l=e.startRow,s=void 0===l?0:l,u=e.currentPageRowIndex,c=void 0===u?0:u,f=e.headerDataTableObj,h=e.pageDataTable,d=e.headerRules,p=void 0===d?{}:d,v=e.pageRules,g=void 0===v?[]:v,w=function(e){c=e+s,f[e]&&(h[c]=JSON.parse(JSON.stringify(f[e]))),n.forEach((function(t){t.row===e&&a.push(be(be({},t),{},{row:c}))})),p[e]&&p[e].forEach((function(e){g.push(be(be({},e),{},{ranges:[be(be({},e.ranges[0]),{},{row:c})]}))})),r[e]&&(o[c]=r[e]),i()},y=0;y<t;y++)w(y);return{currentPageRowIndex:c}}function je(e){var t=e.rows,r=e.spans,n=e.pageRows,o=e.pageSpans,a=e.handler,i=e.currentPageRowIndex,l=void 0===i?0:i,s=e.page,u=e.pageDataTable,c=e.rules,f=void 0===c?[]:c,h=e.pageRules,d=void 0===h?[]:h,p=-1,v=-1,g=0;return Object.entries(s).forEach((function(e){var i=J(e,2),s=i[0],c=i[1],h=Number(s),w=1;-1!==p&&(w=h-p),v=l+=w,r.forEach((function(e){e.row===h&&o.push(be(be({},e),{},{row:v}))})),f.forEach((function(e){var t,r=null===(t=e.ranges)||void 0===t?void 0:t[0];(null==r?void 0:r.row)===h&&d.push(be(be({},e),{},{ranges:[be(be({},r),{},{row:v})]}))})),t[h]?(n[v]=t[h],g+=t[h]):g+=20,u[v]=c,p=h,a({addRowCount:w,tableEndRow:v+=w})})),{currentPageRowIndex:l,height:g}}function xe(e){for(var t=e.rows,r=e.spans,n=e.pageRows,o=e.pageSpans,a=e.handler,i=e.currentPageRowIndex,l=void 0===i?0:i,s=e.pageDataTable,u=e.maxTableEndRow,c=e.oldSheetCount,f=e.footerDataTableObj,h=e.footerRules,d=void 0===h?{}:h,p=e.pageRules,v=void 0===p?[]:p,g=function(e){var i=l++;r.forEach((function(t){t.row===e&&o.push(be(be({},t),{},{row:i}))})),t[e]&&(n[i]=t[e]),d[e]&&d[e].forEach((function(e){v.push(be(be({},e),{},{ranges:[be(be({},e.ranges[0]),{},{row:i})]}))})),s[i]=JSON.parse(JSON.stringify(f[e])),a()},w=u+1;w<c;w++)g(w);return{currentPageRowIndex:l}}function Me(e,t){e.rows?(Object.keys(e.rows).forEach((function(t){delete e.rows[t]})),Object.entries(t).forEach((function(t){var r=J(t,2),n=r[0],o=r[1];e.rows[n]=o}))):e.rows=t}function Ie(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={},o={},a={},i=e.sheetCount,l=be({},r),s=[];return Object.entries(r).forEach((function(r){var n,o=J(r,2),u=o[0],c=o[1],f=null==c?void 0:c.groups;if(f){var h=l[u],d={};Object.entries(f).some((function(e){var r=J(e,2),n=r[0],o=r[1];d[n]={};var a=t[n];if(Array.isArray(a)&&Array.isArray(o)&&o.length){var i,l=null==o||null===(i=o[0])||void 0===i?void 0:i.code;a.forEach((function(e){var t=e[l];Array.isArray(d[n][t])||(d[n][t]=[]),d[n][t].push(e)}))}}));var p=null==e||null===(n=e.sheets)||void 0===n?void 0:n[u];if(p){var v=JSON.stringify(p),g=Object.values(d)[0],w=Object.keys(g);w.forEach((function(t,r){for(var n=t,o=1;e.sheets[n];)n=`${t}${o++}`;for(;w.includes(n)&&n!==t||s.includes(n);)n=`${t}${o++}`;if(n!==t){var u=d[t];delete d[t],d[n]=u}if(s.push(n),a[n]=d,r<=0)p.name=n;else{var c=JSON.parse(v);c.name=n,c.isSelected=!1,c.index=i++,c.order=c.index,e.sheets[n]=c,e.sheetCount+=1}l[n]=h}))}return!0}})),Object.values(e.sheets).forEach((function(e){var r=e.name,s=e.spans,u=void 0===s?[]:s,c=e.data,f=e.tables,h=void 0===f?[]:f,d=e.rows,p=void 0===d?{}:d,v=e.conditionalFormats,g=void 0===v?{}:v,w=e.visible;if(0!==(void 0===w?1:w)){var y=JSON.parse(JSON.stringify(p)),m=l[r],b=!!m,S=c.dataTable,C=[],O=[],E=e.rowCount,R=-1,A=-1,j=g.rules||[],x=[],M={};S&&Object.entries(S).forEach((function(e){var t=J(e,2),r=t[0],n=t[1],o=Number(r);Object.entries(n).forEach((function(e){var t,r=J(e,2),n=r[0],a=r[1];a.style;var i=a.bindingPath,l=Number(n),s=u.find((function(e){return e.row===o&&e.col===l}))||{rowCount:1,colCount:1},c={oldRow:o,row:o,col:l,rowCount:s.rowCount,colCount:s.colCount,cellInfo:a,rows:p[o]};if(null!=i&&null!==(t=i.includes)&&void 0!==t&&t.call(i,".")){var f=J(i.split("."),2),h=f[0],d=f[1];C.push(be(be({},c),{},{tableCode:h,field:d})),(-1===R||R>o)&&(R=o),(-1===A||A<o)&&(A=o,s.rowCount>=1&&(A+=s.rowCount-1));for(var v=o;v<o+s.rowCount;v++)M[v]=!0}else a&&Object.keys(a).length&&O.push(c)}))})),-1===A&&(R=E,A=E);var I=function(e){var t=e.other_dataTable,r=e.minTableStartRow,n=e.maxTableEndRow,o=e.rules,a=e.rows,i=e.oldSheetCount,l={},s={},u={},c={};t.forEach((function(e){var t=e.row,a=e.col,i=e.cellInfo;if(!(t>=r&&t<=n)){var f=l,h=u;t>n&&-1!==n&&(f=s,h=c),f[t]=f[t]?f[t]:{},f[t][a]=JSON.parse(JSON.stringify(i));var d=Re({rules:o,row:t,col:a});d&&(h[t]=h[t]?h[t]:[],d.forEach((function(e){h[t].push(be(be({},e),{},{ranges:[{row:t,col:a,rowCount:1,colCount:1}]}))})))}}));for(var f=0,h=0;h<r;h++){var d=null==a?void 0:a[h];f+=d?null==d?void 0:d.size:20}for(var p=0,v=n+1;v<i;v++){var g=null==a?void 0:a[v];p+=g?null==g?void 0:g.size:20}return{headerDataTableObj:l,footerDataTableObj:s,headerRules:u,footerRules:c,headerHeight:f,footerHeight:p}}({other_dataTable:O,minTableStartRow:R,maxTableEndRow:A,rules:j,rows:p,oldSheetCount:E}),k=I.headerDataTableObj,P=I.footerDataTableObj,T=I.headerRules,N=I.footerRules,D=I.headerHeight,V=I.footerHeight,F=e.rowCount||200,L=[{maxRowCount:0,tableCode:"",startRow:-1,oldStartRow:-1,endRow:-1,startCol:-1,endCol:-1,tableColumns:[]}];C.forEach((function(e){var t=e.tableCode,r=e.row,n=e.col,o=e.rowCount,a=e.colCount,i=L[L.length-1];if(i.tableColumns.length<=0)i.startRow=r,i.oldStartRow=r,i.endRow=r,i.maxRowCount=o,i.tableCode=t,i.startCol=n,i.endCol=n+a,i.tableColumns.push(e);else{var l=i.tableColumns[i.tableColumns.length-1],s=l.row,u=l.col,c=l.colCount;l.tableCode===t&&u+c===n&&r===s?(i.maxRowCount<o&&(i.maxRowCount=o),i.endCol=n+a,i.tableColumns.push(e)):L.push({maxRowCount:o,tableCode:t,startRow:r,oldStartRow:r,endRow:r,startCol:n,endCol:n+a,tableColumns:[e]})}}));for(var W={},B=[],z={},U=-1,Q=-1,G={},H=[],Y=function(){var e,n=L.shift();L.length;var o=n.tableCode,i=n.startRow,l=n.endRow,s=n.tableColumns,c=n.oldStartRow,f=n.maxRowCount,d=null==t?void 0:t[o],v=null==a||null===(e=a[r])||void 0===e||null===(e=e[o])||void 0===e?void 0:e[r];if(Array.isArray(v)&&(d=v),Array.isArray(d)){var g=Ee({rules:j,row:c});d.forEach((function(e,t){var r=S[c];W[l]||(W[l]=JSON.parse(JSON.stringify(r)));for(var n=1,o=c+1;o<c+f;o++){var a=S[o];W[l+n]||(W[l+n]=a?JSON.parse(JSON.stringify(a)):{}),G[l+n]=W[l+n],H.push(l+n),n++}null!=p&&p[c]&&(z[l]=be({},null==p?void 0:p[c])),u.forEach((function(e){e.row===c&&B.push(be(be({},e),{},{row:l}))})),g.forEach((function(e){var t,r=(null==e||null===(t=e.ranges)||void 0===t?void 0:t[0])||{},n=r.col,o=r.rowCount,a=r.colCount;x.push(be(be({},e),{},{ranges:[{row:l,rowCount:o,col:n,colCount:a}]}))})),s.forEach((function(t){var r,n=t.field,o=t.col;null!==(r=W[l])&&void 0!==r&&null!==(r=r[o])&&void 0!==r&&r.bindingPath&&delete W[l][o].bindingPath,W[l][o]=W[l][o]?W[l][o]:{},W[l][o].value=e[n];var a=W[l][o].tag;if(a){var i=JSON.parse(a).hyperlinkInfo;i&&"document"===i.type&&i.isAutoDoc&&(W[l][o].hyperlink.url=`sjs://${e[n]}!A1`,W[l][o].hyperlink.tooltip&&(W[l][o].hyperlink.tooltip=e[n]))}})),G[l]=W[l],l+=f,t>0&&(F+=f)}))}if(i===U&&Q>=l)return 1;var w=l-i-1;i===U&&Q<l&&(w=l-Q),U=i,Q=l,O.forEach((function(e){e.row>i+(f>1?f:0)&&e.row<=l&&(e.row+=w)})),L.forEach((function(e){e.startRow>i&&e.startRow<=l&&(e.startRow+=w,e.endRow=e.startRow)})),h.forEach((function(e){e.row>i&&e.row<=l&&(e.row+=w)}))};L.length;)Y();O.forEach((function(e){var t=e.row,r=e.col,n=e.rowCount,o=e.colCount,a=e.cellInfo,i=e.rows,l=e.oldRow;M[t]||(W[t]=W[t]?W[t]:{},W[t][r]=be({},a),a.value&&(W[t][r].value=a.value),(n>1||o>1)&&B.push({row:t,col:r,rowCount:n,colCount:o}),i&&(z[t]=i),Re({rules:j,row:l,col:r,colHandler(e){x.push(be(be({},e),{},{ranges:[{row:t,rowCount:n,col:r,colCount:o}]}))}}))})),Me(e,z),e.conditionalFormats=e.conditionalFormats?e.conditionalFormats:{},e.conditionalFormats.rules=x,e.spans=B,e.data=e.data?e.data:{},e.data.dataTable=W,e.rowCount=F,function(e){var t=e.sheet,r=e.templateInfo,n=e.minTableStartRow,o=e.maxTableEndRow,a=e.headerDataTableObj,i=e.footerDataTableObj,l=e.newRows,s=e.newSpans,u=e.cobyRows,c=e.oldSheetCount,f=e.sheetsInfo,h=e.isTemplate,d=e.sheetCount,p=e.newSheets,v=e.newRules,g=e.headerRules,w=e.footerRules,y=e.contentDataTable,m=e.headerHeight,b=e.footerHeight,S=e.spans,C=e.rows,O=e.virtualRows;if(!h)return;var E=t.printInfo,R=E.paperSize.height,A=void 0===R?1100:R,j=E.margin,x=void 0===j?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:j,M=x.bottom,I=x.footer,k=x.header,P=x.top,T=A-M-I-k-P-m-b,N=0,D=[],V=Object.entries(y),F={},L=[],W=function(){var e=J(V.shift(),2),t=e[0],r=e[1],n=Number(t);if(!O.includes(n)){var o,a=(null==l||null===(o=l[n])||void 0===o?void 0:o.size)||20,i=s.find((function(e){return Number(e.row)===n}));if(i&&i.rowCount>1)for(var u=1;u<i.rowCount;){var c;a+=(null==l||null===(c=l[n+u])||void 0===c?void 0:c.size)||20,u++}i&&(i.rowCount>1||i.colCount>1)&&L.push(i),N+a<T?N+=a:(D.push({dataTable:F,spans:L}),N=a,F={},L=[])}F[n]=r};for(;N<T&&V.length>0;)W();(D.length&&D[D.length-1]!==F||!D.length)&&D.push({dataTable:F,spans:L});var B=d+Object.keys(p).length,z={},U=-1,Q=r.isCurrentSheet,G=0,H=0,Y=0,Z=0;L=[];var X={},K=[],q=JSON.stringify(t);for(;D.length;){var _=D.shift().dataTable;Q||(G=0,H=0,Z++,L=[],X={},K=[],z={});var $={row:n,rows:C,spans:S,pageRows:X,pageSpans:L,handler(){H++},headerDataTableObj:a,pageDataTable:z,pageRules:K,headerRules:g};Q&&($.startRow=Y);var ee=Ae($);G=ee.currentPageRowIndex,G=(ee=je({rows:l,spans:s,pageRows:X,pageSpans:L,handler(e){var t=e.addRowCount,r=e.tableEndRow;H+=t,U=r},currentPageRowIndex:G,page:_,pageDataTable:z,pageRules:K,rules:v})).currentPageRowIndex+1;var te=ee.height;if(o>-1&&(G=(ee=xe({rows:u,spans:S,pageRows:X,pageSpans:L,handler(){H++},currentPageRowIndex:G,pageDataTable:z,footerDataTableObj:i,maxTableEndRow:o,oldSheetCount:c,footerRules:w,pageRules:K})).currentPageRowIndex),!Q){var re=t;Z>1&&((re=JSON.parse(q)).name+="_"+(Z-1),re.index=B++,re.isSelected=!1,p[re.name]=re),ke({_sheet:re,pageDataTable:z,pageRules:K,tableEndRow:U,pageSpans:L,pageRows:X,sheetsInfo:f,pageTotalRow:H})}if(Q){var ne=T-te;if(ne>0){var oe,ae=(null===(oe=C[U])||void 0===oe?void 0:oe.size)||20;G+=Math.ceil(ne/ae)}Y=G}}Q&&ke({_sheet:t,pageDataTable:z,pageRules:K,tableEndRow:U,pageSpans:L,pageRows:X,sheetsInfo:f,pageTotalRow:H+1})}({sheet:e,templateInfo:m,minTableStartRow:R,maxTableEndRow:A,rows:p,spans:u,headerDataTableObj:k,footerDataTableObj:P,newRows:z,newSpans:B,cobyRows:y,oldSheetCount:E,sheetsInfo:n,isTemplate:b,sheetCount:i,newSheets:o,newRules:x,headerRules:T,footerRules:N,contentDataTable:G,headerHeight:D,footerHeight:V,virtualRows:H})}})),Object.entries(o).forEach((function(t){var r=J(t,2),n=r[0],o=r[1];e.sheets[n]=o,e.sheetCount+=1})),n}function ke(e){var t=e._sheet,r=e.pageDataTable,n=e.pageRules,o=e.tableEndRow,a=e.pageSpans,i=e.pageRows,l=e.sheetsInfo,s=e.pageTotalRow,u=s>0?s:t.rowCount,c=t.name;t.data.dataTable=Object.keys(r).length?r:t.data.dataTable,t.rowCount=u,t.conditionalFormats=t.conditionalFormats?t.conditionalFormats:{},t.conditionalFormats.rules=n,t.spans=a,Me(t,i),l[c]=l[c]?l[c]:{},l[c].tableEndRow=o}var Pe=function(e){var t=e.spread,r=e.dataSource,n=e.sumColumns,o=e.groupColumns,a=e.rowMerge,i=e.columnMerge,l=e.rowMergeColumns,s=void 0===l?{}:l,u=e.colMergeColumns,c=void 0===u?{}:u,f=e.isFillData,h=void 0!==f&&f,d=e.sheetsInfo;t&&t.sheets.forEach((function(e){var t,l=JSON.parse(JSON.stringify(r)),u=e.tables.all(),f=[],p=[],v=null;l&&(v=new Se.Bindings.CellBindingSource(l),e.setDataSource(v)),u.length>0&&u.forEach((function(e){var t=e.name(),r=o[t],a=n[t],i=s[t]||[],u=c[t]||[];if(Array.isArray(r)&&r.length>0||Array.isArray(a)&&a.length>0){var h=e.bindingPath(),d=e.range(),v=d.row,g=d.col,w=[];if(e.BSt.forEach((function(e){w.push({code:e.dataField()})})),null!=l&&l[h]){var y=we(l[h],r,w,a),m=y.datas,b=y.spansTree;l[h]=m;var S=function(e){var t=[],r={};return function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=o;n.forEach((function(n){var l=n.row,s=void 0===l?0:l,u=n.col,c=void 0===u?0:u,f=n.rowCount,h=void 0===f?1:f,d=n.colCount,p=void 0===d?1:d,v=n.children,g=void 0===v?[]:v,w=n.verticalSpans,y=void 0===w?[]:w,m=n.subtotalSpan,b=n.isTotal,S=void 0!==b&&b;if(g.length>0&&e(g,i),y.length>0&&y.forEach((function(e,n){var o=i;e.forEach((function(e){if(e.hasOwnProperty("style")){var i=e.col,l=e.style;r[o]||(r[o]={}),r[o][i]||(r[o][i]={}),r[o][i].style=ve({},l)}t.push({row:o,col:e.col+a,rowCount:e.rowCount,colCount:e.colCount}),e.subtotalSpan.colCount>1&&t.push({row:o+e.rowCount-1,col:e.subtotalSpan.col+a,rowCount:e.subtotalSpan.rowCount,colCount:e.subtotalSpan.colCount}),o+=e.rowCount+n}))})),n.hasOwnProperty("style")){var C=n.col,O=n.style;r[i]||(r[i]={}),r[i][C]||(r[i][C]={}),r[i][C].style=ve({},O)}n.hasOwnProperty("row")&&((h>1||p>1)&&(S?t.push({row:s+o,col:c+a,rowCount:h,colCount:p}):t.push({row:i,col:c+a,rowCount:h,colCount:p})),m&&t.push({row:i+h-1,col:m.col+a,rowCount:m.rowCount,colCount:m.colCount}),i+=h)}))}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),{spans:t,dataTableStyle:r}}(b,v+1,g);f.push.apply(f,z(S.spans))}}if(i.length>0||u>0){var C=e.BSt.map((function(e){return{id:e.id(),code:e.dataField(),name:e.name()}})),O=e.range(),E=function(e){var t=e.rowMergeColumns,r=e.colMergeColumns,n=e.tableColumns,o=e.row,a=void 0===o?0:o;e.col;var i=e.rowCount,l=void 0===i?0:i,s=[];if(t.length||r.length){var u=t.map((function(e){return ve(ve({},e),{},{rowMerge:!0,colMerge:!1})}));r.forEach((function(e){var t=u.find((function(t){return t.code===(null==e?void 0:e.code)}));t?t.colMerge=!0:u.push(ve(ve({},e),{},{rowMerge:!1,colMerge:!0}))})),u.sort((function(e,t){return n.findIndex((function(t){return t.code===e.code}))-n.findIndex((function(e){return e.code===t.code}))}));var c=u[0],f=c.rowMerge,h=c.colMerge,d=ge.AutoMerge.AutoMergeDirection.column,p=ge.AutoMerge.AutoMergeMode.free,v=ge.SheetArea.viewport,g=ge.AutoMerge.SelectionMode.merged;f&&h?d=ge.AutoMerge.AutoMergeDirection.rowColumn:f&&(d=ge.AutoMerge.AutoMergeDirection.row);var w={row:a,col:-1,rowCount:l,colCount:1},y=-1;u.forEach((function(e){var t=e.code,r=e.rowMerge,o=e.colMerge,a=n.findIndex((function(e){return e.code===t}));-1===w.col?w.col=a:y+1===a&&f===r?w.colCount+=1:(s.push({range:w,direction:d,mode:p,sheetArea:v,selectionMode:g}),f=r,w={row:1,col:a,rowCount:l+1,colCount:1},d=ge.AutoMerge.AutoMergeDirection.column,r&&o?d=ge.AutoMerge.AutoMergeDirection.rowColumn:r&&(d=ge.AutoMerge.AutoMergeDirection.row)),y=a})),(s.length>0&&s[s.length-1]!==w&&w.col>-1||s.length<=0&&w.col>-1)&&s.push({range:w,direction:d,mode:p,sheetArea:v,selectionMode:g})}return s}({rowMergeColumns:i,colMergeColumns:u,tableColumns:C,row:O.row+1,rowCount:O.rowCount});p.push.apply(p,z(E))}}));var g=e.toJSON();g.spans=Array.isArray(g.spans)?g.spans:[],(t=g.spans).push.apply(t,f),g.autoMergeRangeInfos=p,h&&function(e,t){for(var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.rows,a=void 0===o?{}:o,i=e.rowCount,l=e.printInfo,s=l.paperSize.height,u=void 0===s?1100:s,c=l.margin,f=void 0===c?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:c,h=e.tables,d=void 0===h?[]:h,p=e.data.dataTable,v=void 0===p?{}:p,g=e.name,w=u-f.bottom-f.footer-f.header-f.top,y=0,m=0,b=0,S="";y<i;){var C;m+=(null===(C=a[y])||void 0===C?void 0:C.size)||20,d.forEach((function(e){var t=e.row,r=e.rowCount,n=e.bindingPath;t+r-1===y&&(b=y,S=n)})),m>w?m=0:y++}var O=w-m;if(O>0&&S){var E,R=(null===(E=a[b])||void 0===E?void 0:E.size)||20,A=Math.floor(O/R);if(A>0)for(var j=t.getSource(),x=null==j?void 0:j[S],M=A;M>0;)x.push({}),M--}else if(O>0&&!S&&(null==n||null===(r=n[g])||void 0===r?void 0:r.tableEndRow)>=0){var I,k,P=(null==n||null===(I=n[g])||void 0===I?void 0:I.tableEndRow)-1,T=(null===(k=a[P])||void 0===k?void 0:k.size)||20,N=Math.floor(O/T);if(N>0){var D,V=[],F=null,L=JSON.parse(JSON.stringify(a));if(Object.entries(v).forEach((function(e){var t=J(e,2),r=t[0],n=t[1],o=Number(r);o>P&&V.push({row:o,value:n}),o===P&&(F=JSON.parse(JSON.stringify(n)))})),F){var W=1;for(Object.keys(F).forEach((function(e){F[e]=be(be({},F[e]),{},{value:""})}));W<=N;)v[P+W]=be({},JSON.parse(JSON.stringify(F))),a&&(a[P+W]={size:T}),W++}V.forEach((function(t){var r=t.row,n=t.value,o=r+N;v[o]=n,L[r]&&(e.rows[o]=L[r])})),e.spans&&e.spans.forEach((function(e){e.row>P&&(e.row=e.row+N)}));var B=null==e||null===(D=e.conditionalFormats)||void 0===D?void 0:D.rules;Array.isArray(B)&&B.forEach((function(e){var t,r=e.ranges;(null==r||null===(t=r[0])||void 0===t?void 0:t.row)>P&&(r[0].row=r[0].row+N)})),e.rowCount=e.rowCount+N}}}(g,v,d),e.fromJSON(g),v&&e.setDataSource(v),function(e){var t=e.sheet,r=e.rowMerge,n=e.columnMerge,o=t.tables.all();if(o.length>0&&(r||n)){var a=Se.AutoMerge.AutoMergeDirection.column,i=Se.AutoMerge.AutoMergeMode.free,l=Se.SheetArea.viewport,s=Se.AutoMerge.SelectionMode.merged;r&&n?a=Se.AutoMerge.AutoMergeDirection.rowColumn:r&&(a=Se.AutoMerge.AutoMergeDirection.row),t.suspendPaint(),o.forEach((function(e){var r=e.range();t.autoMerge(r,a,i,l,s)})),t.resumePaint()}}({sheet:e,rowMerge:a,columnMerge:i})}))};function Te(t){var r=t.newTabVisible,s=void 0===r||r,u=t.tabEditable,c=void 0===u||u,f=t.tabStripVisible,h=void 0===f||f,d=t.onInited,p=t.onEnterCell,v=t.onActiveSheetChanged,g=t.onValueChanged,w=t.onSelectionChanged,y=t.onSelectionChanging,m=t.onEditorStatusChanged,b=t.onSheetNameChanged,S=t.onSheetNameChanging,C=t.onActiveSheetChanging,O=t.license,E=t.enablePrint,R=void 0!==E&&E,A=t.json,j=void 0===A?null:A,x=t.onPrintHandler,M=t.children,I=t.baseUrl,k=t.dataSource,P=void 0===k?null:k,T=t.sumColumns,N=void 0===T?[]:T,D=t.groupColumns,F=void 0===D?[]:D,L=t.rowMerge,W=void 0!==L&&L,B=t.columnMerge,z=void 0!==B&&B,U=t.rowMergeColumns,Q=void 0===U?{}:U,G=t.colMergeColumns,Y=void 0===G?{}:G,Z=t.isFillData,K=void 0!==Z&&Z,q=t.template;O&&function(e){he=e}(O),I&&n(I);var _=a(),$=he||"127.0.0.1|localhost,219775434953547#B1rUeINVNvhFez5Eb5Qzaq9UWIpWdDZjWll4Lo9Wb4tSSihzK0pUQPVHT6xWaVVTUJd6L834Qn9mUpd4SZJ6S8JEVy24LOd6MvgGT5R4LwAleVt4MTdjc58Eb7NmSxYkcDd5LXNje6AHSBJESyUzVJZkMQRzbXhDbaBHS6klMQBlTQdHduJTWnJzKL3iM0VWdmZVOEdFeGRXQYVzb5cjeNplaoB7M7hHcrklVCB7aUF5R9cXWQ96TrMUYTtie73ka5QkWqV4aVZVRvcmMyMTQygUe9lTcTlmd0FEWp9kR8Q5UrskWMFTRPdFRyMHdzgjcj56MPdWSwRVN8MkI0IyUiwiI4QzQBJDNwYjI0ICSiwCOxkTM9cTOyEjM0IicfJye&Qf35VficFVDplI0IyQiwiI6EjL6ByUKBCZhVmcwNlI0IiTis7W0ICZyBlIsICNzMTM6ADIzATMwQjMwIjI0ICdyNkIsICdz3GasF6YvxGLx8CMuAjL7ITMiojIz5GRiwiI8+Y9sWY9QmZ0Jyp93uL9hKI0Aqo9Re09byp9MCZ9iojIh94QiwiI7QTNzUTO4MDN5czN9EjMiojIklkIs4XXbpjInxmZiwSZzxWYmpjIyNHZisnOiwmbBJye0ICRiwiI34TUv54Khl4NyU7TltCSkZEWYdDNCRlNMlWVXZjcWFlcud6d5Vkd4JDeu5mdphDUHRER99ESVtGZFN6KupGNPdVVvdUQMhVSW5GOGVHbrNTVvQESxFGNBllZBtG4w";$&&(_.Spread.Sheets.LicenseKey=$);var ee=J(e.useState((function(){var e=de(),t=!1,r=!1;return e.success||(t=e.showError,r=e.showWarn),{spread:null,showError:t,showWarn:r}})),1)[0],te=e.useRef(null),re=e.useMemo((function(){var e=null,t=JSON.parse(JSON.stringify(j));return t&&(e=P&&Ie(t,P,q)),{sheetsInfo:e,json:t}}),[j,P,JSON.stringify(q)]),ne=re.json,oe=re.sheetsInfo;return e.useEffect((function(){if(te.current&&!ee.showError){var e=[];R&&(e=e.concat(function(e){var t=o();return l[e].map((function(e){return t+e}))}("print")));var t=function(){var e=null,t=!ee.spread;if(t){var r=a();e=new r.Spread.Sheets.Workbook(te.current,{sheetCount:0,newTabVisible:s,tabEditable:c,tabStripVisible:h}),ee.spread=e}else e=ee.spread;e.suspendPaint(),e.suspendEvent();try{if(t){if(ne)i(e,(function(){e.fromJSON(ne),X(e);var t=e.sheets;t&&t.length>0&&t.forEach((function(e){e.recalcAll(!0)}))}));else(M?Array.isArray(M)?M:[M]:[]).forEach((function(t,r){var n=t.props,o=n.name,a=void 0===o?`Sheet${r+1}`:o,i=n.rowCount,l=void 0===i?20:i,s=n.colCount,u=void 0===s?20:s,c=new _.Spread.Sheets.Worksheet(a);c.setRowCount(l),c.setColumnCount(u),e.addSheet(r,c)})),X(e);d&&d(e),Oe(e,"EnterCell",p),Oe(e,"ActiveSheetChanged",v),Oe(e,"ValueChanged",g),Oe(e,"ActiveSheetChanging",C),Oe(e,"SheetNameChanged",b),Oe(e,"SheetNameChanging",S),Oe(e,"SelectionChanged",w),Oe(e,"SelectionChanging",y),Oe(e,"SheetChanged",(function(){})),Oe(e,"EditorStatusChanged",m)}P&&Pe({spread:ee.spread,dataSource:P,sumColumns:N,groupColumns:F,rowMerge:W,columnMerge:z,rowMergeColumns:Q,colMergeColumns:Y,isFillData:K,sheetsInfo:oe}),x&&x((function(t){return new Promise((function(r,n){e?R?(e.sheets.forEach((function(e){!function(e,t){var r=t.orientation,n=t.printQuality,o=t.scaleType,i=t.fitPagesTall,l=t.fitPagesWide,s=t.zoomFactor,u=t.firstPageNumber,c=t.paperKind,f=t.margin,h=t.headerAndFooter,d=t.showGridLine,p=t.showHeader,v=t.blackAndWhite,g=t.pageOrder,w=t.showBorder,y=e.printInfo(),m=function(e,t){ye(e)||("string"==typeof t?y[t](e):t(e))};m(r,"orientation"),m(n,"qualityFactor"),ye(o)||(1==o?(i=-1,l=-1,s/=100):0==o&&(s=1),y.zoomFactor(s),y.fitPagesWide(l),y.fitPagesTall(i)),m(u,"firstPageNumber"),m(c,(function(){var e=new(a().Spread.Sheets.Print.PaperSize)(parseInt(c));y.paperSize(e)})),m(f,(function(){var e=f.left,t=f.right,r=f.top,n=f.bottom,o=f.header,i=f.footer,l=f.centering;y.margin({left:100*e,right:100*t,top:100*r,bottom:100*n,header:100*o,footer:100*i});var s=null,u=a();s=null!=l&&l.horizontally?null!=l&&l.vertically?u.Spread.Sheets.Print.PrintCentering.both:u.Spread.Sheets.Print.PrintCentering.horizontal:null!=l&&l.vertically?u.Spread.Sheets.Print.PrintCentering.vertical:u.Spread.Sheets.Print.PrintCentering.none,y.centering(s)})),m(null==h?void 0:h.pageHeaderFooter,"pageHeaderFooter"),m(d,"showGridLine"),m(p,(function(){var e=a(),t=p?e.Spread.Sheets.Print.PrintVisibilityType.show:e.Spread.Sheets.Print.PrintVisibilityType.hide;y.showRowHeader(t),y.showColumnHeader(t)})),m(v,"blackAndWhite"),m(g,"pageOrder"),m(w,"showBorder");var b=y.rowStart();b=-1==b?0:b,y.rowStart(b);var S=y.rowEnd();S=-1==S?e.getRowCount():S,y.rowEnd(S);var C=y.columnStart();C=-1==C?0:C,y.columnStart(C);var O=y.columnEnd();O=-1==O?e.getColumnCount():O,y.columnEnd(O),e.printInfo(y)}(e,t||{})})),e.print(),r()):n(Error("打印失败，原因：初始化报表时未开启打印功能")):n(Error("打印失败，原因：报表未初始化"))}))}))}finally{e.resumePaint(),e.resumeEvent()}};e.length>0?V.loadScript(e).then((function(){t()})):t()}}),[d,p,v,g,w,y,P,N,F,W,z,Q,Y,b,S]),H.jsxs(Ce,{children:[ee.showError?H.jsx(ue,{}):H.jsx("div",{style:{width:"100%",height:"100%",overflow:"visible",userSelect:"none"},ref:te}),!ee.showError&&ee.showWarn?H.jsx(fe,{}):null]})}var Ne=["onInited","ready","dataSource"];function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Fe=function(){function r(e){h(this,r),E(this,"conf",{}),E(this,"spread",null),E(this,"printHandler",null),this.conf=e,e.baseUrl&&n(e.baseUrl)}return g(r,[{key:"replacer",value:function(e,t){if("cornerFold"!==e||"table"!==(null==t?void 0:t.markType))return t}},{key:"mount",value:function(r){var n,o,l,s=this;a().Spread.Common.CultureManager.culture("zh-cn");var u=this.conf||{},c=u.onInited,f=u.ready,h=u.dataSource,d=O(u,Ne),p=null===(n=this.conf)||void 0===n||null===(n=n.json)||void 0===n?void 0:n.reportJson;p&&(p=JSON.parse(JSON.stringify(p,this.replacer)));var v=(null===(o=this.conf)||void 0===o||null===(o=o.json)||void 0===o||null===(o=o.context)||void 0===o?void 0:o.tableDesignSlice)||{},g=v.rowMerge,w=v.columnMerge,y=(null===(l=this.conf)||void 0===l||null===(l=l.json)||void 0===l||null===(l=l.context)||void 0===l?void 0:l.datasourceSlice)||{},m=y.sumColumns,b=y.tableGroups,S=y.rowMergeColumns,E=void 0===S?{}:S,R=y.colMergeColumns,A=void 0===R?{}:R;t.createRoot(r).render(e.createElement(Te,Ve(Ve({onInited:function(e){s.spread=e,c&&c(e),"function"==typeof f&&i(e,(function(){f(new C(e))}))},onPrintHandler:function(e){s.printHandler=e},rowMerge:g,columnMerge:w,sumColumns:m,groupColumns:b,rowMergeColumns:E,colMergeColumns:A,dataSource:h},d),{},{json:p})))}},{key:"exportExcel",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreFormula:!1,ignoreStyle:!1};return new Promise((function(n,i){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".xlsx")?e:e+".xlsx",V.loadScript([o()+"/vendor/plugins/excelio.min.js"]).then((function(){var o=new(a().Spread.Excel.IO),l=JSON.stringify(t.spread.toJSON());o.save(l,(function(t){L(t,e),n()}),(function(e){i(e)}),{columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeBindingSource:!1,includeCalcModelCache:!1,includeEmptyRegionCells:!0,includeFormulas:!r.ignoreFormula,includeStyles:!r.ignoreStyle,includeUnusedNames:!0,password:void 0,rowHeadersAsFrozenColumns:!1,saveAsView:!1})}))):i(Error("导出excel失败，原因:没有传递导出文件名"))}))}},{key:"exportPdf",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{author:"",creator:"",keywords:"",subject:"",title:"",sheetIndex:null};return new Promise((function(n,a){if("string"==typeof e&&""!==e.trim()){e=e.endsWith(".pdf")?e:e+".pdf";var i=o();V.loadScript([i+"/vendor/plugins/print.min.js",i+"/vendor/plugins/pdf.min.js"]).then((function(){t.spread.savePDF((function(t){L(t,e),n()}),(function(e){a(e)}),{author:r.auther,creator:r.application,keywords:r.keyword,subject:r.subject,title:r.title},null==r.sheetIndex?void 0:r.sheetIndex)}))}else a(Error("导出pdf失败，原因:没有传递导出文件名"))}))}},{key:"print",value:function(e){var t=this;return new Promise((function(r,n){t.printHandler?t.printHandler(e).then(r).catch(n):n(Error("打印失败，原因：报表未初始化"))}))}}]),r}();return{FontStyle:{normal:"normal",italic:"italic"},FontWeight:{normal:"normal",bold:"bold"},HAlign:c,LineBorder:w,LineStyle:u,Preview:Fe,VAlign:f,WorkBook:C,WorkSheet:S}}));
