!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom/client")):"function"==typeof define&&define.amd?define(["react","react-dom/client"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).TOONE=e.TOONE||{},e.TOONE.Report=t(e.React,e.ReactDOM))}(this,(function(e,t){"use strict";var r=".",n=function(){return window.GC},o=function(e,t){if(e){e.suspendPaint(),e.suspendCalcService();var r=e.getActiveSheet();try{t(r)}finally{e.resumeCalcService(!1),e.resumePaint()}}},i={print:["print.min.js"],pdf:["print.min.js","pdf.min.js"],excel:["excelio.min.js"]},a=function(e){return i[e].map((function(e){return l(e)}))};var u=function(){var e=n().Spread.Sheets.productInfo.productVersion;return`${r}/vendor/excel/${e}`},l=function(e){return`${u()}/plugins/${e}`},s=n(),c={dashed:s.Spread.Sheets.LineStyle.dashed,dotted:s.Spread.Sheets.LineStyle.dotted,double:s.Spread.Sheets.LineStyle.double,empty:s.Spread.Sheets.LineStyle.empty,thick:s.Spread.Sheets.LineStyle.thick,thin:s.Spread.Sheets.LineStyle.thin},f={center:s.Spread.Sheets.HorizontalAlign.center,left:s.Spread.Sheets.HorizontalAlign.left,right:s.Spread.Sheets.HorizontalAlign.right},h={center:s.Spread.Sheets.VerticalAlign.center,bottom:s.Spread.Sheets.VerticalAlign.bottom,top:s.Spread.Sheets.VerticalAlign.top};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function y(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var w=function(){function e(t,r){p(this,e),this.color=t,this.style=r}return y(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStyle",value:function(e){this.style=e}},{key:"getStyle",value:function(){return this.style}},{key:"_to",value:function(){return new(n().Spread.Sheets.LineBorder)(this.color,this.style)}}]),e}();document.createElement("span");var m=function(e,t){return null==e?t:e},b=function(e,t,r){var o=n(),i=r.fontWeight,a=r.fontStyle,u=r.fontFamily,l=r.fontSize,s=r.textDecoration,c=r.backColor,f=r.foreColor,h=r.wordWrap;!function(e,t,r){for(var n=e.col,o=e.row,i=e.rowCount,a=e.colCount,u=0;u<i;u++)for(var l=0;l<a;l++)r(t,o+u,n+l)}(t,e,(function(e,t,r){var n=new o.Spread.Sheets.Style,p=e.getStyle(t,r),d=function(e){var t="normal",r="normal",n="normal",o="Calibri";if(e)for(var i,a=e.split(/\s+/);i=a.shift();)switch(i){case"normal":break;case"italic":case"oblique":t=i;break;case"small-caps":r=i;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":n=i;break;default:o=i,a.length&&(o+=" "+a.join(" "))}return{fontStyle:t,fontVariant:r,fontWeight:n,fontSize:11,lineHeight:"normal",fontFamily:o}}(p.font);Object.assign(n,p),u=m(u,d.fontFamily),l=m(l,d.fontSize),a=m(a,d.fontStyle),i=m(i,d.fontWeight),s=m(s,p.textDecoration),c=m(c,p.backColor),f=m(f,p.foreColor);var v=function(e){return e&&-1===e.indexOf("'")&&-1===e.indexOf('"')?`"${e}"`:e}(u),g=function(e){var t=e.fontFamily,r=void 0===t?"":t,n=e.fontStyle,o=void 0===n?"":n,i=e.fontVariant,a=void 0===i?"":i,u=e.fontWeight,l=void 0===u?"":u,s=e.fontSize,c=void 0===s?"":s,f=e.lineHeight,h=[o,a,l,c,void 0===f?"":f,r].join(" "),p=document.createElement("span");return p.style.font=h,p.style.font}({fontFamily:v,fontSize:l?`${l}pt`:"",fontStyle:a,fontWeight:i});n.font=g,n.textDecoration=s,n.backColor=c,n.foreColor=f,n.wordWrap=h,e.setStyle(t,r,n)}))},S=function(){function e(t,r){p(this,e),this.sheet=t,this.cellRange=r}return y(e,[{key:"hAlign",value:function(e){this.cellRange.hAlign(e)}},{key:"vAlign",value:function(e){this.cellRange.vAlign(e)}},{key:"setBorder",value:function(e,t){this.cellRange.setBorder(e,t)}},{key:"fontFamily",value:function(e){b(this.sheet,this.cellRange,{fontFamily:e})}},{key:"fontSize",value:function(e){b(this.sheet,this.cellRange,{fontSize:e})}},{key:"fontStyle",value:function(e){b(this.sheet,this.cellRange,{fontStyle:e})}},{key:"fontWeight",value:function(e){b(this.sheet,this.cellRange,{fontWeight:e})}},{key:"wordWrap",value:function(e){b(this.sheet,this.cellRange,{wordWrap:e})}}]),e}(),C=function(){function e(t){p(this,e),this.sheet=t}return y(e,[{key:"name",value:function(e){this.sheet.name(e)}},{key:"getCell",value:function(e,t){var r=this.sheet.getCell(e,t);return new S(this.sheet,r)}},{key:"getRange",value:function(e,t,r,n){var o=this.sheet.getRange(e,t,r,n);return new S(this.sheet,o)}},{key:"addSpan",value:function(e,t,r,n){this.sheet.addSpan(e,t,r,n)}},{key:"addRows",value:function(e,t){this.sheet.addRows(e,t)}},{key:"addColumns",value:function(e,t){this.sheet.addColumns(e,t)}},{key:"setValue",value:function(e,t,r){this.sheet.setValue(e,t,r)}},{key:"setFormula",value:function(e,t,r){this.sheet.setFormula(e,t,r)}},{key:"setRowCount",value:function(e){this.sheet.setRowCount(e)}},{key:"setRowHeight",value:function(e,t){this.sheet.setRowHeight(e,t)}},{key:"setColumnCount",value:function(e){this.sheet.setColumnCount(e)}},{key:"setColumnWidth",value:function(e,t){this.sheet.setColumnWidth(e,t)}},{key:"setDefaults",value:function(e){Object.assign(this.sheet.defaults,e)}},{key:"setOptions",value:function(e){var t=e.colHeaderVisible,r=void 0===t||t,n=e.rowHeaderVisible,o=void 0===n||n,i=e.showHorizontalGridline,a=void 0===i||i,u=e.showVerticalGridline,l=void 0===u||u,s=e.isProtected,c=void 0!==s&&s;Object.assign(this.sheet.options,{colHeaderVisible:r,rowHeaderVisible:o,isProtected:c}),Object.assign(this.sheet.options.gridline,{showHorizontalGridline:a,showVerticalGridline:l})}}]),e}(),O=function(){function e(t){p(this,e),this.spread=t}return y(e,[{key:"addSheet",value:function(e){this.spread.addSheet(e)}},{key:"getSheet",value:function(e){var t=this.spread.getSheet(e);return t?new C(t):null}},{key:"setOptions",value:function(e){var t=e.newTabVisible,r=void 0===t||t,n=e.tabStripVisible,o=void 0===n||n,i=e.showHorizontalScrollbar,a=void 0===i||i,u=e.showVerticalScrollbar,l=void 0===u||u;Object.assign(this.spread.options,{newTabVisible:r,tabStripVisible:o,showHorizontalScrollbar:a,showVerticalScrollbar:l})}}]),e}();function E(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function A(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t,r,n,o,i,a){try{var u=e[i](a),l=u.value}catch(s){return void r(s)}u.done?t(l):Promise.resolve(l).then(n,o)}function j(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){k(i,n,o,a,u,"next",e)}function u(e){k(i,n,o,a,u,"throw",e)}a(void 0)}))}}function x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var I={exports:{}},R={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(R);var M=R.exports;!function(e){var t=M.default;function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=r=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var n,o={},i=Object.prototype,a=i.hasOwnProperty,u=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},s=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(N){h=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),a=new P(n||[]);return u(i,"_invoke",{value:I(e,r,a)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}o.wrap=p;var v="suspendedStart",g="suspendedYield",y="executing",w="completed",m={};function b(){}function S(){}function C(){}var O={};h(O,s,(function(){return this}));var E=Object.getPrototypeOf,A=E&&E(E(D([])));A&&A!==i&&a.call(A,s)&&(O=A);var k=C.prototype=b.prototype=Object.create(O);function j(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,r){function n(o,i,u,l){var s=d(e[o],e,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==t(f)&&a.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,u,l)}),(function(e){n("throw",e,u,l)})):r.resolve(f).then((function(e){c.value=e,u(c)}),(function(e){return n("throw",e,u,l)}))}l(s.arg)}var o;u(this,"_invoke",{value:function(e,t){function i(){return new r((function(r,o){n(e,t,r,o)}))}return o=o?o.then(i,i):i()}})}function I(e,t,r){var o=v;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===w){if("throw"===i)throw a;return{value:n,done:!0}}for(r.method=i,r.arg=a;;){var u=r.delegate;if(u){var l=R(u,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===v)throw o=w,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var s=d(e,t,r);if("normal"===s.type){if(o=r.done?w:g,s.arg===m)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=w,r.method="throw",r.arg=s.arg)}}}function R(e,t){var r=t.method,o=e.iterator[r];if(o===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,R(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var i=d(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(a.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=C,u(k,"constructor",{value:C,configurable:!0}),u(C,"constructor",{value:S,configurable:!0}),S.displayName=h(C,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,h(e,f,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},j(x.prototype),h(x.prototype,c,(function(){return this})),o.AsyncIterator=x,o.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var a=new x(p(e,t,r,n),i);return o.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(k),h(k,f,"Generator"),h(k,s,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},o.values=D,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return u.type="throw",u.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],u=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=a.call(i,"catchLoc"),s=a.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),m}},o}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(I);var T=(0,I.exports)(),P=T;try{regeneratorRuntime=T}catch(tt){"object"==typeof globalThis?globalThis.regeneratorRuntime=T:Function("r","regeneratorRuntime = r")(T)}const D=x(P);var N=function(e){return e?"string"==typeof e&&(e=[e]):e=[],e},V=function(){function e(){p(this,e),this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptMaps={},this._dataPromises={}}var t,r,n,o,i,a,u,l;return y(e,[{key:"loadScript",value:(l=j(D.mark((function e(t){var r,n,o,i=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],(t=N(t)).forEach((function(e){(n=i._scriptMaps[e]=i._scriptMaps[e]||{}).promise||(n.path=e,n.promise=new Promise((function(t){(r=i.createScriptElement()).setAttribute("type","text/javascript"),r.src=e,r.addEventListener("load",t),i._head.appendChild(r)}))),o.push(n.promise)})),e.abrupt("return",Promise.all(o));case 4:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"unloadScript",value:(u=j(D.mark((function e(t){var r,n=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(r=n._head.querySelectorAll('script[src="'+e+'"]')[0])&&(n._head.removeChild(r),delete n._scriptMaps[e])})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"createScriptElement",value:function(){return document.createElement("script")}},{key:"fetchData",value:(a=j(D.mark((function e(t){var r,n,o=arguments;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},n=t+JSON.stringify(r),r.cache=void 0===r.cache||r.cache,t){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this._dataPromises[n]&&r.cache){e.next=16;break}return e.prev=6,e.next=9,fetch(t,r);case 9:this._dataPromises[n]=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),this._dataPromises[n]=null,e.t0;case 16:return e.abrupt("return",this._dataPromises[n]);case 17:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return a.apply(this,arguments)})},{key:"loadCss",value:(i=j(D.mark((function e(t){var r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){if(!r._cssPaths[e]){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),r._head.appendChild(t),r._cssPaths[e]=t}})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"unloadCss",value:(o=j(D.mark((function e(t){var r,n=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(r=n._cssPaths[e])&&(n._head.removeChild(r),n._cssPaths[e]=null)})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadTemplate",value:(n=j(D.mark((function e(t,r){var n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.fetchTemplate(t);case 4:if(n=e.sent,!r){e.next=8;break}return r.innerHTML=n,e.abrupt("return",r);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchTemplate",value:(r=j(D.mark((function e(t){var r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"flush",value:(t=j(D.mark((function e(){var t,r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadCss(Object.getOwnPropertyNames(this._cssPaths));case 2:this._cssPaths={},e.t0=D.keys(this._scriptMaps);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(t=e.t1.value,!this._scriptMaps.hasOwnProperty(t)){e.next=10;break}return r=this._scriptMaps[t],e.next=10,this.unloadScript(r.path);case 10:e.next=4;break;case 12:this._scriptMaps={},this._dataPromises={};case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),F=new V;function L(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");e.dispatchEvent(t)}}function W(e,t){var r=window.URL||window.webkitURL,n=document.createElement("a");n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin==window.location.origin?L(n):function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return 200<=t.status&&t.status<=299}(n.href)||(n.target="_blank",L(n))):(n.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(n.href)}),4e4),setTimeout((function(){L(n)}),0))}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e,t){if(e){if("string"==typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(e,t):void 0}}function z(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(c){s=!0,o=c}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J,G={exports:{}},Q={};G.exports=function(){if(J)return Q;J=1;var t=e,r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var u,l={},s=null,c=null;for(u in void 0!==n&&(s=""+n),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,u)&&!a.hasOwnProperty(u)&&(l[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps)void 0===l[u]&&(l[u]=t[u]);return{$$typeof:r,type:e,key:s,ref:c,props:l,_owner:i.current}}return Q.Fragment=n,Q.jsx=u,Q.jsxs=u,Q}();var Z=G.exports,Y=n();function X(){this.name="TOONE.GET",this.maxArgs=2,this.minArgs=1}X.prototype=new Y.Spread.CalcEngine.Functions.Function,X.prototype.isContextSensitive=function(){return!0},X.prototype.evaluate=function(e){var t,r,n=null==e||null===(t=e.source)||void 0===t?void 0:t.getSheet(),o=null==e||null===(r=e.Whe)||void 0===r?void 0:r.arguments;if(o&&n)if(1==o.length){var i=o[0].value,a=n.getDataSource();if(a)return a.getValue(i)}else{var u=o[0].value,l=o[1].value,s=n.getDataSource();if(s){var c=s.getValue(u);if(c&&c.length>0)return c[0][l]}}return""};var K=function(e){!function(e){var t=new X;e.addCustomFunction(t)}(e)};const q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABkCAYAAACWy14QAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlBNDFDQzUzRkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlBNDFDQzU0RkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUE0MUNDNTFGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUE0MUNDNTJGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52RmQBAAAR1klEQVR42uxd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";var _=["children"],$=["children"],ee=["children"];function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ne,oe=function(e){return function(t){var r=t.children,n=E(t,_);return Z.jsx("div",re(re({style:e},n),{},{children:r}))}},ie=function(e){return function(t){var r=t.children,n=E(t,$);return Z.jsx("span",re(re({style:e},n),{},{children:r}))}},ae=oe({color:"#6a6a6a",textAlign:"center",verticalAlign:"middle",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"440px",whiteSpace:"nowrap"}),ue=(ne={display:"inline-block",width:"100px",height:"105px",verticalAlign:"middle"},function(e){var t=e.children,r=E(e,ee);return Z.jsx("img",re(re({style:ne},r),{},{children:t}))}),le=ie({display:"inline-block",paddingLeft:"10px",textAlign:"left",verticalAlign:"middle",fontSize:"14px"}),se=ie({display:"inline-block",fontSize:"20px",fontWeight:"600",opacity:"0.8"});function ce(){return Z.jsxs(ae,{children:[Z.jsx(ue,{src:q}),Z.jsxs(le,{children:[Z.jsx(se,{children:"未找到有效许可证！"}),Z.jsx("br",{}),"获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询。"]})]})}var fe=oe({position:"absolute",bottom:"50px",right:"50px",color:"#6a6a6a",zIndex:"999",textAlign:"right",fontSize:"14px",pointerEvents:"none"});function he(){return Z.jsxs(fe,{children:["获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询"]})}function pe(e,t){return(pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}function ve(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ye=function(){function e(t){p(this,e),this.plugin=t}return y(e,[{key:"getConfig",value:function(){return this.plugin?this.plugin.config:null}},{key:"execute",value:function(e,t){return e}}]),e}();function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ge(e);if(t){var o=ge(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ve(this,r)}}var be=[["url",""],["mode",1],["height",0],["width",0],["clipX",0],["clipY",0],["clipHeight",0],["clipWidth",0],["vAlign",1],["hAlign",1]],Se=function(e){var t=["IMAGE("];return be.forEach((function(r){var n,o=void 0;Array.isArray(r)?(n=r[0],o=r[1]):n=r;var i=e[n];i=i===o?void 0:i,t.push(function(e){return isNullOrUndef(e)?"":e}(i)),t.push(",")})),t.pop(),t.push(")"),t.join("")},Ce=function(e){de(r,e);var t=me(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"execute",value:function(e,t){var r=this.getConfig(),n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({url:"formula"==e.type?e.value:`"${e.value}"`},r);return{type:"formula",value:Se(n)}}}]),r}(ye);function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ge(e);if(t){var o=ge(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ve(this,r)}}var Ee=function(e){de(r,e);var t=Oe(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"execute",value:function(e,t){return{type:"text",value:t.getPage()}}}]),r}(ye);function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ge(e);if(t){var o=ge(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ve(this,r)}}var ke=function(e){de(r,e);var t=Ae(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"execute",value:function(e,t){var r=this.getConfig(),o=r.functionNum,i=r.tableCode,a=r.fieldCode,u=t.getFieldIndex(i,a),l=u.row,s=u.col,c=t.getDataCount(i),f=n(),h=f.Spread.Sheets.CalcEngine.RangeReferenceRelative.allRelative;return{type:"formula",value:`SUBTOTAL(${o},${(0,f.Spread.Sheets.CalcEngine.rangesToFormula)([new f.Spread.Sheets.Range(l,s,c,1)],0,0,h,!1)})`}}}]),r}(ye);function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ge(e);if(t){var o=ge(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ve(this,r)}}var xe=function(e){de(r,e);var t=je(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"execute",value:function(e,t){return{type:"text",value:t.getTotalPages()}}}]),r}(ye),Ie=function(){function e(){p(this,e)}return y(e,[{key:"setFieldIndexHandler",value:function(e){this.fieldIndexHandler=e}},{key:"setDataCountHandler",value:function(e){this.dataCountHandler=e}},{key:"setPageHandler",value:function(e){this.pageHandler=e}},{key:"setTotalPagesHandler",value:function(e){this.totalPagesHandler=e}},{key:"getFieldIndex",value:function(e,t){return this.fieldIndexHandler(e,t)}},{key:"getDataCount",value:function(e){return this.dataCountHandler(e)}},{key:"getPage",value:function(){return this.pageHandler()}},{key:"getTotalPages",value:function(){return this.totalPagesHandler()}}]),e}(),Re=function(e,t,r){return t.forEach((function(t){var n=function(e){var t=e.type;switch(t){case"cellImage":return new Ce(e);case"cellSubTotal":return new ke(e);case"pageCellType":return new Ee(e);case"totalPagesCellType":return new xe(e);default:throw Error("未识别插件类型【"+t+"】，请检查！")}}(t);e=n.execute(e,r)})),e};function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pe(e){var t=e.spans,r=e.row,n=e.startRow,o=[],i=1;return t.forEach((function(e){e.row===r&&(o.push(Te(Te({},e),{},{row:r-n})),e.rowCount>i&&(i=e.rowCount))})),{spans:o,maxRowCount:i}}function De(e){var t=e.dataTable,r=e.pluginTool;Object.entries(t).forEach((function(e){var n=U(e,2),o=n[0];!function(e){var t=e.tag,r=e.dataTable,n=e.pluginTool;if(t){var o=JSON.parse(t).plugins;if(Array.isArray(o)){var i=Re("",o,n),a=i.type,u=i.value;r["formula"===a?a:"value"]=u}}}({tag:n[1].tag,dataTable:t[o],pluginTool:r})}))}function Ne(e){return function(){return e}}function Ve(e){return JSON.parse(JSON.stringify(e))}function Fe(e,t){return(null==e?void 0:e[t])||{size:20}}var Le=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p(this,e);var o=this,i={},a={},u=t.sheetCount,l=Te({},n),s=[];Object.entries(n).forEach((function(e){var n,o=U(e,2),i=o[0],c=o[1],f=null==c?void 0:c.groups;if(f){var h=l[i],p={};Object.entries(f).some((function(e){var t=U(e,2),n=t[0],o=t[1];p[n]={};var i=r[n];if(Array.isArray(i)&&Array.isArray(o)&&o.length){var a,u=null==o||null===(a=o[0])||void 0===a?void 0:a.code;i.forEach((function(e){var t=e[u];Array.isArray(p[n][t])||(p[n][t]=[]),p[n][t].push(e)}))}}));var d=null==t||null===(n=t.sheets)||void 0===n?void 0:n[i];if(d){var v=JSON.stringify(d),g=Object.values(p)[0],y=Object.keys(g);y.forEach((function(e,r){for(var n=e,o=1;t.sheets[n];)n=`${e}${o++}`;for(;y.includes(n)&&n!==e||s.includes(n);)n=`${e}${o++}`;if(n!==e){var i=p[e];delete p[e],p[n]=i}if(s.push(n),a[n]=p,r<=0)d.name=n;else{var c=JSON.parse(v);c.name=n,c.isSelected=!1,c.index=u++,c.order=c.index,t.sheets[n]=c,t.sheetCount+=1}l[n]=h}))}return!0}})),Object.values(t.sheets).forEach((function(e){var t,n=e,s=n.name,c=n.visible,f=void 0===c?1:c,h=n.spans,p=void 0===h?[]:h,d=n.rowCount,v=void 0===d?200:d,g=n.data,y=n.rows,w=void 0===y?{}:y,m=n.conditionalFormats,b=void 0===m?{}:m,S=n.printInfo,C=S.paperSize.height,O=void 0===C?1100:C,E=S.margin,A=void 0===E?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:E;if(0!==f){var k=A.bottom,j=A.footer,x=A.header,I=A.top,R=l[s],M=!!R,T="",P=!1,D=null==g||null===(t=g.defaultDataNode)||void 0===t?void 0:t.tag;if(D){var N=JSON.parse(D);T=(null==N?void 0:N.pageArea)||"",P=null==N?void 0:N.isFillData}var V=o.splitTemp({spans:p,rows:w,rules:null==b?void 0:b.rules,dataTable:null==g?void 0:g.dataTable,rowCount:v},{pageArea:T,type:"page"}),F=V.tableInfos,L=V.headerInfos,W=V.footerInfos;L=o.beforeRender(L,r),W=o.beforeRender(W,r);var H={height:0,spans:[],rows:{},rules:[],dataTable:{},rowCount:0,contentHeight:O-k-j-x-I-L.height-W.height,headerInfos:L,footerInfos:W,isTemplate:M,pageIndex:1,pageTotal:1,pageSize:0,sheet:n,isFillData:P,pageArea:T,pageType:"page"};o.enhanceTable({tableInfos:F,pageInfos:H,datas:r,groupsDatas:a,sheetName:s});var B=new Ie,z=function(){return H.pageTotal};H.totalPagesHandler=z;var U=Ne(1);B.setPageHandler(U),B.setTotalPagesHandler(z),o.render({pageInfos:H,isTemplate:M,headerInfos:L,footerInfos:W,pluginTool:B,tableInfos:F,templateInfo:R,newSheets:i,sheetCount:u})}})),Object.entries(i).forEach((function(e){var r=U(e,2),n=r[0],o=r[1];t.sheets[n]=o,t.sheetCount+=1}))}return y(e,[{key:"renderTableHandler",value:function(e){var t=e.dataTable,r=e.pageInfos,n=e.tableData,o=Ve(t);Object.entries(o).forEach((function(e){var t=U(e,2),o=t[0],i=t[1],a=Number(o)+r.rowCount;r.dataTable[a]={},Object.entries(i).forEach((function(e){var t,o=U(e,2),i=o[0],u=o[1],l=u.bindingPath;if(null!=l&&null!==(t=l.includes)&&void 0!==t&&t.call(l,".")){var s,c=U(l.split("."),2),f=c[0],h=c[1];delete u.bindingPath;var p=(null==n||null===(s=n[f])||void 0===s?void 0:s[h])||"";u.value=p;var d=u.tag;if(d){var v=JSON.parse(d).hyperlinkInfo;v&&"document"===v.type&&v.isAutoDoc&&(u.hyperlink.url=`sjs://${p}!A1`,u.hyperlink.tooltip&&(u.hyperlink.tooltip=p))}}r.dataTable[a][i]=u}))}))}},{key:"render",value:function(e){for(var t,r,n=this,o=e.pageInfos,i=e.isTemplate,a=e.headerInfos,u=e.footerInfos,l=e.pluginTool,s=e.tableInfos,c=e.templateInfo,f=e.newSheets,h=void 0===f?{}:f,p=e.sheetCount,d=void 0===p?0:p,v=0,g=null==c?void 0:c.isCurrentSheet,y=d+Object.keys(h).length,w=o.sheet,m=JSON.stringify(w),b=o.isFillData?o.pageSize:null==s||null===(t=s.pageSizes)||void 0===t||null===(r=t.shift)||void 0===r?void 0:r.call(t);v<o.pageTotal;){if(i&&!g&&(o.dataTable={},o.spans=[],o.rows={},o.rules=[],o.pageIndex=1,o.rowCount=0),this.commonDataTableHandler({infos:a,pageInfos:o,pluginTool:l}),-1!==s.startRow){for(var S=s,C=S.startRow,O=S.endRow,E=S.dataTable,A=S.tableDatas,k=S.pageSizes,j=void 0===k?[]:k,x=O-C,I={pageInfos:o,temp:S},R=0,M=function(){var e={};Object.entries(A).forEach((function(t){var r=U(t,2),n=r[0],o=r[1];o.length&&(e[n]=o.shift())})),R++,n.genOtherInfos(I),n.renderTableHandler({dataTable:E,pageInfos:o,tableData:e}),o.rowCount+=x};R<b;)M();o.isFillData||(b=j.shift())}this.commonDataTableHandler({infos:u,pageInfos:o}),(i&&v+1<o.pageTotal&&g||!i&&"page"===o.pageType)&&(o.rowCount+=o.otherRowCount),i&&!g&&(v>0&&((w=JSON.parse(m)).name+=`_${v}`,w.index=y++,w.isSelected=!1,h[w.name]=w),this.resetSheet(Te(Te({},o),{},{sheet:w}))),v++,o.pageIndex+=1}(!i||i&&g)&&this.resetSheet(Te(Te({},o),{},{sheet:w}))}},{key:"resetSheet",value:function(e){var t=e.sheet,r=e.dataTable,n=e.rules,o=e.spans,i=e.rows,a=e.rowCount;if(t){var u=a>0?a:t.rowCount;t.data.dataTable=Object.keys(r).length?r:t.data.dataTable,t.rowCount=u,t.conditionalFormats=t.conditionalFormats?t.conditionalFormats:{},t.conditionalFormats.rules=n,t.spans=o,this.setSheetRows(t,i)}}},{key:"enhanceTable",value:function(e){var t=e.tableInfos,r=e.datas,n=e.pageInfos,o=e.groupsDatas,i=e.sheetName;if(-1!==t.startRow){var a=t,u=a.tableCodes,l=Object.keys(u);if(l.length){var s={};if(t.tableDatas=s,t.dataCount=0,t.pageSizes=[],l.forEach((function(e){var n,a=r[e],u=null==o||null===(n=o[i])||void 0===n||null===(n=n[e])||void 0===n?void 0:n[i];Array.isArray(u)&&(a=u),s[e]=Ve(a);var l=a.length;l>t.dataCount&&(t.dataCount=l)})),n.pageArea){var c=this.calcTempHeight(a);n.pageSize=Math.floor(n.contentHeight/c),n.pageTotal=Math.ceil(t.dataCount/n.pageSize);for(var f=t.dataCount;f>=n.pageSize;)t.pageSizes.push(n.pageSize),f-=n.pageSize;f>0&&t.pageSizes.push(f);var h=n.contentHeight-c*n.pageSize;if(h>0){var p=Math.floor(h/20);n.otherRowCount=p}}else n.pageSize=t.dataCount,t.pageSizes.push(t.dataCount)}}}},{key:"beforeRender",value:function(e,t){var r={dataTable:{},rowCount:0,spans:[],rows:{},height:0,rules:[],pageTotal:1},n=this.splitTemp(e),o=n.tableInfos,i=n.headerInfos,a=n.footerInfos;return this.enhanceTable({tableInfos:o,datas:t,pageInfos:r}),this.render({pageInfos:r,headerInfos:i,footerInfos:a,tableInfos:o}),r}},{key:"commonDataTableHandler",value:function(e){var t=e.infos,r=e.pageInfos,n=void 0===r?{}:r,o=e.pluginTool,i=n.dataTable,a=void 0===i?{}:i,u=t.dataTable,l=t.rowCount;Object.entries(u).forEach((function(e){var t=U(e,2),r=t[0],i=t[1];o&&(o.setPageHandler(Ne(n.pageIndex)),De({dataTable:i,pluginTool:o}));var u=Number(r)+n.rowCount;a[u]=Ve(i)})),this.genOtherInfos({pageInfos:n,temp:t}),n.rowCount+=l}},{key:"calcTempHeight",value:function(e){for(var t=0,r=e.startRow,n=e.endRow,o=e.rows,i=n-r,a=0;a<i;a++){var u;t+=(null==o||null===(u=o[a])||void 0===u?void 0:u.size)||20}return t}},{key:"genOtherInfos",value:function(e){var t=e.pageInfos,r=void 0===t?{}:t,n=e.temp,o=void 0===n?{}:n,i=r.spans,a=void 0===i?[]:i,u=r.rows,l=void 0===u?{}:u,s=r.rules,c=void 0===s?[]:s,f=r.rowCount,h=void 0===f?0:f,p=o.spans,d=void 0===p?[]:p,v=o.rows,g=void 0===v?{}:v,y=o.rules,w=void 0===y?[]:y;d.forEach((function(e){a.push(Te(Te({},e),{},{row:e.row+h}))})),Object.entries(g).forEach((function(e){var t=U(e,2),n=t[0],o=t[1],i=Number(n)+h;l[i]=o,!1!==(null==o?void 0:o.visible)&&(r.height+=(null==o?void 0:o.size)||20)})),w.forEach((function(e){c.push(Te(Te({},e),{},{ranges:[Te(Te({},e.ranges[0]),{},{row:e.ranges[0].row+h})]}))}))}},{key:"splitTemp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.spans,n=void 0===r?[]:r,o=e.rowCount,i=void 0===o?200:o,a=e.rows,u=void 0===a?{}:a,l=e.dataTable,s=void 0===l?{}:l,c=e.rules,f=void 0===c?[]:c,h=t.type,p=void 0===h?"noPage":h,d=t.pageArea,v=[],g={dataTable:{},rowCount:0,spans:[],rows:{},height:0,rules:[]},y={dataTable:{},rowCount:0,spans:[],rows:{},height:0,rules:[]},w={},m={dataTable:{},rowCount:0,spans:[],rows:{},height:0,rules:[],startRow:-1,endRow:-1,tableCodes:w},b=0,S=-1,C=-1;if(d&&/^\d+:\d+$/.test(d)){var O=d.split(":");S=Number(O[0])-1,C=Number(O[1])-1}if(s)for(var E=function(e){var t=(null==s?void 0:s[e])||{},r=!1,o="page"===p&&e>=S&&e<=C;o&&(r=!0,-1===m.startRow&&(m.startRow=e,b=e));var i=function(e){var t=e.rules,r=e.row,n=t;return Number.isFinite(r)&&r>=0&&(n=t.filter((function(e){return e.ranges.some((function(e){var t=e.row,n=e.rowCount;return t<=r&&r<t+n}))}))||[]),n}({rules:f,row:e}),a=[];if(Object.entries(t).forEach((function(t){var n,u=U(t,2),l=u[0],s=u[1].bindingPath,c=Number(l),f=null==s||null===(n=s.includes)||void 0===n?void 0:n.call(s,".");if(f){var h=s.split(".")[0];(o||"page"!==p)&&(w[h]=!0,-1===m.startRow&&(m.startRow=e,b=e),r=f)}var d=e-b;!function(e){var t=e.rules,r=e.col,n=e.colHandler,o=t;Number.isFinite(r)&&r>=0&&(o=o.filter((function(e){var t=e.ranges.some((function(e){var t=e.col,n=e.colCount;return t<=r&&r<t+n}));return t&&"function"==typeof n&&n(Ve(e)),t})))}({rules:i,col:c,colHandler(e){a.push(Te(Te({},e),{},{ranges:[{row:d,col:c,rowCount:1,colCount:1}]}))}})})),r){var l,c,h=e-m.startRow,d=Pe({spans:n,row:e,startRow:m.startRow}),y=d.spans,O=d.maxRowCount;return m.endRow=e+O,m.dataTable[h]=t,m.rows[h]=Fe(u,e),(l=m.rules).push.apply(l,a),(c=m.spans).push.apply(c,z(y)),1}var E,A,k=Pe({spans:n,row:e,startRow:b}).spans;-1===m.startRow?(g.dataTable[e]=t,g.rows[e]=Fe(u,e),(E=g.rules).push.apply(E,a),(A=g.spans).push.apply(A,z(k))):v.push({rules:a,row:e,dataTable:t,spans:k})},A=0;A<i;A++)E(A);-1!==m.startRow&&v.forEach((function(e){var t=e.row,r=e.dataTable,n=e.rules,o=e.spans,i=y,a=t-m.endRow;t<m.endRow&&(i=m,a=t-m.startRow),o.forEach((function(e){i.spans.push(Te(Te({},e),{},{row:a}))})),function(e){var t=e.row,r=e.rules,n=e.newRules;r.forEach((function(e){n.push(Te(Te({},e),{},{ranges:[Te(Te({},e.ranges[0]),{},{row:t})]}))}))}({rules:n,newRules:i.rules,row:a}),i.dataTable[a]=r,i.rows[a]=Fe(u,t)})),-1===m.startRow?g.rowCount=i:g.rowCount=m.startRow,-1!==m.endRow&&(y.rowCount=i-m.endRow);for(var k=0;k<g.rowCount;k++){var j;g.height+=(null==g||null===(j=g.rows)||void 0===j?void 0:j[k].size)||20}for(var x=0;x<y.rowCount;x++){var I;y.height+=(null==y||null===(I=y.rows)||void 0===I||null===(I=I[x])||void 0===I?void 0:I.size)||20}return{headerInfos:g,footerInfos:y,tableInfos:m}}},{key:"setSheetRows",value:function(e,t){if(e.rows)return Object.keys(e.rows).forEach((function(t){delete e.rows[t]})),void Object.entries(t).forEach((function(t){var r=U(t,2),n=r[0],o=r[1];e.rows[n]=o}));e.rows=t}}]),e}(),We=null,He=function(){var e,t=n();try{(new t.Spread.Sheets.Workbook).getSheet(0).setValue(0,0,"test")}catch(r){return{success:!1,showError:!0}}return e=location.hostname,/^(127\.0\.0\.1|localhost)/g.test(e)?{success:!1,showWarn:!0}:{success:!0}};function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ue=n().Spread.Sheets;function Je(e,t,r,n){if(!e)return{datas:[],spansTree:[]};var o=t.map((function(e){return e.code})),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.length>0?function e(t,r){var n=z(r),o=new Map,i=n.shift();return t.forEach((function(e){var t=e[i];o.has(t)||o.set(t,{groupName:t,groupCode:i,allChildrens:[]}),o.get(t).allChildrens.push(e)})),o.forEach((function(t){n.length>0&&t.allChildrens.length>0&&(t.childrenGroups=e(t.allChildrens,n))})),o}(e,t):void 0;return new Map([["总",{groupName:"总",groupCode:null,allChildrens:z(e),childrenGroups:r}]])}(e,o),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=[],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).map((function(e){return e.code})),i=o.length>0,a=r.filter((function(e){var r=e.code;return!t.includes(r)&&!o.includes(r)})),u=a.length,l=function e(r){var l=null,s=0,c=[];return r.forEach((function(r,f,h){var p={children:[],verticalSpans:[]},d=r.childrenGroups,v=r.allChildrens,g=r.groupCode,y=r.groupName,w=0,m=t.indexOf(g);if(d){var b,S=e(d);l=S.lastChild,w+=S.totalRowCount,s+=S.totalRowCount,(b=p.children).push.apply(b,z(S.spansTree))}else v.forEach((function(e){l=e;var r=[];if(i){var c={};t.forEach((function(t){c[t]=e[t]}));for(var f=function(){var t=a[h].code;c[t]=e[t];var n=a[h+1].code,i=ze(ze({},c),{},A({},n,"小计"));o.forEach((function(t){var r=Number(e[t]);e[t]=Number.isNaN(r)?0:r,Object.defineProperty(i,t,{get:()=>e[t]})})),r.unshift(i),p.verticalSpans[h]||(p.verticalSpans[h]=[]),p.verticalSpans[h].push({rowCount:u-h,col:m+h+1,colCount:1,row:0,subtotalSpan:{rowCount:1,col:m+h+1+1,colCount:u-h-1,row:0},style:{vAlign:1}}),w++,s++},h=0;h<u-1;h++)f()}w++,s++,n.push.apply(n,[e].concat(r))}));var C={};if(g){if(i){var O=t.indexOf(g);t.forEach((function(e,t){t<=O&&(C[e]=l[e])}));var E=t[O+1];O+1===t.length&&(E=a[0].code),C[g]=y,C[E]="小计",p.subtotalSpan={row:0,col:O+1,rowCount:1,colCount:u+(t.length-O)-1},w++,s++}var k={rowCount:w,col:m,colCount:1,row:0,style:{vAlign:1}};p=ze(ze({},p),k)}else i&&(C[t[0]||(null==a?void 0:a[0].code)]="小计",p=ze(ze({},p),{},{row:s,rowCount:1,col:0,colCount:t.length+u,isTotal:!0}));i&&(o.forEach((function(e){Object.defineProperty(C,e,{get:()=>v.reduce((function(t,r){return t+r[e]}),0)})})),n.push(C)),c.push(p)})),{lastChild:l,totalRowCount:s,spansTree:c}}(e),s=l.spansTree;return{datas:n,spansTree:s}}(i,o,r,n);return{datas:a.datas,spansTree:a.spansTree}}var Ge=function(e){return null==e},Qe=n().Spread.Sheets,Ze=oe({position:"relative",width:"100%",height:"100%",overflow:"visible",userSelect:"none"}),Ye=function(e,t,r){if(r){var o=n().Spread.Sheets.Events[t];e.bind(o,r)}},Xe=function(e){var t=e.spread,r=e.dataSource,n=e.sumColumns,o=e.groupColumns,i=e.rowMerge,a=e.columnMerge,u=e.rowMergeColumns,l=void 0===u?{}:u,s=e.colMergeColumns,c=void 0===s?{}:s;t&&t.sheets.forEach((function(e){var t,u=JSON.parse(JSON.stringify(r)),s=e.tables.all(),f=[],h=[],p=null;u&&(p=new Qe.Bindings.CellBindingSource(u),e.setDataSource(p)),s.length>0&&s.forEach((function(e){var t=e.name(),r=o[t],i=n[t],a=l[t]||[],s=c[t]||[];if(Array.isArray(r)&&r.length>0||Array.isArray(i)&&i.length>0){var p=e.bindingPath(),d=e.range(),v=d.row,g=d.col,y=[];if(e.BSt.forEach((function(e){y.push({code:e.dataField()})})),null!=u&&u[p]){var w=Je(u[p],r,y,i),m=w.datas,b=w.spansTree;u[p]=m;var S=function(e){var t=[],r={};return function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=o;n.forEach((function(n){var u=n.row,l=void 0===u?0:u,s=n.col,c=void 0===s?0:s,f=n.rowCount,h=void 0===f?1:f,p=n.colCount,d=void 0===p?1:p,v=n.children,g=void 0===v?[]:v,y=n.verticalSpans,w=void 0===y?[]:y,m=n.subtotalSpan,b=n.isTotal,S=void 0!==b&&b;if(g.length>0&&e(g,a),w.length>0&&w.forEach((function(e,n){var o=a;e.forEach((function(e){if(e.hasOwnProperty("style")){var a=e.col,u=e.style;r[o]||(r[o]={}),r[o][a]||(r[o][a]={}),r[o][a].style=ze({},u)}t.push({row:o,col:e.col+i,rowCount:e.rowCount,colCount:e.colCount}),e.subtotalSpan.colCount>1&&t.push({row:o+e.rowCount-1,col:e.subtotalSpan.col+i,rowCount:e.subtotalSpan.rowCount,colCount:e.subtotalSpan.colCount}),o+=e.rowCount+n}))})),n.hasOwnProperty("style")){var C=n.col,O=n.style;r[a]||(r[a]={}),r[a][C]||(r[a][C]={}),r[a][C].style=ze({},O)}n.hasOwnProperty("row")&&((h>1||d>1)&&(S?t.push({row:l+o,col:c+i,rowCount:h,colCount:d}):t.push({row:a,col:c+i,rowCount:h,colCount:d})),m&&t.push({row:a+h-1,col:m.col+i,rowCount:m.rowCount,colCount:m.colCount}),a+=h)}))}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),{spans:t,dataTableStyle:r}}(b,v+1,g);f.push.apply(f,z(S.spans))}}if(a.length>0||s>0){var C=e.BSt.map((function(e){return{id:e.id(),code:e.dataField(),name:e.name()}})),O=e.range(),E=function(e){var t=e.rowMergeColumns,r=e.colMergeColumns,n=e.tableColumns,o=e.row,i=void 0===o?0:o;e.col;var a=e.rowCount,u=void 0===a?0:a,l=[];if(t.length||r.length){var s=t.map((function(e){return ze(ze({},e),{},{rowMerge:!0,colMerge:!1})}));r.forEach((function(e){var t=s.find((function(t){return t.code===(null==e?void 0:e.code)}));t?t.colMerge=!0:s.push(ze(ze({},e),{},{rowMerge:!1,colMerge:!0}))})),s.sort((function(e,t){return n.findIndex((function(t){return t.code===e.code}))-n.findIndex((function(e){return e.code===t.code}))}));var c=s[0],f=c.rowMerge,h=c.colMerge,p=Ue.AutoMerge.AutoMergeDirection.column,d=Ue.AutoMerge.AutoMergeMode.free,v=Ue.SheetArea.viewport,g=Ue.AutoMerge.SelectionMode.merged;f&&h?p=Ue.AutoMerge.AutoMergeDirection.rowColumn:f&&(p=Ue.AutoMerge.AutoMergeDirection.row);var y={row:i,col:-1,rowCount:u,colCount:1},w=-1;s.forEach((function(e){var t=e.code,r=e.rowMerge,o=e.colMerge,i=n.findIndex((function(e){return e.code===t}));-1===y.col?y.col=i:w+1===i&&f===r?y.colCount+=1:(l.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g}),f=r,y={row:1,col:i,rowCount:u+1,colCount:1},p=Ue.AutoMerge.AutoMergeDirection.column,r&&o?p=Ue.AutoMerge.AutoMergeDirection.rowColumn:r&&(p=Ue.AutoMerge.AutoMergeDirection.row)),w=i})),(l.length>0&&l[l.length-1]!==y&&y.col>-1||l.length<=0&&y.col>-1)&&l.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g})}return l}({rowMergeColumns:a,colMergeColumns:s,tableColumns:C,row:O.row+1,rowCount:O.rowCount});h.push.apply(h,z(E))}}));var d=e.toJSON();d.spans=Array.isArray(d.spans)?d.spans:[],(t=d.spans).push.apply(t,f),d.autoMergeRangeInfos=h,e.fromJSON(d),p&&e.setDataSource(p),function(e){var t=e.sheet,r=e.rowMerge,n=e.columnMerge,o=t.tables.all();if(o.length>0&&(r||n)){var i=Qe.AutoMerge.AutoMergeDirection.column,a=Qe.AutoMerge.AutoMergeMode.free,u=Qe.SheetArea.viewport,l=Qe.AutoMerge.SelectionMode.merged;r&&n?i=Qe.AutoMerge.AutoMergeDirection.rowColumn:r&&(i=Qe.AutoMerge.AutoMergeDirection.row),t.suspendPaint(),o.forEach((function(e){var r=e.range();t.autoMerge(r,i,a,u,l)})),t.resumePaint()}}({sheet:e,rowMerge:i,columnMerge:a})}))};function Ke(t){var i=t.newTabVisible,u=void 0===i||i,l=t.tabEditable,s=void 0===l||l,c=t.tabStripVisible,f=void 0===c||c,h=t.onInited,p=t.onEnterCell,d=t.onActiveSheetChanged,v=t.onValueChanged,g=t.onSelectionChanged,y=t.onSelectionChanging,w=t.onEditorStatusChanged,m=t.onSheetNameChanged,b=t.onSheetNameChanging,S=t.onActiveSheetChanging;t.onFetchData;var C=t.onRowChanged,O=t.onUndo,E=t.onRedo,A=t.license,k=t.enablePrint,x=void 0!==k&&k,I=t.json,R=void 0===I?null:I,M=t.onPrintHandler,T=t.children,P=t.baseUrl,N=t.dataSource,V=void 0===N?null:N,L=t.sumColumns,W=void 0===L?[]:L,H=t.groupColumns,B=void 0===H?[]:H,z=t.rowMerge,J=void 0!==z&&z,G=t.columnMerge,Q=void 0!==G&&G,Y=t.rowMergeColumns,X=void 0===Y?{}:Y,q=t.colMergeColumns,_=void 0===q?{}:q,$=t.template;A&&function(e){We=e}(A),P&&(r=P);var ee=n(),te=We||"593811994558535#B1dWhJlMLFTUwpXTsV6L03kcLpmNkR5VklDTz9mdnh4SmJ6c98WU9QEVrNDO5kTNOpUb9B7d9l5NjlWWsxmU9hHNmVTb9p5dU5UZmRkZXJlR4d5MENkVat4RKNWZMVlcuNmbph6SxYTUyoVcFBFeIlTe5QFSYhjShpneohmVoZTVhdFdBJGOuFDMsVDW8RjZrB5aQlFbSZVS48UNr5mY62EZ4UWYTFGbxpWZVBVMo3iaCZVNrcmYxlDZzIkWmNVc5FVRCl5KFFDMvMmSjRUUKpkTRRTdV3GOHZVY5llY9IUez2kTalFShN6cjFEOXZEeuVHcWxmWZtWViojITJCLiEkMygjR5UjI0ICSiwCO7YTMxYjM6ATM0IicfJye#4Xfd5nIVF4SRJiOiMkIsIyNx8idgMlSgQWYlJHcTJiOi8kI1tlOiQmcQJCLigDNyADOwAiNxQDM4IDMyIiOiQncDJCLiEjLw8CMucjMxIiOiMXbEJCLig1jlzahlDZmpnInmz9unHZvnfLsonLvlb1kpfbtmD0jnLiOiEmTDJCLiUzM5gTN5QTO9ETM8MTO5IiOiQWSiwSfdtlOicGbmJCLlNHbhZmOiI7ckJye0ICbuFkI1pjIEJCLi4TP7pXe62iNw34KDl5RVpHO8dVW7UESQN7Zl3ycj36V4NzbGJENV5kTtJDdEVjQjFnbutyRVhleuV6ZFVkRZxUdQZmdJlFZHpXWmhWYTZGSIF6LUJjdhZTMjNVVltbcYR";te&&(ee.Spread.Sheets.LicenseKey=te);var re=U(e.useState((function(){var e=He(),t=!1,r=!1;return e.success||(t=e.showError,r=e.showWarn),{spread:null,showError:t,showWarn:r}})),1)[0],ne=e.useRef(null),oe=e.useMemo((function(){var e=JSON.parse(JSON.stringify(R));return e&&V&&new Le(e,V,$),{json:e}}),[R,V,JSON.stringify($)]).json,ie=function(){var e=j(D.mark((function e(){var t,r,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x){e.next=4;break}return t=a("print"),e.next=4,F.loadScript(t);case 4:if(re.spread||!ne.current||ne.showError){e.next=12;break}return r=n(),o=new r.Spread.Sheets.Workbook(ne.current,{sheetCount:0,newTabVisible:u,tabEditable:s,tabStripVisible:f}),re.spread=o,o.suspendEvent(),K(o),o.resumeEvent(),e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){if(re.spread){var e=re.spread;e.unbindAll(),function(e,t){if(e&&t)for(var r=0,n=Object.entries(t);r<n.length;r++){var o=U(n[r],2),i=o[0],a=o[1];Ye(e,i,a)}}(e,{EnterCell:p,ActiveSheetChanged:d,ValueChanged:v,ActiveSheetChanging:S,SheetNameChanged:m,SheetNameChanging:b,SelectionChanged:g,SelectionChanging:y,EditorStatusChanged:w,WorkbookUndo:O,WorkbookRedo:E,RowChanged:C})}},ue=function(e){if(re.spread){var t=re.spread;o(t,e?function(){t.fromJSON(e);var r=t.sheets;r&&r.length>0&&r.forEach((function(e){e.options.sheetAreaOffset={left:1,top:1},e.recalcAll(!0)}))}:function(){var e;e=T?Array.isArray(T)?T:[T]:[],t.clearSheets();var r=n();e.forEach((function(e,n){var o=e.props,i=o.name,a=void 0===i?`Sheet${n+1}`:i,u=o.rowCount,l=void 0===u?20:u,s=o.colCount,c=void 0===s?20:s,f=new r.Spread.Sheets.Worksheet(a);f.options.sheetAreaOffset={left:1,top:1},f.setRowCount(l),f.setColumnCount(c),t.addSheet(n,f)}))})}},le=function(){if(re.spread){var e=re.spread;V&&Xe({spread:e,dataSource:V,sumColumns:W,groupColumns:B,rowMerge:J,columnMerge:Q,rowMergeColumns:X,colMergeColumns:_})}},se=function(){if(re.spread){var e=re.spread;M&&M((function(t){return new Promise((function(r,o){e?x?(e.sheets.forEach((function(e){!function(e,t){var r=t.orientation,o=t.printQuality,i=t.scaleType,a=t.fitPagesTall,u=t.fitPagesWide,l=t.zoomFactor,s=t.firstPageNumber,c=t.paperKind,f=t.margin,h=t.headerAndFooter,p=t.showGridLine,d=t.showHeader,v=t.blackAndWhite,g=t.pageOrder,y=t.showBorder,w=e.printInfo(),m=function(e,t){Ge(e)||("string"==typeof t?w[t](e):t(e))};m(r,"orientation"),m(o,"qualityFactor"),Ge(i)||(1==i?(a=-1,u=-1,l/=100):0==i&&(l=1),w.zoomFactor(l),w.fitPagesWide(u),w.fitPagesTall(a)),m(s,"firstPageNumber"),m(c,(function(){var e=new(n().Spread.Sheets.Print.PaperSize)(parseInt(c));w.paperSize(e)})),m(f,(function(){var e=f.left,t=f.right,r=f.top,o=f.bottom,i=f.header,a=f.footer,u=f.centering;w.margin({left:100*e,right:100*t,top:100*r,bottom:100*o,header:100*i,footer:100*a});var l=null,s=n();l=null!=u&&u.horizontally?null!=u&&u.vertically?s.Spread.Sheets.Print.PrintCentering.both:s.Spread.Sheets.Print.PrintCentering.horizontal:null!=u&&u.vertically?s.Spread.Sheets.Print.PrintCentering.vertical:s.Spread.Sheets.Print.PrintCentering.none,w.centering(l)})),m(null==h?void 0:h.pageHeaderFooter,"pageHeaderFooter"),m(p,"showGridLine"),m(d,(function(){var e=n(),t=d?e.Spread.Sheets.Print.PrintVisibilityType.show:e.Spread.Sheets.Print.PrintVisibilityType.hide;w.showRowHeader(t),w.showColumnHeader(t)})),m(v,"blackAndWhite"),m(g,"pageOrder"),m(y,"showBorder");var b=w.rowStart();b=-1==b?0:b,w.rowStart(b);var S=w.rowEnd();S=-1==S?e.getRowCount():S,w.rowEnd(S);var C=w.columnStart();C=-1==C?0:C,w.columnStart(C);var O=w.columnEnd();O=-1==O?e.getColumnCount():O,w.columnEnd(O),e.printInfo(w)}(e,t||{})})),e.print(),r()):o(Error("打印失败，原因：初始化报表时未开启打印功能")):o(Error("打印失败，原因：报表未初始化"))}))}))}};return e.useEffect((function(){j(D.mark((function e(){var t,r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:t=e.sent,ae(),t&&(ue(oe),le(),se(),h&&(r=h(re.spread))&&r.then&&r.then((function(e){ue(e)})));case 5:case"end":return e.stop()}}),e)})))()}),[oe,V,p,d,v,S,m,b,g,y,w,O,E]),Z.jsxs(Ze,{children:[re.showError?Z.jsx(ce,{}):Z.jsx("div",{style:{width:"100%",height:"100%",overflow:"visible",userSelect:"none"},ref:ne}),!re.showError&&re.showWarn?Z.jsx(he,{}):null]})}var qe=["onInited","ready","dataSource"];function _e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var et=function(){function r(e){p(this,r),A(this,"conf",{}),A(this,"spread",null),A(this,"printHandler",null),this.conf=e}return y(r,[{key:"replacer",value:function(e,t){if("cornerFold"!==e||"table"!==(null==t?void 0:t.markType))return t}},{key:"mount",value:function(r){var i,a,u,l,s,c=this;n().Spread.Common.CultureManager.culture("zh-cn");var f=this.conf||{},h=f.onInited,p=f.ready,d=f.dataSource,v=E(f,qe),g=null===(i=this.conf)||void 0===i||null===(i=i.json)||void 0===i?void 0:i.reportJson;g&&(g=JSON.parse(JSON.stringify(g,this.replacer)));var y=(null===(a=this.conf)||void 0===a||null===(a=a.json)||void 0===a||null===(a=a.context)||void 0===a?void 0:a.tableDesignSlice)||{},w=y.rowMerge,m=y.columnMerge,b=((null===(u=this.conf)||void 0===u?void 0:u.event)||{}).onFetchData,S=(null===(l=this.conf)||void 0===l||null===(l=l.json)||void 0===l||null===(l=l.context)||void 0===l?void 0:l.datasourceSlice)||{},C=S.sumColumns,A=S.tableGroups,k=S.rowMergeColumns,j=void 0===k?{}:k,x=S.colMergeColumns,I=void 0===x?{}:x;t.createRoot(r).render(e.createElement(Ke,$e($e({onInited:function(e){c.spread=e,h&&h(e),"function"==typeof p&&o(e,(function(){p(new O(e))}))},onPrintHandler:function(e){c.printHandler=e},baseUrl:null===(s=this.conf)||void 0===s?void 0:s.baseUrl,onFetchData:b,rowMerge:w,columnMerge:m,sumColumns:C,groupColumns:A,rowMergeColumns:j,colMergeColumns:I,dataSource:d},v),{},{json:g})))}},{key:"exportExcel",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreFormula:!1,ignoreStyle:!1};return new Promise((function(o,i){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".xlsx")?e:e+".xlsx",F.loadScript(a("excel")).then((function(){var a=new(n().Spread.Excel.IO),u=JSON.stringify(t.spread.toJSON());a.save(u,(function(t){W(t,e),o()}),(function(e){i(e)}),{columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeBindingSource:!1,includeCalcModelCache:!1,includeEmptyRegionCells:!0,includeFormulas:!r.ignoreFormula,includeStyles:!r.ignoreStyle,includeUnusedNames:!0,password:void 0,rowHeadersAsFrozenColumns:!1,saveAsView:!1})}))):i(Error("导出excel失败，原因:没有传递导出文件名"))}))}},{key:"exportPdf",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{author:"",creator:"",keywords:"",subject:"",title:"",sheetIndex:null};return new Promise((function(n,o){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".pdf")?e:e+".pdf",F.loadScript(a("pdf")).then((function(){t.spread.savePDF((function(t){W(t,e),n()}),(function(e){o(e)}),{author:r.auther,creator:r.application,keywords:r.keyword,subject:r.subject,title:r.title},null==r.sheetIndex?void 0:r.sheetIndex)}))):o(Error("导出pdf失败，原因:没有传递导出文件名"))}))}},{key:"print",value:function(e){var t=this;return new Promise((function(r,n){t.printHandler?t.printHandler(e).then(r).catch(n):n(Error("打印失败，原因：报表未初始化"))}))}}]),r}();return{FontStyle:{normal:"normal",italic:"italic"},FontWeight:{normal:"normal",bold:"bold"},HAlign:f,LineBorder:w,LineStyle:c,Preview:et,VAlign:h,WorkBook:O,WorkSheet:C}}));
