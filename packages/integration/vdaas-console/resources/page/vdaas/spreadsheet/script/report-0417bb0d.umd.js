!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom/client")):"function"==typeof define&&define.amd?define(["react","react-dom/client"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).TOONE=e.TOONE||{},e.TOONE.Report=t(e.React,e.ReactDOM))}(this,(function(e,t){"use strict";var n=".",r=function(){return window.GC},o=function(e,t){if(e){e.suspendPaint(),e.suspendCalcService();var n=e.getActiveSheet();try{t(n)}finally{e.resumeCalcService(!1),e.resumePaint()}}},i={print:["print.min.js"],pdf:["print.min.js","pdf.min.js"],excel:["excelio.min.js"]},a=function(e){return i[e].map((function(e){return s(e)}))};var u=function(){var e=r().Spread.Sheets.productInfo.productVersion;return`${n}/vendor/excel/${e}`},s=function(e){return`${u()}/plugins/${e}`},l=r(),c={dashed:l.Spread.Sheets.LineStyle.dashed,dotted:l.Spread.Sheets.LineStyle.dotted,double:l.Spread.Sheets.LineStyle.double,empty:l.Spread.Sheets.LineStyle.empty,thick:l.Spread.Sheets.LineStyle.thick,thin:l.Spread.Sheets.LineStyle.thin},f={center:l.Spread.Sheets.HorizontalAlign.center,left:l.Spread.Sheets.HorizontalAlign.left,right:l.Spread.Sheets.HorizontalAlign.right},h={center:l.Spread.Sheets.VerticalAlign.center,bottom:l.Spread.Sheets.VerticalAlign.bottom,top:l.Spread.Sheets.VerticalAlign.top};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function y(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var m=function(){function e(t,n){p(this,e),this.color=t,this.style=n}return y(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStyle",value:function(e){this.style=e}},{key:"getStyle",value:function(){return this.style}},{key:"_to",value:function(){return new(r().Spread.Sheets.LineBorder)(this.color,this.style)}}]),e}();document.createElement("span");var w=function(e,t){return null==e?t:e},b=function(e,t,n){var o=r(),i=n.fontWeight,a=n.fontStyle,u=n.fontFamily,s=n.fontSize,l=n.textDecoration,c=n.backColor,f=n.foreColor,h=n.wordWrap;!function(e,t,n){for(var r=e.col,o=e.row,i=e.rowCount,a=e.colCount,u=0;u<i;u++)for(var s=0;s<a;s++)n(t,o+u,r+s)}(t,e,(function(e,t,n){var r=new o.Spread.Sheets.Style,p=e.getStyle(t,n),d=function(e){var t="normal",n="normal",r="normal",o="Calibri";if(e)for(var i,a=e.split(/\s+/);i=a.shift();)switch(i){case"normal":break;case"italic":case"oblique":t=i;break;case"small-caps":n=i;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":r=i;break;default:o=i,a.length&&(o+=" "+a.join(" "))}return{fontStyle:t,fontVariant:n,fontWeight:r,fontSize:11,lineHeight:"normal",fontFamily:o}}(p.font);Object.assign(r,p),u=w(u,d.fontFamily),s=w(s,d.fontSize),a=w(a,d.fontStyle),i=w(i,d.fontWeight),l=w(l,p.textDecoration),c=w(c,p.backColor),f=w(f,p.foreColor);var v=function(e){return e&&-1===e.indexOf("'")&&-1===e.indexOf('"')?`"${e}"`:e}(u),g=function(e){var t=e.fontFamily,n=void 0===t?"":t,r=e.fontStyle,o=void 0===r?"":r,i=e.fontVariant,a=void 0===i?"":i,u=e.fontWeight,s=void 0===u?"":u,l=e.fontSize,c=void 0===l?"":l,f=e.lineHeight,h=[o,a,s,c,void 0===f?"":f,n].join(" "),p=document.createElement("span");return p.style.font=h,p.style.font}({fontFamily:v,fontSize:s?`${s}pt`:"",fontStyle:a,fontWeight:i});r.font=g,r.textDecoration=l,r.backColor=c,r.foreColor=f,r.wordWrap=h,e.setStyle(t,n,r)}))},S=function(){function e(t,n){p(this,e),this.sheet=t,this.cellRange=n}return y(e,[{key:"hAlign",value:function(e){this.cellRange.hAlign(e)}},{key:"vAlign",value:function(e){this.cellRange.vAlign(e)}},{key:"setBorder",value:function(e,t){this.cellRange.setBorder(e,t)}},{key:"fontFamily",value:function(e){b(this.sheet,this.cellRange,{fontFamily:e})}},{key:"fontSize",value:function(e){b(this.sheet,this.cellRange,{fontSize:e})}},{key:"fontStyle",value:function(e){b(this.sheet,this.cellRange,{fontStyle:e})}},{key:"fontWeight",value:function(e){b(this.sheet,this.cellRange,{fontWeight:e})}},{key:"wordWrap",value:function(e){b(this.sheet,this.cellRange,{wordWrap:e})}}]),e}(),C=function(){function e(t){p(this,e),this.sheet=t}return y(e,[{key:"name",value:function(e){this.sheet.name(e)}},{key:"getCell",value:function(e,t){var n=this.sheet.getCell(e,t);return new S(this.sheet,n)}},{key:"getRange",value:function(e,t,n,r){var o=this.sheet.getRange(e,t,n,r);return new S(this.sheet,o)}},{key:"addSpan",value:function(e,t,n,r){this.sheet.addSpan(e,t,n,r)}},{key:"addRows",value:function(e,t){this.sheet.addRows(e,t)}},{key:"addColumns",value:function(e,t){this.sheet.addColumns(e,t)}},{key:"setValue",value:function(e,t,n){this.sheet.setValue(e,t,n)}},{key:"setFormula",value:function(e,t,n){this.sheet.setFormula(e,t,n)}},{key:"setRowCount",value:function(e){this.sheet.setRowCount(e)}},{key:"setRowHeight",value:function(e,t){this.sheet.setRowHeight(e,t)}},{key:"setColumnCount",value:function(e){this.sheet.setColumnCount(e)}},{key:"setColumnWidth",value:function(e,t){this.sheet.setColumnWidth(e,t)}},{key:"setDefaults",value:function(e){Object.assign(this.sheet.defaults,e)}},{key:"setOptions",value:function(e){var t=e.colHeaderVisible,n=void 0===t||t,r=e.rowHeaderVisible,o=void 0===r||r,i=e.showHorizontalGridline,a=void 0===i||i,u=e.showVerticalGridline,s=void 0===u||u,l=e.isProtected,c=void 0!==l&&l;Object.assign(this.sheet.options,{colHeaderVisible:n,rowHeaderVisible:o,isProtected:c}),Object.assign(this.sheet.options.gridline,{showHorizontalGridline:a,showVerticalGridline:s})}}]),e}(),O=function(){function e(t){p(this,e),this.spread=t}return y(e,[{key:"addSheet",value:function(e){this.spread.addSheet(e)}},{key:"getSheet",value:function(e){var t=this.spread.getSheet(e);return t?new C(t):null}},{key:"setOptions",value:function(e){var t=e.newTabVisible,n=void 0===t||t,r=e.tabStripVisible,o=void 0===r||r,i=e.showHorizontalScrollbar,a=void 0===i||i,u=e.showVerticalScrollbar,s=void 0===u||u;Object.assign(this.spread.options,{newTabVisible:n,tabStripVisible:o,showHorizontalScrollbar:a,showVerticalScrollbar:s})}}]),e}();function E(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function A(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(l){return void n(l)}u.done?t(s):Promise.resolve(s).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){k(i,r,o,a,u,"next",e)}function u(e){k(i,r,o,a,u,"throw",e)}a(void 0)}))}}function M(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P={exports:{}},T={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(T);var j=T.exports;!function(e){var t=j.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=n=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var r,o={},i=Object.prototype,a=i.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(N){h=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),a=new R(r||[]);return u(i,"_invoke",{value:P(e,n,a)}),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}o.wrap=p;var v="suspendedStart",g="suspendedYield",y="executing",m="completed",w={};function b(){}function S(){}function C(){}var O={};h(O,l,(function(){return this}));var E=Object.getPrototypeOf,A=E&&E(E(D([])));A&&A!==i&&a.call(A,l)&&(O=A);var k=C.prototype=b.prototype=Object.create(O);function x(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,n){function r(o,i,u,s){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==t(f)&&a.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,u,s)}),(function(e){r("throw",e,u,s)})):n.resolve(f).then((function(e){c.value=e,u(c)}),(function(e){return r("throw",e,u,s)}))}s(l.arg)}var o;u(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(i,i):i()}})}function P(e,t,n){var o=v;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:r,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=T(u,n);if(s){if(s===w)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===v)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var l=d(e,t,n);if("normal"===l.type){if(o=n.done?m:g,l.arg===w)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function T(e,t){var n=t.method,o=e.iterator[n];if(o===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=r,T(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var i=d(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,w;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,w):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(a.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=r,t.done=!0,t};return i.next=i}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=C,u(k,"constructor",{value:C,configurable:!0}),u(C,"constructor",{value:S,configurable:!0}),S.displayName=h(C,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,h(e,f,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},x(M.prototype),h(M.prototype,c,(function(){return this})),o.AsyncIterator=M,o.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var a=new M(p(e,t,n,r),i);return o.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),h(k,f,"Generator"),h(k,l,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},o.values=D,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,o){return u.type="throw",u.arg=e,t.next=n,o&&(t.method="next",t.arg=r),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],u=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),w}},o}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(P);var I=(0,P.exports)(),R=I;try{regeneratorRuntime=I}catch(xt){"object"==typeof globalThis?globalThis.regeneratorRuntime=I:Function("r","regeneratorRuntime = r")(I)}const D=M(R);var N=function(e){return e?"string"==typeof e&&(e=[e]):e=[],e},V=function(){function e(){p(this,e),this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptMaps={},this._dataPromises={}}var t,n,r,o,i,a,u,s;return y(e,[{key:"loadScript",value:(s=x(D.mark((function e(t){var n,r,o,i=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],(t=N(t)).forEach((function(e){(r=i._scriptMaps[e]=i._scriptMaps[e]||{}).promise||(r.path=e,r.promise=new Promise((function(t){(n=i.createScriptElement()).setAttribute("type","text/javascript"),n.src=e,n.addEventListener("load",t),i._head.appendChild(n)}))),o.push(r.promise)})),e.abrupt("return",Promise.all(o));case 4:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"unloadScript",value:(u=x(D.mark((function e(t){var n,r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(n=r._head.querySelectorAll('script[src="'+e+'"]')[0])&&(r._head.removeChild(n),delete r._scriptMaps[e])})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"createScriptElement",value:function(){return document.createElement("script")}},{key:"fetchData",value:(a=x(D.mark((function e(t){var n,r,o=arguments;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:{},r=t+JSON.stringify(n),n.cache=void 0===n.cache||n.cache,t){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this._dataPromises[r]&&n.cache){e.next=16;break}return e.prev=6,e.next=9,fetch(t,n);case 9:this._dataPromises[r]=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),this._dataPromises[r]=null,e.t0;case 16:return e.abrupt("return",this._dataPromises[r]);case 17:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return a.apply(this,arguments)})},{key:"loadCss",value:(i=x(D.mark((function e(t){var n=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){if(!n._cssPaths[e]){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),n._head.appendChild(t),n._cssPaths[e]=t}})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"unloadCss",value:(o=x(D.mark((function e(t){var n,r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(n=r._cssPaths[e])&&(r._head.removeChild(n),r._cssPaths[e]=null)})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadTemplate",value:(r=x(D.mark((function e(t,n){var r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.fetchTemplate(t);case 4:if(r=e.sent,!n){e.next=8;break}return n.innerHTML=r,e.abrupt("return",n);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"fetchTemplate",value:(n=x(D.mark((function e(t){var n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"flush",value:(t=x(D.mark((function e(){var t,n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadCss(Object.getOwnPropertyNames(this._cssPaths));case 2:this._cssPaths={},e.t0=D.keys(this._scriptMaps);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(t=e.t1.value,!this._scriptMaps.hasOwnProperty(t)){e.next=10;break}return n=this._scriptMaps[t],e.next=10,this.unloadScript(n.path);case 10:e.next=4;break;case 12:this._scriptMaps={},this._dataPromises={};case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),F=new V;function L(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");e.dispatchEvent(t)}}function H(e,t){var n=window.URL||window.webkitURL,r=document.createElement("a");r.download=t,r.rel="noopener","string"==typeof e?(r.href=e,r.origin==window.location.origin?L(r):function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return 200<=t.status&&t.status<=299}(r.href)||(r.target="_blank",L(r))):(r.href=n.createObjectURL(e),setTimeout((function(){n.revokeObjectURL(r.href)}),4e4),setTimeout((function(){L(r)}),0))}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function W(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}function U(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||W(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],s=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(c){l=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,t)||W(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J,Q={exports:{}},z={};Q.exports=function(){if(J)return z;J=1;var t=e,n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,r){var u,s={},l=null,c=null;for(u in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,u)&&!a.hasOwnProperty(u)&&(s[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps)void 0===s[u]&&(s[u]=t[u]);return{$$typeof:n,type:e,key:l,ref:c,props:s,_owner:i.current}}return z.Fragment=r,z.jsx=u,z.jsxs=u,z}();var Z=Q.exports,Y=r();function _(){this.name="TOONE.GET",this.maxArgs=2,this.minArgs=1}_.prototype=new Y.Spread.CalcEngine.Functions.Function,_.prototype.evaluate=function(e){return""};var X=r();function K(){this.name="TOONE.PAGECOUNT",this.maxArgs=0,this.minArgs=0}K.prototype=new X.Spread.CalcEngine.Functions.Function,K.prototype.description=function(){return{description:"获取总页数",parameters:[]}},K.prototype.evaluate=function(e){return""};var q=r();function $(){this.name="TOONE.PAGEINDEX",this.maxArgs=0,this.minArgs=0}$.prototype=new q.Spread.CalcEngine.Functions.Function,$.prototype.description=function(){return{description:"获取当前页",parameters:[]}},$.prototype.evaluate=function(e){return""};var ee=function(e){!function(e){var t=new _;e.addCustomFunction(t);var n=new K;e.addCustomFunction(n);var r=new $;e.addCustomFunction(r)}(e)};const te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABkCAYAAACWy14QAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlBNDFDQzUzRkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlBNDFDQzU0RkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUE0MUNDNTFGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUE0MUNDNTJGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52RmQBAAAR1klEQVR42uxd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";var ne=["children"],re=["children"],oe=["children"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue,se=function(e){return function(t){var n=t.children,r=E(t,ne);return Z.jsx("div",ae(ae({style:e},r),{},{children:n}))}},le=function(e){return function(t){var n=t.children,r=E(t,re);return Z.jsx("span",ae(ae({style:e},r),{},{children:n}))}},ce=se({color:"#6a6a6a",textAlign:"center",verticalAlign:"middle",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"440px",whiteSpace:"nowrap"}),fe=(ue={display:"inline-block",width:"100px",height:"105px",verticalAlign:"middle"},function(e){var t=e.children,n=E(e,oe);return Z.jsx("img",ae(ae({style:ue},n),{},{children:t}))}),he=le({display:"inline-block",paddingLeft:"10px",textAlign:"left",verticalAlign:"middle",fontSize:"14px"}),pe=le({display:"inline-block",fontSize:"20px",fontWeight:"600",opacity:"0.8"});function de(){return Z.jsxs(ce,{children:[Z.jsx(fe,{src:te}),Z.jsxs(he,{children:[Z.jsx(pe,{children:"未找到有效许可证！"}),Z.jsx("br",{}),"获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询。"]})]})}var ve=se({position:"absolute",bottom:"50px",right:"50px",color:"#6a6a6a",zIndex:"999",textAlign:"right",fontSize:"14px",pointerEvents:"none"});function ge(){return Z.jsxs(ve,{children:["获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询"]})}var ye=function(e){return null==e},me=function(e){return"string"==typeof e&&e.trim().length>0};function we(e,t){return(we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function be(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&we(e,t)}function Se(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e){return r().Spread.CalcEngine.ExpressionType[e]}function Ee(e){return{lMt:!0,originalValue:e+"",type:Oe("number"),value:e}}function Ae(e){switch(typeof e){case"number":return Ee(e);case"boolean":return function(e){return{lMt:!0,type:Oe("boolean"),value:e}}(e);default:return function(e){return{lMt:!0,type:Oe("string"),value:e}}(e)}}var ke=function(e){return r().Spread.Sheets.CalcEngine.formulaToExpression(null,e,0,0)};var xe=function(e,t){switch(e.functionName){case"TOONE.GET":return function(e,t){var n,r,o,i=e.arguments;if(!i||0==i.length)throw Error("TOONE.GET函数未传递参数，请检查配置！");r=i[0].value,o=null===(n=i[1])||void 0===n?void 0:n.value;var a=t.getValue(r,o);return"text"==a.type?Ae(a.value):ke(a.value)}(e,t);case"TOONE.PAGECOUNT":return function(e,t){return Ee(t.getPageCount())}(0,t);case"TOONE.PAGEINDEX":return function(e,t){return Ee(t.getPageIndex())}(0,t)}return null},Me=function(){function e(t){p(this,e),this.ast=t}return y(e,[{key:"getAST",value:function(){return this.ast}},{key:"parse",value:function(e){return this.ast}},{key:"toParser",value:function(e){return e&&"number"==typeof e.type?Ne(e):null}},{key:"parseValue",value:function(e,t){var n=this.toParser(e);return n?n.parse(t):e}},{key:"_getVisitChildren",value:function(){return[]}},{key:"_getVisitHandlerName",value:function(){return null}},{key:"visit",value:function(e){var t=this,n=this._getVisitHandlerName(),r=e[n],o=!0;("function"==typeof r&&(o=!1!==r.call(e,this)),o)&&this._getVisitChildren().forEach((function(n){var r=t.toParser(n);r&&r.visit(e)}))}}]),e}();function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}var Te=function(e){be(n,e);var t=Pe(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this,n=this.getAST(),r=xe(n,e);if(null!==r)return r;var o=n.arguments;if(Array.isArray(o)){var i=o.map((function(n){return t.parseValue(n,e)}));n.arguments=i}return n}},{key:"_getVisitHandlerName",value:function(){return"visitFunction"}},{key:"_getVisitChildren",value:function(){var e=this.getAST().arguments;return Array.isArray(e)?e:[]}}]),n}(Me);function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}var Ie=function(e){be(n,e);var t=je(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t.value2=this.parseValue(t.value2,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitOperator"}},{key:"_getVisitChildren",value:function(){var e=this.getAST();return[e.value,e.value2]}}]),n}(Me);function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}var De=function(e){be(n,e);var t=Re(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitParentheses"}},{key:"_getVisitChildren",value:function(){return[this.getAST().value]}}]),n}(Me),Ne=function(e){var t=e.type,n=r().Spread.CalcEngine.ExpressionType;switch(t){case n.operator:return new Ie(e);case n.function:return new Te(e);case n.parentheses:return new De(e);default:return new Me(e)}},Ve=function(){function e(t){p(this,e),this.handlers=t}return y(e,[{key:"_visit",value:function(e,t){var n=this.handlers[e];if(n)return n(t)}},{key:"visitFunction",value:function(e){return this._visit("function",e)}},{key:"visitOperator",value:function(e){return this._visit("operator",e)}},{key:"visitParentheses",value:function(e){return this._visit("parentheses",e)}}]),e}(),Fe=function(){function e(){p(this,e)}return y(e,[{key:"setFieldIndexHandler",value:function(e){this.fieldIndexHandler=e}},{key:"setDataCountHandler",value:function(e){this.dataCountHandler=e}},{key:"setPageHandler",value:function(e){this.pageHandler=e}},{key:"setTotalPagesHandler",value:function(e){this.totalPagesHandler=e}},{key:"setUnionDatasourceHandler",value:function(e){this.unionDatasourceHandler=e}},{key:"setDataIndex",value:function(e){this.dataIndexHandler=e}},{key:"setValueHandler",value:function(e){this.valueHandler=e}},{key:"getFieldIndex",value:function(e,t){return this.fieldIndexHandler(e,t)}},{key:"getDataIndex",value:function(e,t){return this.dataIndexHandler(e,t)}},{key:"getDataCount",value:function(e){return this.dataCountHandler(e)}},{key:"getUnionDatasource",value:function(){return this.unionDatasourceHandler()}},{key:"getPage",value:function(){return this.pageHandler()}},{key:"getTotalPages",value:function(){return this.totalPagesHandler()}},{key:"getPageIndex",value:function(){return this.pageHandler()}},{key:"getPageCount",value:function(){return this.totalPagesHandler()}},{key:"getValue",value:function(e,t){return this.valueHandler(e,t)}}]),e}(),Le=function(){function e(t){p(this,e),this.plugin=t}return y(e,[{key:"getConfig",value:function(){return this.plugin?this.plugin.config:null}},{key:"execute",value:function(e,t){return e}}]),e}();function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}var We=[["url",""],["mode",1],["height",0],["width",0],["clipX",0],["clipY",0],["clipHeight",0],["clipWidth",0],["vAlign",1],["hAlign",1]],Ue=function(e){var t=["IMAGE("];return We.forEach((function(n){var r,o=void 0;Array.isArray(n)?(r=n[0],o=n[1]):r=n;var i=e[r];i=i===o?void 0:i,t.push(function(e){return ye(e)?"":e}(i)),t.push(",")})),t.pop(),t.push(")"),t.join("")},Ge=function(e){be(n,e);var t=Be(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){var n=this.getConfig(),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:"formula"==e.type?e.value:`"${e.value}"`},n);return{type:"formula",value:Ue(r)}}}]),n}(Le);function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}var Qe=function(e){be(n,e);var t=Je(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){return{type:"text",value:t.getPage()}}}]),n}(Le);function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}var Ze=function(e){be(n,e);var t=ze(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){var n=this.getConfig(),o=n.functionNum,i=n.tableCode,a=n.fieldCode,u=t.getUnionDatasource(),s=u.isTreeSumField(i,a),l=t.getDataCount(i),c=t.getFieldIndex(i,a),f=c.row,h=c.col,p=r().Spread.Sheets,d=p.Range,v=p.CalcEngine,g=[];if(s){var y=t.getDataIndex(i,a);u.getLeafRanges(i,y,y+l).forEach((function(e){g.push(new d(f+(e-y),h,1,1))}))}else g.push(new d(f,h,l,1));var m=v.RangeReferenceRelative.allRelative;return{type:"formula",value:`SUBTOTAL(${o},${(0,v.rangesToFormula)(g,0,0,m,!1)})`}}}]),n}(Le);function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}var _e=function(e){be(n,e);var t=Ye(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){return{type:"text",value:t.getTotalPages()}}}]),n}(Le),Xe=function(e,t,n){return t.forEach((function(t){var r=function(e){var t=e.type;switch(t){case"cellImage":return new Ge(e);case"cellSubTotal":return new Ze(e);case"pageCellType":return new Qe(e);case"totalPagesCellType":return new _e(e);default:throw Error("未识别插件类型【"+t+"】，请检查！")}}(t);e=r.execute(e,n)})),e},Ke=function(e,t){return e&&"formula"==e.type?function(e,t){if(me(e)){var n=ke(e);return n=Ne(n).parse(t),{type:"formula",value:e=GC.Spread.Sheets.CalcEngine.expressionToFormula(null,n,0,0)}}return{type:"formula",value:e}}(e.value,t):e},qe=function(e){return e?function(e){var t=[];if(me(e)){var n=ke(e),r=Ne(n),o=new Ve({function:function(e){var n=e.getAST();if("TOONE.GET"==n.functionName){var r=n.arguments;return 2==r.length&&t.push(r[0].value),!1}}});r.visit(o)}return t}(e):[]},$e=null,et=function(e){if(0==e.length)return 0;var t=e.join("+"),n=function(){if(null==$e){var e=new(r().Spread.Sheets.Workbook);$e=e.getSheet(0)}return $e}();return GC.Spread.Sheets.CalcEngine.evaluateFormula(n,t)};function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var nt=function(){function e(t,n){p(this,e),A(this,"datas",[]),A(this,"references",[]),A(this,"treeStruct",{}),A(this,"treeDataIndexMap",{}),this.datasources=t,this.setting=n,this._anslysisSetting()}return y(e,[{key:"_containsTable",value:function(e){return-1!=this.datasources.indexOf(e)}},{key:"_analysisTreeStructSetting",value:function(){if(this.setting.treeStruct)for(var e=0,t=Object.entries(this.setting.treeStruct);e<t.length;e++){var n=G(t[e],2),r=n[0],o=n[1];this._containsTable(r)&&(this.treeStruct[r]=o)}}},{key:"_analysisReferenceSetting",value:function(){var e=this;this.setting.references&&this.setting.references.forEach((function(t){var n=t.foreignKey,r=t.references;e._containsTable(n.tableCode)&&e._containsTable(r.tableCode)&&e.references.push(t)}))}},{key:"_anslysisSetting",value:function(){this.setting&&(this._analysisTreeStructSetting(),this._analysisReferenceSetting())}},{key:"_toUniqueKey",value:function(e,t){return`${e},${t}`}},{key:"_isLeaf",value:function(e){return e.hasOwnProperty("isLeaf")?e.isLeaf:!e.children||0==e.children.length}},{key:"_treeStructDataEnhance",value:function(e){for(var t=this,n=function(){var n=G(o[r],2),i=n[0],a=n[1],u=e[i];if(u&&u.length>0){var s=a.sumFields,l=a.idField,c=a.pidField,f=a.leafField,h=a.sortField,p=a.sortType,d=t.treeDataIndexMap[i]||{};u.forEach((function(e){var t=e[l],n={data:e,children:[]};f&&(n.isLeaf=!!e[f]),d[t]=n})),t.treeDataIndexMap[i]=d;var v={data:null,children:[]};if(u.forEach((function(e){var t=e[l],n=e[c],r=d[n];r=r||v;var o=d[t];r.children.push(o)})),s&&s.length>0){var g=function e(n){if(!t._isLeaf(n)){var r=n.children||[];r.forEach((function(t){return e(t)}));var o=n.data;s.forEach((function(e){var t=[];r.forEach((function(n){var r=n.data[e];isNaN(r)||t.push(r)}));var n=et(t);o[e]=n}))}};v.children.forEach((function(e){return g(e)}))}if(h){!function e(t){var n=t.children;(n=n.sort((function(e,t){var n=e.data,r=t.data,o=n[h]-r[h];return"asc"==p?o:0-o}))).forEach((function(t){return e(t)})),t.children=n}(v)}e[i]=function e(t){var n=[];return t.forEach((function(t){n.push(t.data);var r=t.children;r&&r.length>0&&(n=n.concat(e(r)))})),n}(v.children)}},r=0,o=Object.entries(this.treeStruct);r<o.length;r++)n()}},{key:"_unitDataByReferences",value:function(e,t){var n=this,r=[];if(this.references){var o={};this.references.forEach((function(i){var a=i.references,u=i.foreignKey,s=a.tableCode,l=a.fieldCode;t.push(s);var c=n._toUniqueKey(s,l),f=o[c];f||(f={},o[c]=f,e[s].forEach((function(e){f[e[l]]=e})));var h=u.tableCode;t.push(h);var p=u.fieldCode;e[h].forEach((function(e){r.push(A(A({},h,e),s,f[e[p]]))}))}))}return r}},{key:"_unitDataByIndex",value:function(e,t,n){for(var r=0,o=Object.entries(e);r<o.length;r++){var i=G(o[r],2),a=i[0],u=i[1];if(-1==n.indexOf(a))for(var s=0,l=u.length;s<l;s++){var c=u[s],f=t[s]||{};f[a]=c,t[s]=f}}return t}},{key:"isTreeSumField",value:function(e,t){var n,r=this.treeStruct[e];return(null==r||null===(n=r.sumFields)||void 0===n?void 0:n.length)>0&&-1!=r.sumFields.indexOf(t)}},{key:"getLeafRanges",value:function(e,t,n){for(var r=this.treeDataIndexMap[e],o=[],i=this.setting.treeStruct[e].idField,a=t;a<=n;a++){var u=this.datas[a];if(u&&u[e]){var s=r[u[e][i]];this._isLeaf(s)&&o.push(a)}}return o}},{key:"load",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),n=[];this._treeStructDataEnhance(t);var r=this._unitDataByReferences(t,n);this.datas=this._unitDataByIndex(t,r,n)}},{key:"getCount",value:function(){return this.datas.length}},{key:"getValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.datas[n],o=null;if(r){var i,a=null===(i=r[e])||void 0===i?void 0:i[t];o=void 0===a?null:a}return{type:"text",value:o}}}]),e}();function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var it=r().Spread.Sheets;function at(e){var t=e.sheet,n=e.dataTable,r=e.rules,o=e.spans,i=e.rows,a=e.rowCount,u=e.autoMergeRanges;if(t){var s=a>0?a:t.rowCount;t.data.dataTable=Object.keys(n).length?n:t.data.dataTable,t.rowCount=s,t.conditionalFormats=t.conditionalFormats?t.conditionalFormats:{},t.conditionalFormats.rules=r,t.spans=o,function(e,t){if(e.rows)return Object.keys(e.rows).forEach((function(t){delete e.rows[t]})),void Object.entries(t).forEach((function(t){var n=G(t,2),r=n[0],o=n[1];e.rows[r]=o}));e.rows=t}(t,i),t.autoMergeRangeInfos=u}}function ut(e){var t=e.templates,n=e.isCalcTemp,r=void 0!==n&&n,o=0;return t.forEach((function(e){for(var t=e.datas,n=e.dataTables,i=st(t),a=r?1:i.getCount()||1,u=0;u<a;u++)n.forEach((function(e){var t=e.rows,n=void 0===t?{}:t;n.hasOwnProperty("size")?o+=null==n?void 0:n.size:o+=20}))})),{height:o}}function st(e,t){var n=Object.fromEntries(e),r=new nt(Object.keys(n),t);return r.load(n),r}function lt(e,t,n){var r=it.AutoMerge.AutoMergeDirection.column,o=it.AutoMerge.AutoMergeMode.free,i=it.SheetArea.viewport,a=it.AutoMerge.SelectionMode.merged;e.columnMerge&&e.rowMerge?r=it.AutoMerge.AutoMergeDirection.rowColumn:e.rowMerge&&(r=it.AutoMerge.AutoMergeDirection.row);var u={row:e.row-n,col:e.col,rowCount:null==e?void 0:e.rowCount,colCount:null==e?void 0:e.colCount};t.push({range:u,direction:r,mode:o,sheetArea:i,selectionMode:a})}function ct(e){return JSON.parse(JSON.stringify(e))}var ft=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;p(this,e),this.datas=n,this.reportJson=t,this.tempConfig=r,this.newSheets={},this.setting=o,this.templatesPageInfos={},this.delayPlugins=[],this.delayFormula=[],this.groupTemplate(),this.analysisTemplate(),Object.entries(this.newSheets).forEach((function(e){var n=G(e,2),r=n[0],o=n[1];t.sheets[r]=o,t.sheetCount+=1}));var i={};for(Object.values(t.sheets).forEach((function(e){i[e.name]=e})),t.sheets=i;this.delayPlugins.length;){this.delayPlugins.pop()()}for(;this.delayFormula.length;){this.delayFormula.pop()()}}return y(e,[{key:"render",value:function(e){var t=this.headerTemplates,n=this.footerTemplates,r=this.contentTemplates;if(e.pageArea){var o,i,a=ut({templates:t}).height,u=ut({templates:n}).height,s=ut({templates:r,isCalcTemp:!0}).height,l=a+u,c=e.pageTotalHeight;if(l>e.pageTotalHeight){var f=l%e.pageTotalHeight;f>=s&&(c=f)}else if(l<e.pageTotalHeight){var h=e.pageTotalHeight-l;h>=s&&(c=h)}for(var p=Math.floor(c/s),d=Math.ceil(((null==r||null===(o=r[0])||void 0===o?void 0:o.dataLen)||1)/p),v=((null==r||null===(i=r[0])||void 0===i?void 0:i.dataLen)||1)%p,g=0,y=0;g<d;){this.genPageDataTables({templates:t,pageInfos:e});var m=y+p;g+1>=d&&!e.isFillData&&(m=y+v),this.genPageDataTables({templates:r,pageInfos:e,startIndex:y,endIndex:m}),this.genPageDataTables({templates:n,pageInfos:e}),g+1<d&&this.onAfterPage(e),e.pageHeight=0,y+=p,g++}}else this.genPageDataTables({templates:t,pageInfos:e});at(e)}},{key:"splitTemplate",value:function(e,t){var n=e.rowCount,r=void 0===n?200:n,o=[],i=[],a=[],u=r,s=r;if(t&&/^\d+:\d+$/.test(t)){var l=t.split(":");u=Number(l[0])-1,s=Number(l[1])}var c=null,f=0;do{var h,p=this.parseRowDataTable({row:f,sheet:e});if(c&&f<c.endRow)c.height+=p.height,(h=c.dataTables).push.apply(h,U(p.dataTables)),p.endRow>c.endRow&&(c.endRow=p.endRow,c.rowCount=c.endRow-c.row),p.datas.forEach((function(e,t){e.length>c.dataLen&&(c.dataLen=e.length),c.datas.set(t,e)}));else c=p;f>=u&&f<s&&(c.endRow=s,c.rowCount=c.endRow-c.row),f+1===c.endRow&&(c.verticalAutoMergeRanges=[],c.dataTables.forEach((function(e){var t=e.mergeInfos,n=void 0===t?[]:t,r=n.length;if(r>0){for(var o=[],i=n[0],a=1;a<r;a++){var u=n[a];i.row===u.row&&i.rowCount===u.rowCount&&i.columnMerge===u.columnMerge&&i.rowMerge===u.rowMerge&&i.col+i.colCount===u.col?i.colCount+=u.colCount:(lt(i,o,c.row),i=u)}lt(i,o,c.row),e.autoMergeRanges=[],o.filter((function(t){t.range.rowCount===c.rowCount?c.verticalAutoMergeRanges.push(t):t.range.colCount>1&&e.autoMergeRanges.push(t)}))}})),c.row<u?o.push(c):c.row>=s?i.push(c):a.push(c),c=null),f++}while(f<r);this.headerTemplates=o,this.footerTemplates=i,this.contentTemplates=a}},{key:"setTemplateDatas",value:function(e,t,n){var r,o,i=(null===(r=this.datas)||void 0===r?void 0:r[t])||[],a=this.nameMaps[n],u=null===(o=this.groupsDatas)||void 0===o||null===(o=o[n])||void 0===o||null===(o=o[t])||void 0===o?void 0:o[a];Array.isArray(u)&&(i=u),e.datas.has(t)||(e.datas.set(t,ct(i)),i.length>e.dataLen&&(e.dataLen=i.length))}},{key:"parseRowDataTable",value:function(e){var t,n,r=this,o=e.row,i=e.sheet,a=i.name,u=i.spans,s=void 0===u?[]:u,l=i.data,c=void 0===l?{}:l,f=i.rows,h=void 0===f?{}:f,p=i.conditionalFormats,d=void 0===p?{}:p,v=(null==d?void 0:d.rules)||[],g=(null==c?void 0:c.dataTable)||{},y=(null==g?void 0:g[o])||{},m=function(e){var t=e.rules,n=e.row,r=t;return Number.isFinite(n)&&n>=0&&(r=t.filter((function(e){return e.ranges.some((function(e){var t=e.row,r=e.rowCount;return t<=n&&n<t+r}))}))||[]),r}({rules:v,row:o}),w={spans:[],mergeInfos:[],rules:[],rows:null,rowDataTable:y},b={row:o,endRow:o+1,rowCount:1,datas:new Map,dataTables:[w],dataLen:0,height:0},S=s.filter((function(e){return e.row===o}));(t=w.spans).push.apply(t,U(S)),w.rows=function(e,t){return(null==e?void 0:e[t])||{size:20}}(h,o),b.height=null==w||null===(n=w.rows)||void 0===n?void 0:n.size;var C=1;return Object.entries(y).forEach((function(e){var t,n=G(e,2),i=n[0],u=n[1],s=u.bindingPath,l=u.tag,c=u.formula,f=u.style,h=void 0===f?{}:f,p=Number(i);if(null==s||null===(t=s.includes)||void 0===t?void 0:t.call(s,".")){var d=s.split(".")[0];r.setTemplateDatas(b,d,a);var v=S.find((function(e){return e.col===p}))||{rowCount:1,colCount:1};if(v.rowCount>C&&(C=v.rowCount),l){var g=JSON.parse(l),y=g.columnMerge||!1,O=g.rowMerge||!1;(y||O)&&w.mergeInfos.push(ot(ot({},v),{},{row:o,col:p,columnMerge:y,rowMerge:O}))}}if(c){var E=qe(c);Array.isArray(E)&&E.forEach((function(e){r.setTemplateDatas(b,e,a)}))}null!=h&&h.decoration&&(null==h||delete h.decoration),function(e){var t=e.rules,n=e.col,r=e.colHandler,o=t;Number.isFinite(n)&&n>=0&&(o=o.filter((function(e){var t=e.ranges.some((function(e){var t=e.col,r=e.colCount;return t<=n&&n<t+r}));return t&&"function"==typeof r&&r(ct(e)),t})))}({rules:m,col:p,colHandler(e){w.rules.push(ot({},e))}})})),b.rowCount=C,b.endRow=b.row+C,b}},{key:"groupTemplate",value:function(){var e=this.reportJson,t=this.datas,n=this.tempConfig,r=e.sheetCount,o=[],i={},a={},u=ot({},n);Object.entries(n).forEach((function(n){var s,l=G(n,2),c=l[0],f=l[1],h=null==f?void 0:f.groups;if(h){var p=u[c],d={};Object.entries(h).some((function(e){var n=G(e,2),r=n[0],o=n[1];d[r]={};var i=t[r];if(Array.isArray(i)&&Array.isArray(o)&&o.length){var a,u=null==o||null===(a=o[0])||void 0===a?void 0:a.code;i.forEach((function(e){var t=e[u];Array.isArray(d[r][t])||(d[r][t]=[]),d[r][t].push(e)}))}}));var v=null==e||null===(s=e.sheets)||void 0===s?void 0:s[c];if(v&&0!==v.visible){var g=JSON.stringify(v),y=Object.values(d)[0],m=Object.keys(y);m.forEach((function(t,n){for(var s=t,l=1;e.sheets[s];)s=`${t}${l++}`;for(;m.includes(s)&&s!==t||o.includes(s);)s=`${t}${l++}`;if(s!==t){var f=d[t];delete d[t],d[s]=f}if(o.push(s),a[s]=d,i[s]=t,n<=0)v.name=s;else{var h=JSON.parse(g);h.name=s,h.isSelected=!1,h.index=r++,h.order=h.index,e.sheets[s]=h,e.sheetCount+=1}u[s]=ot(ot({},p),{},{fromTempSheet:c})}))}return!0}})),this.template=u,this.groupsDatas=a,this.nameMaps=i}},{key:"analysisTemplate",value:function(){var e=this;Object.values(this.reportJson.sheets).forEach((function(t){var n,r=t.name,o=t.visible,i=void 0===o?1:o,a=t.data,u=t.printInfo,s=u.paperSize,l=s.height,c=void 0===l?1100:l,f=s.width,h=void 0===f?850:f,p=u.orientation,d=u.margin,v=void 0===d?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:d;if(0!==i){var g=v.bottom,y=v.footer,m=v.header,w=v.top,b=v.left,S=v.right,C=e.template[r],O="",E=!1,A=null==a||null===(n=a.defaultDataNode)||void 0===n?void 0:n.tag;if(A){var k=JSON.parse(A);O=(null==k?void 0:k.pageArea)||"",E=null==k?void 0:k.isFillData}e.splitTemplate(t,O);var x=0;x=2===p?h-b-y-m-S:c-g-y-m-w;var M=!!C,P=null==C?void 0:C.fromTempSheet;M&&!e.templatesPageInfos[P]&&(e.templatesPageInfos[P]={pageIndex:0,pageTotal:0}),e.templatesPageInfos[P].pageIndex+=1,e.templatesPageInfos[P].pageTotal+=1;var T={sheet:t,spans:[],rows:{},rules:[],dataTable:{},autoMergeRanges:[],rowCount:0,pageIndex:1,pageTotal:1,pageArea:O,pageTotalHeight:x,pageHeight:0,isFillData:E,isCurrentSheet:null==C?void 0:C.isCurrentSheet,isTemplate:M,cobySheet:JSON.stringify(t),page:{},fromTempSheet:P};e.render(T)}}))}},{key:"getSheetCount",value:function(){return this.reportJson.sheetCount+Object.keys(this.newSheets).length}},{key:"genPageDataTables",value:function(e){var t=this,n=e.templates,r=e.pageInfos,o=e.startIndex,i=void 0===o?0:o,a=e.endIndex,u=void 0===a?0:a;n.forEach((function(e){var n=e.datas,o=e.dataTables,a=e.height,s=e.verticalAutoMergeRanges,l=st(n,t.setting),c=u||l.getCount()||1;(s=ct(s)).forEach((function(e){e.range.row=r.rowCount}));for(var f=r.page,h=r.rowCount,p=i,d=function(e){r.pageArea&&(r.pageHeight+a>r.pageTotalHeight?(h=r.rowCount,p=e,t.onAfterPage(r,a)):r.pageHeight+=a),o.forEach((function(n){var o=n.rows,i=void 0===o?{}:o,a=n.rowDataTable,u=n.spans,s=void 0===u?[]:u,c=n.rules,d=void 0===c?[]:c,v=n.autoMergeRanges,g=void 0===v?[]:v,y=ct(a);if(Object.entries(y).forEach((function(n){var o,i=G(n,2),a=i[0],u=i[1],s=Number(a),c=u.bindingPath,d=u.tag,v=u.formula;if(null!=c&&null!==(o=c.includes)&&void 0!==o&&o.call(c,".")){var g=G(c.split("."),2),y=g[0],m=g[1];delete u.bindingPath;var w=l.getValue(y,m,e),b=w.type,S=w.value;"text"===b&&(u.value=S)}var C=new Fe;if(d){var O=JSON.parse(d),E=O.instanceId;f[r.pageIndex]=f[r.pageIndex]||{},f[r.pageIndex][E]=f[r.pageIndex][E]||{};var A=f[r.pageIndex][E];A.row=h,A.col=s,A.count=A.count||0,A.count+=1,A.dataIndex=p,A.unionDatasource=l;var k=O.hyperlinkInfo||{};"document"===(null==k?void 0:k.type)&&null!=k&&k.isAutoDoc&&(u.hyperlink.url=`sjs://${u.value}!A1`,u.hyperlink.tooltip&&(u.hyperlink.tooltip=u.value));var x=O.plugins;if(Array.isArray(x)){let e=function(){var e,t=null==f||null===(e=f[T])||void 0===e?void 0:e[M];C.setFieldIndexHandler((function(){return{row:null==t?void 0:t.row,col:null==t?void 0:t.col}})),C.setDataCountHandler((function(){return null==t?void 0:t.count})),C.setDataIndex((function(){return null==t?void 0:t.dataIndex})),C.setUnionDatasourceHandler((function(){return null==t?void 0:t.unionDatasource}));var n=function(e,t,n){return Xe(e,t,n)}({type:"text",value:u.value},x,C),r=n.type,o=n.value;u["formula"===r?r:"value"]=o};var M="",P=x.some((function(e){var t=e.type,n=e.config;return"cellSubTotal"===t&&(M=null==n?void 0:n.instanceId),["cellSubTotal"].includes(t)})),T=r.pageIndex;P?t.delayPlugins.push(e):e()}}var j=r.pageIndex,I=r.fromTempSheet;t.templatesPageInfos[I]&&(j=t.templatesPageInfos[I].pageIndex);var R,D=(R=j,function(){return R});if(v){t.delayFormula.push((function(){C.setPageHandler(D),C.setTotalPagesHandler((function(){return t.templatesPageInfos[I]?t.templatesPageInfos[I].pageTotal:r.pageTotal})),C.setValueHandler((function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return 1===r.length?{type:"text",value:t.datas[r[0]]}:l.getValue(r[0],r[1],e)}));var n=Ke({type:"formula",value:v},C),o=n.type,i=n.value;u["formula"===o?o:"value"]=i}))}})),r){var m=r.rowCount;r.dataTable[m]=y,s.forEach((function(e){r.spans.push(ot(ot({},e),{},{row:m}))})),d.forEach((function(e){r.rules.push(ot(ot({},e),{},{ranges:[ot(ot({},e.ranges[0]),{},{row:m})]}))})),r.rows[m]=i,g.forEach((function(e){var t=ct(e);t.range.row=m,r.autoMergeRanges.push(t)})),r.rowCount+=1}}))},v=i;v<c;v++)d(v);s.forEach((function(e){e.range.rowCount=r.rowCount-e.range.row,r.autoMergeRanges.push(e)}))}))}},{key:"onAfterPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.isTemplate&&!e.isCurrentSheet)at(e),e.sheet=JSON.parse(e.cobySheet),e.sheet.name+=`_${e.pageIndex}`,e.sheet.index=this.getSheetCount(),e.sheet.isSelected=!1,this.newSheets[e.sheet.name]=e.sheet,e.dataTable={},e.spans=[],e.rows={},e.rules=[],e.autoMergeRanges=[],e.rowCount=0;else{var n=e.pageTotalHeight-e.pageHeight;if(n>0){var r=e.rowCount;e.dataTable[r]={},e.rows[r]={size:n},e.rowCount+=1}}e.pageHeight=t,e.pageIndex+=1,e.pageTotal+=1,null!=e&&e.fromTempSheet&&(this.templatesPageInfos[null==e?void 0:e.fromTempSheet].pageIndex+=1,this.templatesPageInfos[null==e?void 0:e.fromTempSheet].pageTotal+=1)}}]),e}(),ht=null,pt=function(){var e,t=r();try{(new t.Spread.Sheets.Workbook).getSheet(0).setValue(0,0,"test")}catch(n){return{success:!1,showError:!0}}return e=location.hostname,/^(127\.0\.0\.1|localhost)/g.test(e)?{success:!1,showWarn:!0}:{success:!0}};function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gt=r().Spread.Sheets;function yt(e,t,n,r){if(!e)return{datas:[],spansTree:[]};var o=t.map((function(e){return e.code})),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.length>0?function e(t,n){var r=U(n),o=new Map,i=r.shift();return t.forEach((function(e){var t=e[i];o.has(t)||o.set(t,{groupName:t,groupCode:i,allChildrens:[]}),o.get(t).allChildrens.push(e)})),o.forEach((function(t){r.length>0&&t.allChildrens.length>0&&(t.childrenGroups=e(t.allChildrens,r))})),o}(e,t):void 0;return new Map([["总",{groupName:"总",groupCode:null,allChildrens:U(e),childrenGroups:n}]])}(e,o),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).map((function(e){return e.code})),i=o.length>0,a=n.filter((function(e){var n=e.code;return!t.includes(n)&&!o.includes(n)})),u=a.length,s=function e(n){var s=null,l=0,c=[];return n.forEach((function(n,f,h){var p={children:[],verticalSpans:[]},d=n.childrenGroups,v=n.allChildrens,g=n.groupCode,y=n.groupName,m=0,w=t.indexOf(g);if(d){var b,S=e(d);s=S.lastChild,m+=S.totalRowCount,l+=S.totalRowCount,(b=p.children).push.apply(b,U(S.spansTree))}else v.forEach((function(e){s=e;var n=[];if(i){var c={};t.forEach((function(t){c[t]=e[t]}));for(var f=function(){var t=a[h].code;c[t]=e[t];var r=a[h+1].code,i=vt(vt({},c),{},A({},r,"小计"));o.forEach((function(t){var n=Number(e[t]);e[t]=Number.isNaN(n)?0:n,Object.defineProperty(i,t,{get:()=>e[t]})})),n.unshift(i),p.verticalSpans[h]||(p.verticalSpans[h]=[]),p.verticalSpans[h].push({rowCount:u-h,col:w+h+1,colCount:1,row:0,subtotalSpan:{rowCount:1,col:w+h+1+1,colCount:u-h-1,row:0},style:{vAlign:1}}),m++,l++},h=0;h<u-1;h++)f()}m++,l++,r.push.apply(r,[e].concat(n))}));var C={};if(g){if(i){var O=t.indexOf(g);t.forEach((function(e,t){t<=O&&(C[e]=s[e])}));var E=t[O+1];O+1===t.length&&(E=a[0].code),C[g]=y,C[E]="小计",p.subtotalSpan={row:0,col:O+1,rowCount:1,colCount:u+(t.length-O)-1},m++,l++}var k={rowCount:m,col:w,colCount:1,row:0,style:{vAlign:1}};p=vt(vt({},p),k)}else i&&(C[t[0]||(null==a?void 0:a[0].code)]="小计",p=vt(vt({},p),{},{row:l,rowCount:1,col:0,colCount:t.length+u,isTotal:!0}));i&&(o.forEach((function(e){Object.defineProperty(C,e,{get:()=>v.reduce((function(t,n){return t+n[e]}),0)})})),r.push(C)),c.push(p)})),{lastChild:s,totalRowCount:l,spansTree:c}}(e),l=s.spansTree;return{datas:r,spansTree:l}}(i,o,n,r);return{datas:a.datas,spansTree:a.spansTree}}var mt=r().Spread.Sheets,wt=se({position:"relative",width:"100%",height:"100%",overflow:"visible",userSelect:"none"}),bt=function(e,t,n){if(n){var o=r().Spread.Sheets.Events[t];e.bind(o,n)}},St=function(e){var t=e.spread,n=e.dataSource,r=e.sumColumns,o=e.groupColumns,i=e.rowMerge,a=e.columnMerge,u=e.rowMergeColumns,s=void 0===u?{}:u,l=e.colMergeColumns,c=void 0===l?{}:l;t&&t.sheets.forEach((function(e){var t,u=JSON.parse(JSON.stringify(n)),l=e.tables.all(),f=[],h=[],p=null;u&&(p=new mt.Bindings.CellBindingSource(u),e.setDataSource(p)),l.length>0&&l.forEach((function(e){var t=e.name(),n=o[t],i=r[t],a=s[t]||[],l=c[t]||[];if(Array.isArray(n)&&n.length>0||Array.isArray(i)&&i.length>0){var p=e.bindingPath(),d=e.range(),v=d.row,g=d.col,y=[];if(e.BSt.forEach((function(e){y.push({code:e.dataField()})})),null!=u&&u[p]){var m=yt(u[p],n,y,i),w=m.datas,b=m.spansTree;u[p]=w;var S=function(e){var t=[],n={};return function e(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=o;r.forEach((function(r){var u=r.row,s=void 0===u?0:u,l=r.col,c=void 0===l?0:l,f=r.rowCount,h=void 0===f?1:f,p=r.colCount,d=void 0===p?1:p,v=r.children,g=void 0===v?[]:v,y=r.verticalSpans,m=void 0===y?[]:y,w=r.subtotalSpan,b=r.isTotal,S=void 0!==b&&b;if(g.length>0&&e(g,a),m.length>0&&m.forEach((function(e,r){var o=a;e.forEach((function(e){if(e.hasOwnProperty("style")){var a=e.col,u=e.style;n[o]||(n[o]={}),n[o][a]||(n[o][a]={}),n[o][a].style=vt({},u)}t.push({row:o,col:e.col+i,rowCount:e.rowCount,colCount:e.colCount}),e.subtotalSpan.colCount>1&&t.push({row:o+e.rowCount-1,col:e.subtotalSpan.col+i,rowCount:e.subtotalSpan.rowCount,colCount:e.subtotalSpan.colCount}),o+=e.rowCount+r}))})),r.hasOwnProperty("style")){var C=r.col,O=r.style;n[a]||(n[a]={}),n[a][C]||(n[a][C]={}),n[a][C].style=vt({},O)}r.hasOwnProperty("row")&&((h>1||d>1)&&(S?t.push({row:s+o,col:c+i,rowCount:h,colCount:d}):t.push({row:a,col:c+i,rowCount:h,colCount:d})),w&&t.push({row:a+h-1,col:w.col+i,rowCount:w.rowCount,colCount:w.colCount}),a+=h)}))}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),{spans:t,dataTableStyle:n}}(b,v+1,g);f.push.apply(f,U(S.spans))}}if(a.length>0||l>0){var C=e.BSt.map((function(e){return{id:e.id(),code:e.dataField(),name:e.name()}})),O=e.range(),E=function(e){var t=e.rowMergeColumns,n=e.colMergeColumns,r=e.tableColumns,o=e.row,i=void 0===o?0:o;e.col;var a=e.rowCount,u=void 0===a?0:a,s=[];if(t.length||n.length){var l=t.map((function(e){return vt(vt({},e),{},{rowMerge:!0,colMerge:!1})}));n.forEach((function(e){var t=l.find((function(t){return t.code===(null==e?void 0:e.code)}));t?t.colMerge=!0:l.push(vt(vt({},e),{},{rowMerge:!1,colMerge:!0}))})),l.sort((function(e,t){return r.findIndex((function(t){return t.code===e.code}))-r.findIndex((function(e){return e.code===t.code}))}));var c=l[0],f=c.rowMerge,h=c.colMerge,p=gt.AutoMerge.AutoMergeDirection.column,d=gt.AutoMerge.AutoMergeMode.free,v=gt.SheetArea.viewport,g=gt.AutoMerge.SelectionMode.merged;f&&h?p=gt.AutoMerge.AutoMergeDirection.rowColumn:f&&(p=gt.AutoMerge.AutoMergeDirection.row);var y={row:i,col:-1,rowCount:u,colCount:1},m=-1;l.forEach((function(e){var t=e.code,n=e.rowMerge,o=e.colMerge,i=r.findIndex((function(e){return e.code===t}));-1===y.col?y.col=i:m+1===i&&f===n?y.colCount+=1:(s.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g}),f=n,y={row:1,col:i,rowCount:u+1,colCount:1},p=gt.AutoMerge.AutoMergeDirection.column,n&&o?p=gt.AutoMerge.AutoMergeDirection.rowColumn:n&&(p=gt.AutoMerge.AutoMergeDirection.row)),m=i})),(s.length>0&&s[s.length-1]!==y&&y.col>-1||s.length<=0&&y.col>-1)&&s.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g})}return s}({rowMergeColumns:a,colMergeColumns:l,tableColumns:C,row:O.row+1,rowCount:O.rowCount});h.push.apply(h,U(E))}}));var d=e.toJSON();d.spans=Array.isArray(d.spans)?d.spans:[],(t=d.spans).push.apply(t,f),d.autoMergeRangeInfos=h,e.fromJSON(d),p&&e.setDataSource(p),function(e){var t=e.sheet,n=e.rowMerge,r=e.columnMerge,o=t.tables.all();if(o.length>0&&(n||r)){var i=mt.AutoMerge.AutoMergeDirection.column,a=mt.AutoMerge.AutoMergeMode.free,u=mt.SheetArea.viewport,s=mt.AutoMerge.SelectionMode.merged;n&&r?i=mt.AutoMerge.AutoMergeDirection.rowColumn:n&&(i=mt.AutoMerge.AutoMergeDirection.row),t.suspendPaint(),o.forEach((function(e){var n=e.range();t.autoMerge(n,i,a,u,s)})),t.resumePaint()}}({sheet:e,rowMerge:i,columnMerge:a})}))};function Ct(t){var i=t.newTabVisible,u=void 0===i||i,s=t.tabEditable,l=void 0===s||s,c=t.tabStripVisible,f=void 0===c||c,h=t.onInited,p=t.onEnterCell,d=t.onActiveSheetChanged,v=t.onValueChanged,g=t.onSelectionChanged,y=t.onSelectionChanging,m=t.onEditorStatusChanged,w=t.onSheetNameChanged,b=t.onSheetNameChanging,S=t.onActiveSheetChanging;t.onFetchData;var C=t.onRowChanged,O=t.onUndo,E=t.onRedo,A=t.license,k=t.enablePrint,M=void 0!==k&&k,P=t.json,T=void 0===P?null:P,j=t.onPrintHandler,I=t.children,R=t.baseUrl,N=t.dataSource,V=void 0===N?null:N,L=t.sumColumns,H=void 0===L?[]:L,B=t.groupColumns,W=void 0===B?[]:B,U=t.rowMerge,J=void 0!==U&&U,Q=t.columnMerge,z=void 0!==Q&&Q,Y=t.rowMergeColumns,_=void 0===Y?{}:Y,X=t.colMergeColumns,K=void 0===X?{}:X,q=t.template,$=t.setting;A&&function(e){ht=e}(A),R&&(n=R);var te=r(),ne=ht||"593811994558535#B1dWhJlMLFTUwpXTsV6L03kcLpmNkR5VklDTz9mdnh4SmJ6c98WU9QEVrNDO5kTNOpUb9B7d9l5NjlWWsxmU9hHNmVTb9p5dU5UZmRkZXJlR4d5MENkVat4RKNWZMVlcuNmbph6SxYTUyoVcFBFeIlTe5QFSYhjShpneohmVoZTVhdFdBJGOuFDMsVDW8RjZrB5aQlFbSZVS48UNr5mY62EZ4UWYTFGbxpWZVBVMo3iaCZVNrcmYxlDZzIkWmNVc5FVRCl5KFFDMvMmSjRUUKpkTRRTdV3GOHZVY5llY9IUez2kTalFShN6cjFEOXZEeuVHcWxmWZtWViojITJCLiEkMygjR5UjI0ICSiwCO7YTMxYjM6ATM0IicfJye#4Xfd5nIVF4SRJiOiMkIsIyNx8idgMlSgQWYlJHcTJiOi8kI1tlOiQmcQJCLigDNyADOwAiNxQDM4IDMyIiOiQncDJCLiEjLw8CMucjMxIiOiMXbEJCLig1jlzahlDZmpnInmz9unHZvnfLsonLvlb1kpfbtmD0jnLiOiEmTDJCLiUzM5gTN5QTO9ETM8MTO5IiOiQWSiwSfdtlOicGbmJCLlNHbhZmOiI7ckJye0ICbuFkI1pjIEJCLi4TP7pXe62iNw34KDl5RVpHO8dVW7UESQN7Zl3ycj36V4NzbGJENV5kTtJDdEVjQjFnbutyRVhleuV6ZFVkRZxUdQZmdJlFZHpXWmhWYTZGSIF6LUJjdhZTMjNVVltbcYR";ne&&(te.Spread.Sheets.LicenseKey=ne);var re=G(e.useState((function(){var e=pt(),t=!1,n=!1;return e.success||(t=e.showError,n=e.showWarn),{spread:null,showError:t,showWarn:n}})),1)[0],oe=e.useRef(null),ie=e.useMemo((function(){var e=JSON.parse(JSON.stringify(T));return e&&V&&new ft(e,V,q,$),{json:e}}),[T,V,JSON.stringify(q),JSON.stringify($)]).json,ae=function(){var e=x(D.mark((function e(){var t,n,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!M){e.next=4;break}return t=a("print"),e.next=4,F.loadScript(t);case 4:if(re.spread||!oe.current||oe.showError){e.next=9;break}return n=r(),o=new n.Spread.Sheets.Workbook(oe.current,{sheetCount:0,newTabVisible:u,tabEditable:l,tabStripVisible:f}),re.spread=o,e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(){if(re.spread){var e=re.spread;e.unbindAll(),function(e,t){if(e&&t)for(var n=0,r=Object.entries(t);n<r.length;n++){var o=G(r[n],2),i=o[0],a=o[1];bt(e,i,a)}}(e,{EnterCell:p,ActiveSheetChanged:d,ValueChanged:v,ActiveSheetChanging:S,SheetNameChanged:w,SheetNameChanging:b,SelectionChanged:g,SelectionChanging:y,EditorStatusChanged:m,WorkbookUndo:O,WorkbookRedo:E,RowChanged:C})}},se=function(e){if(re.spread){var t=re.spread;o(t,e?function(){t.fromJSON(e);var n=t.sheets;n&&n.length>0&&n.forEach((function(e){e.options.sheetAreaOffset={left:1,top:1},e.recalcAll(!0)}))}:function(){var e;e=I?Array.isArray(I)?I:[I]:[],t.clearSheets();var n=r();e.forEach((function(e,r){var o=e.props,i=o.name,a=void 0===i?`Sheet${r+1}`:i,u=o.rowCount,s=void 0===u?20:u,l=o.colCount,c=void 0===l?20:l,f=new n.Spread.Sheets.Worksheet(a);f.options.sheetAreaOffset={left:1,top:1},f.setRowCount(s),f.setColumnCount(c),t.addSheet(r,f)}))})}},le=function(){if(re.spread){var e=re.spread;V&&St({spread:e,dataSource:V,sumColumns:H,groupColumns:W,rowMerge:J,columnMerge:z,rowMergeColumns:_,colMergeColumns:K})}},ce=function(){if(re.spread){var e=re.spread;j&&j((function(t){return new Promise((function(n,o){e?M?(e.sheets.forEach((function(e){!function(e,t){var n=t.orientation,o=t.printQuality,i=t.scaleType,a=t.fitPagesTall,u=t.fitPagesWide,s=t.zoomFactor,l=t.firstPageNumber,c=t.paperKind,f=t.margin,h=t.headerAndFooter,p=t.showGridLine,d=t.showHeader,v=t.blackAndWhite,g=t.pageOrder,y=t.showBorder,m=t.rowStart,w=t.rowEnd,b=t.columnStart,S=t.columnEnd,C=e.printInfo(),O=function(e,t){ye(e)||("string"==typeof t?C[t](e):t(e))};O(n,"orientation"),O(o,"qualityFactor"),ye(i)||(1==i?(a=-1,u=-1,s/=100):0==i&&(s=1),C.zoomFactor(s),C.fitPagesWide(u),C.fitPagesTall(a)),O(l,"firstPageNumber"),O(c,(function(){var e=new(r().Spread.Sheets.Print.PaperSize)(parseInt(c));C.paperSize(e)})),O(f,(function(){var e=f.left,t=f.right,n=f.top,o=f.bottom,i=f.header,a=f.footer,u=f.centering;C.margin({left:100*e,right:100*t,top:100*n,bottom:100*o,header:100*i,footer:100*a});var s=null,l=r();s=null!=u&&u.horizontally?null!=u&&u.vertically?l.Spread.Sheets.Print.PrintCentering.both:l.Spread.Sheets.Print.PrintCentering.horizontal:null!=u&&u.vertically?l.Spread.Sheets.Print.PrintCentering.vertical:l.Spread.Sheets.Print.PrintCentering.none,C.centering(s)})),O(null==h?void 0:h.pageHeaderFooter,"pageHeaderFooter"),O(p,"showGridLine"),O(d,(function(){var e=r(),t=d?e.Spread.Sheets.Print.PrintVisibilityType.show:e.Spread.Sheets.Print.PrintVisibilityType.hide;C.showRowHeader(t),C.showColumnHeader(t)})),O(v,"blackAndWhite"),O(g,"pageOrder"),O(y,"showBorder"),m=-1==m||ye(m)?0:m,C.rowStart(m),w=-1==w||ye(w)?e.getRowCount():w,C.rowEnd(w),b=-1==b||ye(b)?0:b,C.columnStart(b),S=-1==S||ye(S)?e.getColumnCount():S,C.columnEnd(S),e.printInfo(C)}(e,t||{})})),e.print(),n()):o(Error("打印失败，原因：初始化报表时未开启打印功能")):o(Error("打印失败，原因：报表未初始化"))}))}))}},fe=function(){re.spread.suspendEvent(),ee(re.spread),re.spread.resumeEvent()};return e.useEffect((function(){x(D.mark((function e(){var t;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae();case 2:e.sent?(ue(),se(ie),le(),ce(),h?(t=h(re.spread))&&t.then&&t.then((function(e){se(e),fe()})):fe()):fe();case 4:case"end":return e.stop()}}),e)})))()}),[ie,V,p,d,v,S,w,b,g,y,m,O,E]),Z.jsxs(wt,{children:[re.showError?Z.jsx(de,{}):Z.jsx("div",{style:{width:"100%",height:"100%",overflow:"visible",userSelect:"none"},ref:oe}),!re.showError&&re.showWarn?Z.jsx(ge,{}):null]})}var Ot=["onInited","ready","dataSource"];function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kt=function(){function n(e){p(this,n),A(this,"conf",{}),A(this,"spread",null),A(this,"printHandler",null),this.conf=e}return y(n,[{key:"mount",value:function(n){var i,a,u,s,l,c=this;r().Spread.Common.CultureManager.culture("zh-cn");var f=this.conf||{},h=f.onInited,p=f.ready,d=f.dataSource,v=E(f,Ot),g=null===(i=this.conf)||void 0===i||null===(i=i.json)||void 0===i?void 0:i.reportJson;g&&(g=JSON.parse(JSON.stringify(g)));var y=(null===(a=this.conf)||void 0===a||null===(a=a.json)||void 0===a||null===(a=a.context)||void 0===a?void 0:a.tableDesignSlice)||{},m=y.rowMerge,w=y.columnMerge,b=((null===(u=this.conf)||void 0===u?void 0:u.event)||{}).onFetchData,S=(null===(s=this.conf)||void 0===s||null===(s=s.json)||void 0===s||null===(s=s.context)||void 0===s?void 0:s.datasourceSlice)||{},C=S.sumColumns,A=S.tableGroups,k=S.rowMergeColumns,x=void 0===k?{}:k,M=S.colMergeColumns,P=void 0===M?{}:M;t.createRoot(n).render(e.createElement(Ct,At(At({onInited:function(e){c.spread=e,h&&h(e),"function"==typeof p&&o(e,(function(){p(new O(e))}))},onPrintHandler:function(e){c.printHandler=e},baseUrl:null===(l=this.conf)||void 0===l?void 0:l.baseUrl,onFetchData:b,rowMerge:m,columnMerge:w,sumColumns:C,groupColumns:A,rowMergeColumns:x,colMergeColumns:P,dataSource:d},v),{},{json:g})))}},{key:"exportExcel",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreFormula:!1,ignoreStyle:!1};return new Promise((function(o,i){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".xlsx")?e:e+".xlsx",F.loadScript(a("excel")).then((function(){var a=new(r().Spread.Excel.IO),u=JSON.stringify(t.spread.toJSON());a.save(u,(function(t){H(t,e),o()}),(function(e){i(e)}),{columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeBindingSource:!1,includeCalcModelCache:!1,includeEmptyRegionCells:!0,includeFormulas:!n.ignoreFormula,includeStyles:!n.ignoreStyle,includeUnusedNames:!0,password:void 0,rowHeadersAsFrozenColumns:!1,saveAsView:!1})}))):i(Error("导出excel失败，原因:没有传递导出文件名"))}))}},{key:"exportPdf",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{persistence:!0,author:"",creator:"",keywords:"",subject:"",title:"",sheetIndex:null};return new Promise((function(o,i){if("string"==typeof e&&""!==e.trim()){e=e.endsWith(".pdf")?e:e+".pdf";var u=function(){var r=n.persistence,a=n.author,u=n.creator,s=n.keywords,l=n.subject,c=n.title,f=n.sheetIndex;t.spread.savePDF((function(t){r&&H(t,e),o(t)}),(function(e){i(e)}),{author:a,creator:u,keywords:s,subject:l,title:c},null==f?void 0:f)};r().Spread.Sheets.PDF?u():F.loadScript(a("pdf")).then(u)}else i(Error("导出pdf失败，原因:没有传递导出文件名"))}))}},{key:"print",value:function(e){var t=this;return new Promise((function(n,r){t.printHandler?t.printHandler(e).then(n).catch(r):r(Error("打印失败，原因：报表未初始化"))}))}}]),n}();return{FontStyle:{normal:"normal",italic:"italic"},FontWeight:{normal:"normal",bold:"bold"},HAlign:f,LineBorder:m,LineStyle:c,Preview:kt,VAlign:h,WorkBook:O,WorkSheet:C}}));
