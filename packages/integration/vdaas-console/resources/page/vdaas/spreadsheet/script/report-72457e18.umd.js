!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom/client")):"function"==typeof define&&define.amd?define(["react","react-dom/client"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).TOONE=e.TOONE||{},e.TOONE.Report=t(e.React,e.ReactDOM))}(this,(function(e,t){"use strict";var n=".",r=function(){return window.GC},o=function(e,t){if(e){e.suspendPaint(),e.suspendEvent();var n=e.getActiveSheet();try{t(n)}finally{e.resumePaint(),e.resumeEvent()}}},a={print:["print.min.js"],pdf:["print.min.js","pdf.min.js"],excel:["excelio.min.js"]},i=function(e){return a[e].map((function(e){return l(e)}))};var u=function(){var e=r().Spread.Sheets.productInfo.productVersion;return`${n}/vendor/excel/${e}`},l=function(e){return`${u()}/plugins/${e}`},s=r(),c={dashed:s.Spread.Sheets.LineStyle.dashed,dotted:s.Spread.Sheets.LineStyle.dotted,double:s.Spread.Sheets.LineStyle.double,empty:s.Spread.Sheets.LineStyle.empty,thick:s.Spread.Sheets.LineStyle.thick,thin:s.Spread.Sheets.LineStyle.thin},f={center:s.Spread.Sheets.HorizontalAlign.center,left:s.Spread.Sheets.HorizontalAlign.left,right:s.Spread.Sheets.HorizontalAlign.right},h={center:s.Spread.Sheets.VerticalAlign.center,bottom:s.Spread.Sheets.VerticalAlign.bottom,top:s.Spread.Sheets.VerticalAlign.top};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function y(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var m=function(){function e(t,n){p(this,e),this.color=t,this.style=n}return y(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStyle",value:function(e){this.style=e}},{key:"getStyle",value:function(){return this.style}},{key:"_to",value:function(){return new(r().Spread.Sheets.LineBorder)(this.color,this.style)}}]),e}();document.createElement("span");var w=function(e,t){return null==e?t:e},b=function(e,t,n){var o=r(),a=n.fontWeight,i=n.fontStyle,u=n.fontFamily,l=n.fontSize,s=n.textDecoration,c=n.backColor,f=n.foreColor,h=n.wordWrap;!function(e,t,n){for(var r=e.col,o=e.row,a=e.rowCount,i=e.colCount,u=0;u<a;u++)for(var l=0;l<i;l++)n(t,o+u,r+l)}(t,e,(function(e,t,n){var r=new o.Spread.Sheets.Style,p=e.getStyle(t,n),d=function(e){var t="normal",n="normal",r="normal",o="Calibri";if(e)for(var a,i=e.split(/\s+/);a=i.shift();)switch(a){case"normal":break;case"italic":case"oblique":t=a;break;case"small-caps":n=a;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":r=a;break;default:o=a,i.length&&(o+=" "+i.join(" "))}return{fontStyle:t,fontVariant:n,fontWeight:r,fontSize:11,lineHeight:"normal",fontFamily:o}}(p.font);Object.assign(r,p),u=w(u,d.fontFamily),l=w(l,d.fontSize),i=w(i,d.fontStyle),a=w(a,d.fontWeight),s=w(s,p.textDecoration),c=w(c,p.backColor),f=w(f,p.foreColor);var v=function(e){return e&&-1===e.indexOf("'")&&-1===e.indexOf('"')?`"${e}"`:e}(u),g=function(e){var t=e.fontFamily,n=void 0===t?"":t,r=e.fontStyle,o=void 0===r?"":r,a=e.fontVariant,i=void 0===a?"":a,u=e.fontWeight,l=void 0===u?"":u,s=e.fontSize,c=void 0===s?"":s,f=e.lineHeight,h=[o,i,l,c,void 0===f?"":f,n].join(" "),p=document.createElement("span");return p.style.font=h,p.style.font}({fontFamily:v,fontSize:l?`${l}pt`:"",fontStyle:i,fontWeight:a});r.font=g,r.textDecoration=s,r.backColor=c,r.foreColor=f,r.wordWrap=h,e.setStyle(t,n,r)}))},C=function(){function e(t,n){p(this,e),this.sheet=t,this.cellRange=n}return y(e,[{key:"hAlign",value:function(e){this.cellRange.hAlign(e)}},{key:"vAlign",value:function(e){this.cellRange.vAlign(e)}},{key:"setBorder",value:function(e,t){this.cellRange.setBorder(e,t)}},{key:"fontFamily",value:function(e){b(this.sheet,this.cellRange,{fontFamily:e})}},{key:"fontSize",value:function(e){b(this.sheet,this.cellRange,{fontSize:e})}},{key:"fontStyle",value:function(e){b(this.sheet,this.cellRange,{fontStyle:e})}},{key:"fontWeight",value:function(e){b(this.sheet,this.cellRange,{fontWeight:e})}},{key:"wordWrap",value:function(e){b(this.sheet,this.cellRange,{wordWrap:e})}}]),e}(),S=function(){function e(t){p(this,e),this.sheet=t}return y(e,[{key:"name",value:function(e){this.sheet.name(e)}},{key:"getCell",value:function(e,t){var n=this.sheet.getCell(e,t);return new C(this.sheet,n)}},{key:"getRange",value:function(e,t,n,r){var o=this.sheet.getRange(e,t,n,r);return new C(this.sheet,o)}},{key:"addSpan",value:function(e,t,n,r){this.sheet.addSpan(e,t,n,r)}},{key:"addRows",value:function(e,t){this.sheet.addRows(e,t)}},{key:"addColumns",value:function(e,t){this.sheet.addColumns(e,t)}},{key:"setValue",value:function(e,t,n){this.sheet.setValue(e,t,n)}},{key:"setFormula",value:function(e,t,n){this.sheet.setFormula(e,t,n)}},{key:"setRowCount",value:function(e){this.sheet.setRowCount(e)}},{key:"setRowHeight",value:function(e,t){this.sheet.setRowHeight(e,t)}},{key:"setColumnCount",value:function(e){this.sheet.setColumnCount(e)}},{key:"setColumnWidth",value:function(e,t){this.sheet.setColumnWidth(e,t)}},{key:"setDefaults",value:function(e){Object.assign(this.sheet.defaults,e)}},{key:"setOptions",value:function(e){var t=e.colHeaderVisible,n=void 0===t||t,r=e.rowHeaderVisible,o=void 0===r||r,a=e.showHorizontalGridline,i=void 0===a||a,u=e.showVerticalGridline,l=void 0===u||u,s=e.isProtected,c=void 0!==s&&s;Object.assign(this.sheet.options,{colHeaderVisible:n,rowHeaderVisible:o,isProtected:c}),Object.assign(this.sheet.options.gridline,{showHorizontalGridline:i,showVerticalGridline:l})}}]),e}(),O=function(){function e(t){p(this,e),this.spread=t}return y(e,[{key:"addSheet",value:function(e){this.spread.addSheet(e)}},{key:"getSheet",value:function(e){var t=this.spread.getSheet(e);return t?new S(t):null}},{key:"setOptions",value:function(e){var t=e.newTabVisible,n=void 0===t||t,r=e.tabStripVisible,o=void 0===r||r,a=e.showHorizontalScrollbar,i=void 0===a||a,u=e.showVerticalScrollbar,l=void 0===u||u;Object.assign(this.spread.options,{newTabVisible:n,tabStripVisible:o,showHorizontalScrollbar:i,showVerticalScrollbar:l})}}]),e}();function E(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function A(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t,n,r,o,a,i){try{var u=e[a](i),l=u.value}catch(s){return void n(s)}u.done?t(l):Promise.resolve(l).then(r,o)}function P(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){k(a,r,o,i,u,"next",e)}function u(e){k(a,r,o,i,u,"throw",e)}i(void 0)}))}}function x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var T={exports:{}},M={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(M);var j=M.exports;!function(e){var t=j.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=n=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var r,o={},a=Object.prototype,i=a.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},l="function"==typeof Symbol?Symbol:{},s=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(N){h=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),i=new I(r||[]);return u(a,"_invoke",{value:T(e,n,i)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}o.wrap=p;var v="suspendedStart",g="suspendedYield",y="executing",m="completed",w={};function b(){}function C(){}function S(){}var O={};h(O,s,(function(){return this}));var E=Object.getPrototypeOf,A=E&&E(E(D([])));A&&A!==a&&i.call(A,s)&&(O=A);var k=S.prototype=b.prototype=Object.create(O);function P(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,n){function r(o,a,u,l){var s=d(e[o],e,a);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==t(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,u,l)}),(function(e){r("throw",e,u,l)})):n.resolve(f).then((function(e){c.value=e,u(c)}),(function(e){return r("throw",e,u,l)}))}l(s.arg)}var o;u(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(a,a):a()}})}function T(e,t,n){var o=v;return function(a,i){if(o===y)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:r,done:!0}}for(n.method=a,n.arg=i;;){var u=n.delegate;if(u){var l=M(u,n);if(l){if(l===w)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===v)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=d(e,t,n);if("normal"===s.type){if(o=n.done?m:g,s.arg===w)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function M(e,t){var n=t.method,o=e.iterator[n];if(o===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=r,M(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var a=d(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,w;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,w):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(i.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=r,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return C.prototype=S,u(k,"constructor",{value:S,configurable:!0}),u(S,"constructor",{value:C,configurable:!0}),C.displayName=h(S,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===C||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,h(e,f,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},P(x.prototype),h(x.prototype,c,(function(){return this})),o.AsyncIterator=x,o.async=function(e,t,n,r,a){void 0===a&&(a=Promise);var i=new x(p(e,t,n,r),a);return o.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},P(k),h(k,f,"Generator"),h(k,s,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},o.values=D,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,o){return u.type="throw",u.arg=e,t.next=n,o&&(t.method="next",t.arg=r),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(l&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),w}},o}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(T);var R=(0,T.exports)(),I=R;try{regeneratorRuntime=R}catch(Pt){"object"==typeof globalThis?globalThis.regeneratorRuntime=R:Function("r","regeneratorRuntime = r")(R)}const D=x(I);var N=function(e){return e?"string"==typeof e&&(e=[e]):e=[],e},F=function(){function e(){p(this,e),this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptMaps={},this._dataPromises={}}var t,n,r,o,a,i,u,l;return y(e,[{key:"loadScript",value:(l=P(D.mark((function e(t){var n,r,o,a=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],(t=N(t)).forEach((function(e){(r=a._scriptMaps[e]=a._scriptMaps[e]||{}).promise||(r.path=e,r.promise=new Promise((function(t){(n=a.createScriptElement()).setAttribute("type","text/javascript"),n.src=e,n.addEventListener("load",t),a._head.appendChild(n)}))),o.push(r.promise)})),e.abrupt("return",Promise.all(o));case 4:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"unloadScript",value:(u=P(D.mark((function e(t){var n,r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(n=r._head.querySelectorAll('script[src="'+e+'"]')[0])&&(r._head.removeChild(n),delete r._scriptMaps[e])})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"createScriptElement",value:function(){return document.createElement("script")}},{key:"fetchData",value:(i=P(D.mark((function e(t){var n,r,o=arguments;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:{},r=t+JSON.stringify(n),n.cache=void 0===n.cache||n.cache,t){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this._dataPromises[r]&&n.cache){e.next=16;break}return e.prev=6,e.next=9,fetch(t,n);case 9:this._dataPromises[r]=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),this._dataPromises[r]=null,e.t0;case 16:return e.abrupt("return",this._dataPromises[r]);case 17:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return i.apply(this,arguments)})},{key:"loadCss",value:(a=P(D.mark((function e(t){var n=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){if(!n._cssPaths[e]){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),n._head.appendChild(t),n._cssPaths[e]=t}})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"unloadCss",value:(o=P(D.mark((function e(t){var n,r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(n=r._cssPaths[e])&&(r._head.removeChild(n),r._cssPaths[e]=null)})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadTemplate",value:(r=P(D.mark((function e(t,n){var r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.fetchTemplate(t);case 4:if(r=e.sent,!n){e.next=8;break}return n.innerHTML=r,e.abrupt("return",n);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"fetchTemplate",value:(n=P(D.mark((function e(t){var n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"flush",value:(t=P(D.mark((function e(){var t,n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadCss(Object.getOwnPropertyNames(this._cssPaths));case 2:this._cssPaths={},e.t0=D.keys(this._scriptMaps);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(t=e.t1.value,!this._scriptMaps.hasOwnProperty(t)){e.next=10;break}return n=this._scriptMaps[t],e.next=10,this.unloadScript(n.path);case 10:e.next=4;break;case 12:this._scriptMaps={},this._dataPromises={};case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),V=new F;function H(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");e.dispatchEvent(t)}}function L(e,t){var n=window.URL||window.webkitURL,r=document.createElement("a");r.download=t,r.rel="noopener","string"==typeof e?(r.href=e,r.origin==window.location.origin?H(r):function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return 200<=t.status&&t.status<=299}(r.href)||(r.target="_blank",H(r))):(r.href=n.createObjectURL(e),setTimeout((function(){n.revokeObjectURL(r.href)}),4e4),setTimeout((function(){H(r)}),0))}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}function U(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,u=[],l=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(c){s=!0,o=c}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return u}}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J,z={exports:{}},Q={};z.exports=function(){if(J)return Q;J=1;var t=e,n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,r){var u,l={},s=null,c=null;for(u in void 0!==r&&(s=""+r),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,u)&&!i.hasOwnProperty(u)&&(l[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps)void 0===l[u]&&(l[u]=t[u]);return{$$typeof:n,type:e,key:s,ref:c,props:l,_owner:a.current}}return Q.Fragment=r,Q.jsx=u,Q.jsxs=u,Q}();var Z=z.exports,Y=r();function _(){this.name="TOONE.GET",this.maxArgs=2,this.minArgs=1}_.prototype=new Y.Spread.CalcEngine.Functions.Function,_.prototype.evaluate=function(e){return"[函数(Fx)]"};var X=r();function K(){this.name="TOONE.GROUPNAME",this.maxArgs=0,this.minArgs=0}K.prototype=new X.Spread.CalcEngine.Functions.Function,K.prototype.description=function(){return{description:"获取分组名称",parameters:[]}},K.prototype.evaluate=function(e){return"[函数(Fx)]"};var q=r();function $(){this.name="TOONE.PAGECOUNT",this.maxArgs=0,this.minArgs=0}$.prototype=new q.Spread.CalcEngine.Functions.Function,$.prototype.description=function(){return{description:"获取总页数",parameters:[]}},$.prototype.evaluate=function(e){return"[函数(Fx)]"};var ee=r();function te(){this.name="TOONE.PAGEINDEX",this.maxArgs=0,this.minArgs=0}te.prototype=new ee.Spread.CalcEngine.Functions.Function,te.prototype.description=function(){return{description:"获取当前页",parameters:[]}},te.prototype.evaluate=function(e){return"[函数(Fx)]"};var ne=function(e){!function(e){var t=new _;e.addCustomFunction(t);var n=new $;e.addCustomFunction(n);var r=new te;e.addCustomFunction(r);var o=new K;e.addCustomFunction(o)}(e)};const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABkCAYAAACWy14QAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlBNDFDQzUzRkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlBNDFDQzU0RkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUE0MUNDNTFGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUE0MUNDNTJGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52RmQBAAAR1klEQVR42uxd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";var oe=["children"],ae=["children"],ie=["children"];function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se,ce=function(e){return function(t){var n=t.children,r=E(t,oe);return Z.jsx("div",le(le({style:e},r),{},{children:n}))}},fe=function(e){return function(t){var n=t.children,r=E(t,ae);return Z.jsx("span",le(le({style:e},r),{},{children:n}))}},he=ce({color:"#6a6a6a",textAlign:"center",verticalAlign:"middle",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"440px",whiteSpace:"nowrap"}),pe=(se={display:"inline-block",width:"100px",height:"105px",verticalAlign:"middle"},function(e){var t=e.children,n=E(e,ie);return Z.jsx("img",le(le({style:se},n),{},{children:t}))}),de=fe({display:"inline-block",paddingLeft:"10px",textAlign:"left",verticalAlign:"middle",fontSize:"14px"}),ve=fe({display:"inline-block",fontSize:"20px",fontWeight:"600",opacity:"0.8"});function ge(){return Z.jsxs(he,{children:[Z.jsx(pe,{src:re}),Z.jsxs(de,{children:[Z.jsx(ve,{children:"未找到有效许可证！"}),Z.jsx("br",{}),"获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询。"]})]})}var ye=ce({position:"absolute",bottom:"50px",right:"50px",color:"#6a6a6a",zIndex:"999",textAlign:"right",fontSize:"14px",pointerEvents:"none"});function me(){return Z.jsxs(ye,{children:["获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询"]})}var we=function(e){return null==e},be=function(e){return"string"==typeof e&&e.trim().length>0};function Ce(e,t){return(Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Se(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ce(e,t)}function Oe(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e){return r().Spread.CalcEngine.ExpressionType[e]}function ke(e){return{lMt:!0,type:Ae("string"),value:e}}function Pe(e){return{lMt:!0,originalValue:e+"",type:Ae("number"),value:e}}function xe(e){switch(typeof e){case"number":return Pe(e);case"boolean":return function(e){return{lMt:!0,type:Ae("boolean"),value:e}}(e);default:return ke(we(e)?"":e)}}var Te=function(e){return r().Spread.Sheets.CalcEngine.formulaToExpression(null,e,0,0)};var Me=function(e,t){switch(e.functionName){case"TOONE.GET":return function(e,t){var n,r,o,a=e.arguments;if(!a||0==a.length)throw Error("TOONE.GET函数未传递参数，请检查配置！");r=a[0].value,o=null===(n=a[1])||void 0===n?void 0:n.value;var i=t.getValue(r,o);return"text"==i.type?xe(i.value):Te(i.value)}(e,t);case"TOONE.PAGECOUNT":return function(e,t){return Pe(t.getPageCount())}(0,t);case"TOONE.PAGEINDEX":return function(e,t){return Pe(t.getPageIndex())}(0,t);case"TOONE.GROUPNAME":return function(e,t){return ke(t.getGroupName())}(0,t)}return null},je=function(){function e(t){p(this,e),this.ast=t}return y(e,[{key:"getAST",value:function(){return this.ast}},{key:"parse",value:function(e){return this.ast}},{key:"toParser",value:function(e){return e&&"number"==typeof e.type?He(e):null}},{key:"parseValue",value:function(e,t){var n=this.toParser(e);return n?n.parse(t):e}},{key:"_getVisitChildren",value:function(){return[]}},{key:"_getVisitHandlerName",value:function(){return null}},{key:"visit",value:function(e){var t=this,n=this._getVisitHandlerName(),r=e[n],o=!0;("function"==typeof r&&(o=!1!==r.call(e,this)),o)&&this._getVisitChildren().forEach((function(n){var r=t.toParser(n);r&&r.visit(e)}))}}]),e}();function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Ie=function(e){Se(n,e);var t=Re(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this,n=this.getAST(),r=Me(n,e);if(null!==r)return r;var o=n.arguments;if(Array.isArray(o)){var a=o.map((function(n){return t.parseValue(n,e)}));n.arguments=a}return n}},{key:"_getVisitHandlerName",value:function(){return"visitFunction"}},{key:"_getVisitChildren",value:function(){var e=this.getAST().arguments;return Array.isArray(e)?e:[]}}]),n}(je);function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Ne=function(e){Se(n,e);var t=De(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t.value2=this.parseValue(t.value2,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitOperator"}},{key:"_getVisitChildren",value:function(){var e=this.getAST();return[e.value,e.value2]}}]),n}(je);function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Ve=function(e){Se(n,e);var t=Fe(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitParentheses"}},{key:"_getVisitChildren",value:function(){return[this.getAST().value]}}]),n}(je),He=function(e){var t=e.type,n=r().Spread.CalcEngine.ExpressionType;switch(t){case n.operator:return new Ne(e);case n.function:return new Ie(e);case n.parentheses:return new Ve(e);default:return new je(e)}},Le=function(){function e(t){p(this,e),this.handlers=t}return y(e,[{key:"_visit",value:function(e,t){var n=this.handlers[e];if(n)return n(t)}},{key:"visitFunction",value:function(e){return this._visit("function",e)}},{key:"visitOperator",value:function(e){return this._visit("operator",e)}},{key:"visitParentheses",value:function(e){return this._visit("parentheses",e)}}]),e}(),Ge=function(){function e(){p(this,e)}return y(e,[{key:"setFieldIndexHandler",value:function(e){this.fieldIndexHandler=e}},{key:"setDataCountHandler",value:function(e){this.dataCountHandler=e}},{key:"setPageHandler",value:function(e){this.pageHandler=e}},{key:"setTotalPagesHandler",value:function(e){this.totalPagesHandler=e}},{key:"setUnionDatasourceHandler",value:function(e){this.unionDatasourceHandler=e}},{key:"setDataIndex",value:function(e){this.dataIndexHandler=e}},{key:"setValueHandler",value:function(e){this.valueHandler=e}},{key:"setSettingHandler",value:function(e){this.settingHandler=e}},{key:"setGroupNameHandler",value:function(e){this.groupNameHandler=e}},{key:"setIsGroupSumAreaHandler",value:function(e){this.isGroupSumAreaHandler=e}},{key:"getFieldIndex",value:function(e,t){return this.fieldIndexHandler(e,t)}},{key:"getDataIndex",value:function(e,t){return this.dataIndexHandler(e,t)}},{key:"getDataCount",value:function(e){return this.dataCountHandler(e)}},{key:"getUnionDatasource",value:function(){return this.unionDatasourceHandler()}},{key:"getPage",value:function(){return this.pageHandler()}},{key:"getTotalPages",value:function(){return this.totalPagesHandler()}},{key:"getPageIndex",value:function(){return this.pageHandler()}},{key:"getPageCount",value:function(){return this.totalPagesHandler()}},{key:"getValue",value:function(e,t){return this.valueHandler(e,t)}},{key:"getGroupName",value:function(){return this.groupNameHandler()}},{key:"isInGroupSumArea",value:function(){return this.isGroupSumAreaHandler()}},{key:"getSetting",value:function(){return this.settingHandler()}}]),e}(),Be=function(){function e(t){p(this,e),this.plugin=t}return y(e,[{key:"getConfig",value:function(){return this.plugin?this.plugin.config:null}},{key:"execute",value:function(e,t){return e}}]),e}();function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Je=[["url",""],["mode",1],["height",0],["width",0],["clipX",0],["clipY",0],["clipHeight",0],["clipWidth",0],["vAlign",1],["hAlign",1]],ze=function(e){var t=["IMAGE("];return Je.forEach((function(n){var r,o=void 0;Array.isArray(n)?(r=n[0],o=n[1]):r=n;var a=e[r];a=a===o?void 0:a,t.push(function(e){return we(e)?"":e}(a)),t.push(",")})),t.pop(),t.push(")"),t.join("")},Qe=function(e){Se(n,e);var t=We(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){var n=this.getConfig(),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:"formula"==e.type?e.value:`"${e.value}"`},n);return{type:"formula",value:ze(r)}}}]),n}(Be);function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Ye=function(e){Se(n,e);var t=Ze(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){return{type:"text",value:t.getPage()}}}]),n}(Be),_e=null,Xe=function(){if(null==_e){var e=new(r().Spread.Sheets.Workbook);_e=e.getSheet(0)}return _e},Ke=function(e){if(0==e.length)return 0;var t=e.join("+"),n=Xe();return GC.Spread.Sheets.CalcEngine.evaluateFormula(n,t)};function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var $e=function(e){Se(n,e);var t=qe(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"groupSubTotal",value:function(e,t){var n,r,o,a=this.getConfig(),i=a.functionNum,u=a.tableCode,l=a.fieldCode,s=t.getUnionDatasource(),c=this._isTreeSumField(e,t)?s.getLeafFieldValues(u,l):s.getFieldValues(u,l),f=function(){var e=[];return c.forEach((function(t){var n=t.value;isNaN(n)||e.push(parseFloat(n))})),e},h=null;switch(i){case 101:n=Ke(f()),r=c.length,o=Xe(),h=GC.Spread.Sheets.CalcEngine.evaluateFormula(o,`${n}/${r}`);break;case 103:h=c.length;break;case 102:h=f().length;break;case 104:h=function(e){var t=void 0;return e.forEach((function(e){(void 0===t||e>t)&&(t=e)})),t}(f());break;case 105:h=min(f());break;case 109:h=Ke(f())}return{type:"text",value:h}}},{key:"_isTreeSumField",value:function(e,t){var n=this.getConfig(),r=n.tableCode,o=n.fieldCode;return t.getUnionDatasource().isTreeSumField(r,o)}},{key:"_rangesToFormulaArgs",value:function(e){var t=r().Spread.Sheets.CalcEngine,n=t.RangeReferenceRelative.allRelative;return(0,t.rangesToFormula)(e,0,0,n,!1)}},{key:"_getSubTotalRanges",value:function(e,t){var n=[],o=t.getUnionDatasource(),a=this.getConfig(),i=a.tableCode,u=a.fieldCode,l=t.getDataCount(i),s=t.getFieldIndex(i,u),c=s.row,f=s.col,h=r().Spread.Sheets.Range;if(this._isTreeSumField(e,t)){var p=t.getDataIndex(i,u);o.getLeafRanges(i,p,p+l).forEach((function(e){n.push(new h(c+(e-p),f,1,1))}))}else n.push(new h(c,f,l,1));return n}},{key:"subTotal",value:function(e,t){var n=this._getSubTotalRanges(e,t);return{type:"formula",value:`SUBTOTAL(${this.getConfig().functionNum},${this._rangesToFormulaArgs(n)})`}}},{key:"execute",value:function(e,t){return t.isInGroupSumArea()?this.groupSubTotal(e,t):this.subTotal(e,t)}}]),n}(Be);function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var tt=function(e){Se(n,e);var t=et(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){return{type:"text",value:t.getTotalPages()}}}]),n}(Be),nt=function(e,t,n){return t.forEach((function(t){var r=function(e){switch(e.type){case"cellImage":return new Qe(e);case"cellSubTotal":return new $e(e);case"pageCellType":return new Ye(e);case"totalPagesCellType":return new tt(e);default:return null}}(t);r&&(e=r.execute(e,n))})),e},rt=function(e,t){return e&&"formula"==e.type?function(e,t){if(be(e)){var n=Te(e);return n=He(n).parse(t),{type:"formula",value:e=GC.Spread.Sheets.CalcEngine.expressionToFormula(null,n,0,0)}}return{type:"formula",value:e}}(e.value,t):e},ot=function(e){return e?function(e){var t=[];if(be(e)){var n=Te(e),r=He(n),o=new Le({function:function(e){var n=e.getAST();if("TOONE.GET"==n.functionName){var r=n.arguments;return 2==r.length&&t.push(r[0].value),!1}}});r.visit(o)}return t}(e):[]};function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var it=function(){function e(t,n){p(this,e),A(this,"datas",[]),A(this,"references",[]),A(this,"treeStruct",{}),A(this,"treeDataIndexMap",{}),A(this,"datasources",{}),this._parseBindingPaths(t),this.setting=n,this._anslysisSetting()}return y(e,[{key:"_parseBindingPaths",value:function(e){var t=this;e&&e.length>0&&e.forEach((function(e){var n=e.split("."),r=n.length;if(1==r){var o=n[0];t.datasources[o]={type:"param"}}else if(2==r){var a=n[0],i=n[1],u=t.datasources[a]||{type:"field",fields:[]},l=u.fields;-1==l.indexOf(i)&&l.push(i),t.datasources[a]=u}}))}},{key:"_containsTable",value:function(e){var t=this.datasources[e];return t&&"field"==t.type}},{key:"_analysisTreeStructSetting",value:function(){if(this.setting.treeStruct)for(var e=0,t=Object.entries(this.setting.treeStruct);e<t.length;e++){var n=W(t[e],2),r=n[0],o=n[1];this._containsTable(r)&&(this.treeStruct[r]=o)}}},{key:"_analysisReferenceSetting",value:function(){var e=this;this.setting.references&&this.setting.references.forEach((function(t){var n=t.foreignKey,r=t.references;e._containsTable(n.tableCode)&&e._containsTable(r.tableCode)&&e.references.push(t)}))}},{key:"_analysisPluginSetting",value:function(){var e=this,t=this.setting.cellPlugins;t&&t.length>0&&(this.cellPlugins=[],t.forEach((function(t){var n=t.bindingPath,r=t.plugins;if(r&&r.length>0)for(var o=0;o<r.length;o++){"cellGroupType"==r[o].type&&e.cellPlugins.push({bindingPath:n,type:"cellGroupType"})}})))}},{key:"_anslysisSetting",value:function(){this.setting&&(this._analysisTreeStructSetting(),this._analysisReferenceSetting(),this._analysisPluginSetting())}},{key:"_toUniqueKey",value:function(e,t){return`${e},${t}`}},{key:"_isLeaf",value:function(e){return e.hasOwnProperty("isLeaf")?e.isLeaf:!e.children||0==e.children.length}},{key:"_treeStructDataEnhance",value:function(e){for(var t=this,n=function(){var n=W(o[r],2),a=n[0],i=n[1],u=e[a];if(u&&u.length>0){var l=i.sumFields,s=i.idField,c=i.pidField,f=i.leafField,h=i.sortField,p=i.sortType,d=t.treeDataIndexMap[a]||{};u.forEach((function(e){var t=e[s],n={data:e,children:[]};f&&(n.isLeaf=!!e[f]),d[t]=n})),t.treeDataIndexMap[a]=d;var v={data:null,children:[]};if(u.forEach((function(e){var t=e[s],n=e[c],r=d[n];r=r||v;var o=d[t];r.children.push(o)})),l&&l.length>0){var g=function e(n){if(!t._isLeaf(n)){var r=n.children||[];r.forEach((function(t){return e(t)}));var o=n.data;l.forEach((function(e){var t=[];r.forEach((function(n){var r=n.data[e];isNaN(r)||t.push(r)}));var n=Ke(t);o[e]=n}))}};v.children.forEach((function(e){return g(e)}))}if(h){!function e(t){var n=t.children;(n=n.sort((function(e,t){var n=e.data,r=t.data,o=n[h]-r[h];return"asc"==p?o:0-o}))).forEach((function(t){return e(t)})),t.children=n}(v)}e[a]=function e(t){var n=[];return t.forEach((function(t){n.push(t.data);var r=t.children;r&&r.length>0&&(n=n.concat(e(r)))})),n}(v.children)}},r=0,o=Object.entries(this.treeStruct);r<o.length;r++)n()}},{key:"_unitDataByReferences",value:function(e,t){var n=this,r=[];if(this.references){var o={};this.references.forEach((function(a){var i=a.references,u=a.foreignKey,l=i.tableCode,s=i.fieldCode;t.push(l);var c=n._toUniqueKey(l,s),f=o[c];f||(f={},o[c]=f,e[l].forEach((function(e){f[e[s]]=e})));var h=u.tableCode;t.push(h);var p=u.fieldCode;e[h].forEach((function(e){r.push(A(A({},h,e),l,f[e[p]]))}))}))}return r}},{key:"_unitDataByIndex",value:function(e,t,n){for(var r=0,o=Object.entries(e);r<o.length;r++){var a=W(o[r],2),i=a[0],u=a[1];if(-1==n.indexOf(i))for(var l=0,s=u.length;l<s;l++){var c=u[l],f=t[l]||{};f[i]=c,t[l]=f}}return t}},{key:"_unitDataByGroup",value:function(e,t,n){var r=this;if(this.cellPlugins&&this.cellPlugins.length>0){for(var o=[],a={},i=[],u=function(){var e=W(s[l],2),t=e[0],n=e[1];"field"==n.type&&n.fields.forEach((function(e){r.cellPlugins.find((function(n){return n.bindingPath==`${t}.${e}`}))||i.push({tableCode:t,fieldCode:e})}))},l=0,s=Object.entries(this.datasources);l<s.length;l++)u();return t.forEach((function(e){var t=[],n=function(t,n){var r=e[t],o=null;return r&&(o=r[n]),o};r.cellPlugins.forEach((function(e){var r=W(e.bindingPath.split("."),2),o=r[0],a=r[1];t.push(n(o,a))})),i.forEach((function(e){var r=e.tableCode,o=e.fieldCode;t.push(n(r,o))}));var u=t.join("_@_#_$_%_^_&_*_(_)_");a[u]||(o.push(e),a[u]=!0)})),o}return t}},{key:"isTreeSumField",value:function(e,t){var n,r=this.treeStruct[e];return(null==r||null===(n=r.sumFields)||void 0===n?void 0:n.length)>0&&-1!=r.sumFields.indexOf(t)}},{key:"getLeafRanges",value:function(e,t,n){for(var r=this.treeDataIndexMap[e],o=[],a=this.setting.treeStruct[e].idField,i=t;i<=n;i++){var u=this.datas[i];if(u&&u[e]){var l=r[u[e][a]];this._isLeaf(l)&&o.push(i)}}return o}},{key:"load",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),n=[];this._treeStructDataEnhance(t);var r=this._unitDataByReferences(t,n);r=this._unitDataByIndex(t,r,n),this.datas=this._unitDataByGroup(t,r,n)}},{key:"getCount",value:function(){return this.datas.length}},{key:"getValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.datas[n],o=null;if(r){var a,i=null===(a=r[e])||void 0===a?void 0:a[t];o=void 0===i?null:i}return{type:"text",value:o}}},{key:"getFieldValues",value:function(e,t){for(var n=[],r=this.getCount(),o=0;o<r;)n.push(this.getValue(e,t,o)),o++;return n}},{key:"getLeafFieldValues",value:function(e,t){var n=this.setting.treeStruct[e];if(n&&n.idField&&n.pidField){for(var r=[],o=this.treeDataIndexMap[e],a=n.idField,i=this.getCount(),u=0;u<i;u++){var l=this.datas[u];if(l&&l[e]){var s=o[l[e][a]];if(this._isLeaf(s)){var c=s.data,f=c?c[t]:null;r.push({value:f})}}}return r}return this.getFieldValues(e,t)}}]),e}();function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){var r=1;e.columnMerge&&e.rowMerge?r=4:e.rowMerge&&(r=2);var o={row:e.row-n,col:e.col,rowCount:null==e?void 0:e.rowCount,colCount:null==e?void 0:e.colCount};t.push({range:o,direction:r,mode:0,sheetArea:3,selectionMode:1})}function ct(e){return JSON.parse(JSON.stringify(e))}var ft=function(){function e(t){p(this,e);var n=t.reportJson,r=t.datas,o=t.tempConfig,a=void 0===o?{}:o,i=t.setting;for(this.datas=r,this.reportJson=n,this.tempConfig=ct(a),this.setting=i,this.delayPlugins=[],this.delayFormula=[],this.sheetPages={},this.printConversionUnits=function(){var e="wd2mn37k18jf19j8yw1q8d4pt2jpzx35xlw8nzjbj",t=document.getElementById(e);t||((t=document.createElement("div")).id=e,document.body.append(t)),t.style.width="1in";var n=getComputedStyle(t).width;return Number(n.slice(0,-2))}(),this.parse();this.delayPlugins.length;){this.delayPlugins.pop()()}for(;this.delayFormula.length;){this.delayFormula.pop()()}}return y(e,[{key:"render",value:function(e,t){var n=t.header,r=t.footer,o=t.content;if(e.pageArea){let t=function(t,n,r,o){var a=t.height,i=n.height,u=r.height,l=a+i,s=e.pageTotalHeight;if(l>e.pageTotalHeight){var c=l%e.pageTotalHeight;c>=u&&(s=c)}else if(l<e.pageTotalHeight){var f=e.pageTotalHeight-l;f>=u&&(s=f)}var h=Math.floor(s/u);return{pageSubtotal:Math.ceil(o/h),lastContentTempCount:o%h,contentTempCount:h}};var a=0,i=0,u=n[3].template,l=r[3].template,s=o[3].template,c=t(n[3],r[3],o[3],o[3].template[0].unionDatasource.getCount()),f=c.pageSubtotal,h=c.lastContentTempCount,p=c.contentTempCount;for(f=f||1;a<f;){var d={sheet:e.sheet,spans:[],rows:[],rules:[],dataTable:{},autoMergeRanges:[],rowCount:0},v=a+1>=f;if(v){var g=t(n[2],r[2],o[2],h),y=g.pageSubtotal,m=g.lastContentTempCount,w=g.contentTempCount;if(y<=1)if(e.isLastGroup){var b=t(n[1],r[1],o[1],m),C=b.pageSubtotal,S=b.lastContentTempCount,O=b.contentTempCount;C<=1?(u=n[1].template,l=r[1].template,h=S,p=O):f+=1}else u=n[2].template,l=r[2].template,h=m,p=w;else f+=1}this.genPageDataTables({templates:u,pageInfos:e,sheetPage:d});var E=i+p;v&&!e.isFillData&&(E=i+h),this.genPageDataTables({templates:s,pageInfos:e,startIndex:i,endIndex:E,sheetPage:d}),this.genPageDataTables({templates:l,pageInfos:e,sheetPage:d}),a+1<f&&this.onAfterPage(e),e.pageHeight=0,i+=p,a++,this.sheetPages[e.sheet.name].datas.push(d)}}else this.genPageDataTables({templates:n[1].template,pageInfos:e})}},{key:"genPageInfos",value:function(e){var t,n,r,o=e.sheet,a=o.name,i=o.data,u=o.printInfo,l=u.paperSize,s=l.height,c=void 0===s?1100:s,f=l.width,h=void 0===f?850:f,p=u.orientation,d=u.margin,v=void 0===d?{bottom:75,top:75}:d,g=o.colHeaderVisible,y=void 0===g||g,m=o.colHeaderRowInfos,w=void 0===m?[]:m,b=null===(t=this.tempConfig)||void 0===t?void 0:t[a],C=!1,S=null==i||null===(n=i.defaultDataNode)||void 0===n?void 0:n.tag,O={};if(S){var E=JSON.parse(S);C=null==E?void 0:E.isFillData,O=E}var A=v.bottom,k=v.top,P=0,x=this.printConversionUnits,T=x*(h||850)/100,M=x*(c||1100)/100;A=x*A/100,k=x*k/100;var j=20;w.length>0&&(j=w.reduce((function(e,t){var n=20;return t.hasOwnProperty("size")&&(n=t.size),e+n}),0));var R=y?j:0;P=2===p?T-A-k-R:M-A-k-R;var I=!!b;return{spans:[],rows:[],rules:[],dataTable:{},autoMergeRanges:[],rowCount:0,pageIndex:1,pageTotal:1,pageArea:null===(r=O)||void 0===r?void 0:r.pageArea,pageTotalHeight:P,pageHeight:0,isFillData:C,isCurrentSheet:null==b?void 0:b.isCurrentSheet,isTemplate:I,page:{}}}},{key:"parse",value:function(){var e=this,t=Object.values(this.reportJson.sheets);this.sheetNames=[],t.forEach((function(t){var n,r=t.visible,o=void 0===r?1:r,a=t.rowCount,i=void 0===a?200:a,u=t.data,l=t.name;if(0!==o){var s=[],c=[],f=[],h=null==u||null===(n=u.defaultDataNode)||void 0===n?void 0:n.tag,p={};if(h)p=JSON.parse(h);var d=/^\d+:\d+$/,v=p,g=v.pageArea,y=void 0===g?"":g,m=v.groupSumArea,w=void 0===m?"":m,b=v.totalArea,C=void 0===b?"":b,S=i,O=i;if(y&&d.test(y)){var E=y.split(":");S=Number(E[0])-1,O=Number(E[1])}var k=i,P=i;if(w&&d.test(w)){var x=w.split(":");k=Number(x[0])-1,P=Number(x[1])}var T=i,M=i;if(C&&d.test(C)){var j=C.split(":");T=Number(j[0])-1,M=Number(j[1])}var R=null,I=0;do{var D,N,F,V=e.parseRowDataTable({row:I,sheet:t});if(I>=k&&I<P&&(V.isGroupSumArea=!0),I>=T&&I<M&&(V.isTotalArea=!0),R&&I<R.endRow)R.height+=V.height,(D=R.dataTables).push.apply(D,U(V.dataTables)),V.endRow>R.endRow&&(R.endRow=V.endRow,R.rowCount=R.endRow-R.row),R.datas=lt(lt({},R.datas),V.datas),R.allDatas=lt(lt({},R.allDatas),V.allDatas),V.isGroupSumArea&&(R.isGroupSumArea=V.isGroupSumArea),(N=R.dataPath).push.apply(N,U(V.dataPath)),(F=R.cellPlugins).push.apply(F,U(V.cellPlugins)),R.tableCodes=lt(lt({},R.tableCodes),V.tableCodes);else R=V;I>=S&&I<O&&(R.endRow=O,R.rowCount=R.endRow-R.row),I+1===R.endRow&&(R.verticalAutoMergeRanges=[],R.dataTables.forEach((function(e){var t=e.mergeInfos,n=void 0===t?[]:t,r=n.length;if(r>0){for(var o=[],a=n[0],i=1;i<r;i++){var u=n[i];a.row===u.row&&a.rowCount===u.rowCount&&a.columnMerge===u.columnMerge&&a.rowMerge===u.rowMerge&&a.col+a.colCount===u.col?a.colCount+=u.colCount:(st(a,o,R.row),a=u)}st(a,o,R.row),e.autoMergeRanges=[],o.filter((function(t){t.range.rowCount===R.rowCount?R.verticalAutoMergeRanges.push(t):t.range.colCount>1&&e.autoMergeRanges.push(t)}))}})),R.row<S?s.push(R):R.row>=O?c.push(R):f.push(R),R=null),I++}while(I<i);var H=e.tempConfig[l],L=[l],G={},B="";if(H){var W=e.groupDatas(H);G=W.sheetDatas,L=W.groupNames,B=W.tableCode}var J=e.genPageInfos({sheet:t});J.tableCode=B,J.sheet=t;var z=e.splitTemplate({headerTemplates:s,footerTemplates:c,contentTemplates:f}),Q=L.length;e.sheetPages[l]={pageIndex:0,datas:[]},J.unionDatasourceDatas={},L.forEach((function(t,n){J.groupName=t,J.isLastGroup=Q===n+1,G[t]&&(J.groupDatas=G[t],e.dataSourceMap.forEach((function(e){var n=e.tableCode,r=e.datas,o=e.unionDatasource;if(n===J.tableCode){var a=lt(lt({},r),{},A({},n,J.groupDatas));J.unionDatasourceDatas[t]=a,o.load(a)}}))),n>0&&e.onAfterPage(J),e.render(J,z)})),e.resetSheet(J)}}))}},{key:"parseRowDataTable",value:function(e){var t,n,r=this,o=e.row,a=e.sheet,i=a.spans,u=void 0===i?[]:i,l=a.data,s=void 0===l?{}:l,c=a.rows,f=void 0===c?{}:c,h=a.conditionalFormats,p=void 0===h?{}:h,d=(null==p?void 0:p.rules)||[],v=(null==s?void 0:s.dataTable)||{},g=(null==v?void 0:v[o])||{},y=function(e){var t=e.rules,n=e.row,r=t;return Number.isFinite(n)&&n>=0&&(r=t.filter((function(e){return e.ranges.some((function(e){var t=e.row,r=e.rowCount;return t<=n&&n<t+r}))}))||[]),r}({rules:d,row:o}),m={spans:[],mergeInfos:[],rules:[],rows:null,rowDataTable:g},w={row:o,endRow:o+1,rowCount:1,datas:{},allDatas:{},dataTables:[m],dataLen:0,height:0,isGroupSumArea:!1,isTotalArea:!1,dataPath:[],cellPlugins:[],tableCodes:{}},b=1,C=u.filter((function(e){return e.row===o&&(e.rowCount>b&&(b=e.rowCount),!0)}));return(t=m.spans).push.apply(t,U(C)),m.rows=function(e,t){return(null==e?void 0:e[t])||{size:20}}(f,o),w.height=null==m||null===(n=m.rows)||void 0===n?void 0:n.size,Object.entries(g).forEach((function(e){var t,n=W(e,2),a=n[0],i=n[1],u=i.bindingPath,l=i.tag,s=i.formula,c=i.style,f=void 0===c?{}:c,h=Number(a);if(null==u||null===(t=u.includes)||void 0===t?void 0:t.call(u,".")){w.dataPath.push(u);var p=u.split(".")[0];w.tableCodes[p]=!0,w.datas[p]=r.datas[p]||[],w.allDatas[p]=r.datas[p]||[];var d=C.find((function(e){return e.col===h}))||{rowCount:1,colCount:1};if(l){var v=JSON.parse(l),g=v.columnMerge||!1,b=v.rowMerge||!1;(g||b)&&m.mergeInfos.push(lt(lt({},d),{},{row:o,col:h,columnMerge:g,rowMerge:b}));var S=v.plugins;Array.isArray(S)&&w.cellPlugins.push({plugins:S,bindingPath:u})}}if(s){var O=ot(s);Array.isArray(O)&&O.forEach((function(e){w.tableCodes[e]=!0,w.datas[e]=r.datas[e]||[],w.allDatas[e]=r.datas[e]||[]}))}null!=f&&f.decoration&&(null==f||delete f.decoration),function(e){var t=e.rules,n=e.col,r=e.colHandler,o=t;Number.isFinite(n)&&n>=0&&(o=o.filter((function(e){var t=e.ranges.some((function(e){var t=e.col,r=e.colCount;return t<=n&&n<t+r}));return t&&"function"==typeof r&&r(ct(e)),t})))}({rules:y,col:h,colHandler(e){m.rules.push(lt({},e))}})})),w.rowCount=b,w.endRow=w.row+b,w}},{key:"groupDatas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.datas,n=e.groups;if(n){var r={},o=new Set,a="";return Object.entries(n).some((function(e){var n=W(e,2),i=n[0],u=n[1];if(Array.isArray(null==t?void 0:t[i])&&Array.isArray(u)&&u.length){var l;a=i;var s=null==u||null===(l=u[0])||void 0===l?void 0:l.code;return null==t||t[i].forEach((function(e){var t=e[s];o.add(t),r[t]=r[t]||[],r[t].push(e)})),!0}return!1})),e.groupNames=U(o),e.tableCode=a,{sheetDatas:r,groupNames:e.groupNames,tableCode:a}}}},{key:"splitTemplate",value:function(e){var t=this,n=e.headerTemplates,r=e.footerTemplates,o=e.contentTemplates,a=[],i={header:{1:{template:n,height:0,allTableCodes:{}},2:{template:[],height:0,allTableCodes:{}},3:{template:[],height:0,allTableCodes:{}}},footer:{1:{template:r,height:0,allTableCodes:{}},2:{template:[],height:0,allTableCodes:{}},3:{template:[],height:0,allTableCodes:{}}},content:{1:{template:o,height:0,allTableCodes:{}},2:{template:[],height:0,allTableCodes:{}},3:{template:[],height:0,allTableCodes:{}},dataLen:0}};return[{type:"header",template:n},{type:"footer",template:r},{type:"content",template:o}].forEach((function(e){var n=e.type;e.template.forEach((function(e){var r=e.tableCodes,o=e.datas,u=e.allDatas,l=e.dataTables,s=e.dataPath,c=e.cellPlugins,f=lt(lt({},t.setting),{},{cellPlugins:c}),h=new it(s,f);h.load(o),Object.keys(o).forEach((function(e){a.push({tableCode:e,datas:o,unionDatasource:h})})),e.unionDatasource=h;var p=new it(s,f);p.load(u),e.unionDatasourceAll=p;for(var d=0,v="content"===n?1:h.getCount()||1,g=0;g<v;g++)l.forEach((function(e){var t=e.rows,n=void 0===t?{}:t;n.hasOwnProperty("size")?d+=null==n?void 0:n.size:d+=20}));var y=1;"content"===n&&(i[n].dataLen=h.getCount()||1),i[n][y].allTableCodes=lt(lt({},i[n][y].allTableCodes),{},{tableCodes:r}),i[n][y].height+=d,y+=1,e.isTotalArea||(i[n][y].template.push(e),i[n][y].allTableCodes=lt(lt({},i[n][y].allTableCodes),{},{tableCodes:r}),i[n][y].height+=d,y+=1,e.isGroupSumArea||(i[n][y].template.push(e),i[n][y].allTableCodes=lt(lt({},i[n][y].allTableCodes),{},{tableCodes:r}),i[n][y].height+=d))}))})),this.dataSourceMap=a,i}},{key:"genPageDataTables",value:function(e){var t=this,n=e.templates,r=e.pageInfos,o=e.startIndex,a=void 0===o?0:o,i=e.endIndex,u=void 0===i?0:i,l=e.sheetPage;n.forEach((function(e){var n=e.dataTables,o=e.height,i=e.isGroupSumArea,s=e.isTotalArea,c=e.unionDatasource,f=e.unionDatasourceAll,h=e.verticalAutoMergeRanges,p=u||c.getCount()||1;(h=ct(h)).forEach((function(e){e.range.row=r.rowCount}));for(var d=r.page,v=r.rowCount,g=a,y=function(e){r.pageArea&&(r.pageHeight+o>r.pageTotalHeight?(v=r.rowCount,g=e,t.onAfterPage(r,o)):r.pageHeight+=o),n.forEach((function(n){var o=n.rows,a=void 0===o?{}:o,u=n.rowDataTable,h=n.spans,p=void 0===h?[]:h,y=n.rules,m=void 0===y?[]:y,w=n.autoMergeRanges,b=void 0===w?[]:w,C=lt({},u);if(Object.entries(C).forEach((function(n){var o,a=W(n,2),u=a[0],l=lt({},a[1]);C[u]=l;var h=Number(u),p=l.bindingPath,y=l.tag,m=l.formula;if(null!=p&&null!==(o=p.includes)&&void 0!==o&&o.call(p,".")){var w=W(p.split("."),2),b=w[0],S=w[1];delete l.bindingPath;var O=c.getValue(b,S,e),E=O.type,A=O.value;"text"===E&&(l.value=A)}var k=new Ge,P=r.groupName;if(k.setGroupNameHandler((function(){return P})),k.setIsGroupSumAreaHandler((function(){return i||s})),y){var x=JSON.parse(y),T=x.instanceId;d[r.pageIndex]=d[r.pageIndex]||{},d[r.pageIndex][T]=d[r.pageIndex][T]||{};var M=d[r.pageIndex][T];M.row=v,M.col=h,M.count=M.count||0,M.count+=1,M.dataIndex=g,M.unionDatasource=c,M.unionDatasourceAll=f;var j=x.hyperlinkInfo||{};"document"===(null==j?void 0:j.type)&&null!=j&&j.isAutoDoc&&(l.hyperlink.url=`sjs://${l.value}!A1`,l.hyperlink.tooltip&&(l.hyperlink.tooltip=l.value));var R=x.plugins;if(Array.isArray(R)){let e=function(){var e,t=null==d||null===(e=d[N])||void 0===e?void 0:e[I];k.setFieldIndexHandler((function(){return{row:null==t?void 0:t.row,col:null==t?void 0:t.col}})),k.setDataCountHandler((function(){return null==t?void 0:t.count})),k.setDataIndex((function(){return null==t?void 0:t.dataIndex})),k.setUnionDatasourceHandler((function(){if(s)return null==t?void 0:t.unionDatasourceAll;var e=null==t?void 0:t.unionDatasource,n=r.unionDatasourceDatas[F];return n&&e.load(n),e}));var n=function(e,t,n){return nt(e,t,n)}({type:"text",value:l.value},R,k),o=n.type,a=n.value;l["formula"===o?o:"value"]=a};var I="",D=R.some((function(e){var t=e.type,n=e.config;return"cellSubTotal"===t&&(I=null==n?void 0:n.instanceId),["cellSubTotal"].includes(t)})),N=r.pageIndex,F=r.groupName;D?t.delayPlugins.push(e):e()}}var V,H=r.pageIndex,L=(V=H,function(){return V});if(m){t.delayFormula.push((function(){k.setPageHandler(L),k.setTotalPagesHandler((function(){return r.pageTotal})),k.setValueHandler((function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return 1===r.length?{type:"text",value:t.datas[r[0]]}:c.getValue(r[0],r[1],e)}));var n=rt({type:"formula",value:m},k),o=n.type,a=n.value;l["formula"===o?o:"value"]=a}))}})),r){var S=r.rowCount;r.dataTable[S]=C;var O=0;l&&(O=l.rowCount,l.dataTable[O]=C),p.forEach((function(e){r.spans.push(lt(lt({},e),{},{row:S})),l&&l.spans.push(lt(lt({},e),{},{row:O}))})),m.forEach((function(e){r.rules.push(lt(lt({},e),{},{ranges:[lt(lt({},e.ranges[0]),{},{row:S})]})),l&&l.rules.push(lt(lt({},e),{},{ranges:[lt(lt({},e.ranges[0]),{},{row:O})]}))})),r.rows[S]=lt(lt({},r.rows[S]||{}),a),l&&(l.rows[O]=lt(lt({},r.rows[O]||{}),a)),b.forEach((function(e){var t=ct(e);t.range.row=S,r.autoMergeRanges.push(t),l&&l.autoMergeRanges.push(t)})),r.rowCount+=1,l&&(l.rowCount+=1)}}))},m=a;m<p;m++)y(m);h.forEach((function(e){e.range.rowCount=r.rowCount-e.range.row,r.autoMergeRanges.push(e)}))}))}},{key:"onAfterPage",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.rowCount,o=(null===(t=e.rows)||void 0===t?void 0:t[r])||{};o.pageBreak=!0,e.rows[r]=o,e.pageHeight=n,e.pageIndex+=1,e.pageTotal+=1}},{key:"resetSheet",value:function(e){var t,n=e.sheet,r=e.dataTable,o=e.rules,a=e.spans,i=e.rows,u=e.rowCount,l=e.autoMergeRanges;if(n){var s=u>0?u:n.rowCount;n.data.dataTable=r,n.rowCount=s,n.conditionalFormats=n.conditionalFormats?n.conditionalFormats:{},n.conditionalFormats.rules=o,n.spans=a,n.rows?n.rows.length=0:n.rows=[],(t=n.rows).push.apply(t,U(i)),n.autoMergeRangeInfos=l}}}]),e}(),ht=null,pt=function(){var e,t=r();try{(new t.Spread.Sheets.Workbook).getSheet(0).setValue(0,0,"test")}catch(n){return{success:!1,showError:!0}}return e=location.hostname,/^(127\.0\.0\.1|localhost)/g.test(e)?{success:!1,showWarn:!0}:{success:!0}};function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gt=r().Spread.Sheets;function yt(e,t,n,r){if(!e)return{datas:[],spansTree:[]};var o=t.map((function(e){return e.code})),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.length>0?function e(t,n){var r=U(n),o=new Map,a=r.shift();return t.forEach((function(e){var t=e[a];o.has(t)||o.set(t,{groupName:t,groupCode:a,allChildrens:[]}),o.get(t).allChildrens.push(e)})),o.forEach((function(t){r.length>0&&t.allChildrens.length>0&&(t.childrenGroups=e(t.allChildrens,r))})),o}(e,t):void 0;return new Map([["总",{groupName:"总",groupCode:null,allChildrens:U(e),childrenGroups:n}]])}(e,o),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).map((function(e){return e.code})),a=o.length>0,i=n.filter((function(e){var n=e.code;return!t.includes(n)&&!o.includes(n)})),u=i.length,l=function e(n){var l=null,s=0,c=[];return n.forEach((function(n,f,h){var p={children:[],verticalSpans:[]},d=n.childrenGroups,v=n.allChildrens,g=n.groupCode,y=n.groupName,m=0,w=t.indexOf(g);if(d){var b,C=e(d);l=C.lastChild,m+=C.totalRowCount,s+=C.totalRowCount,(b=p.children).push.apply(b,U(C.spansTree))}else v.forEach((function(e){l=e;var n=[];if(a){var c={};t.forEach((function(t){c[t]=e[t]}));for(var f=function(){var t=i[h].code;c[t]=e[t];var r=i[h+1].code,a=vt(vt({},c),{},A({},r,"小计"));o.forEach((function(t){var n=Number(e[t]);e[t]=Number.isNaN(n)?0:n,Object.defineProperty(a,t,{get:()=>e[t]})})),n.unshift(a),p.verticalSpans[h]||(p.verticalSpans[h]=[]),p.verticalSpans[h].push({rowCount:u-h,col:w+h+1,colCount:1,row:0,subtotalSpan:{rowCount:1,col:w+h+1+1,colCount:u-h-1,row:0},style:{vAlign:1}}),m++,s++},h=0;h<u-1;h++)f()}m++,s++,r.push.apply(r,[e].concat(n))}));var S={};if(g){if(a){var O=t.indexOf(g);t.forEach((function(e,t){t<=O&&(S[e]=l[e])}));var E=t[O+1];O+1===t.length&&(E=i[0].code),S[g]=y,S[E]="小计",p.subtotalSpan={row:0,col:O+1,rowCount:1,colCount:u+(t.length-O)-1},m++,s++}var k={rowCount:m,col:w,colCount:1,row:0,style:{vAlign:1}};p=vt(vt({},p),k)}else a&&(S[t[0]||(null==i?void 0:i[0].code)]="小计",p=vt(vt({},p),{},{row:s,rowCount:1,col:0,colCount:t.length+u,isTotal:!0}));a&&(o.forEach((function(e){Object.defineProperty(S,e,{get:()=>v.reduce((function(t,n){return t+n[e]}),0)})})),r.push(S)),c.push(p)})),{lastChild:l,totalRowCount:s,spansTree:c}}(e),s=l.spansTree;return{datas:r,spansTree:s}}(a,o,n,r);return{datas:i.datas,spansTree:i.spansTree}}var mt=r().Spread.Sheets,wt=ce({position:"relative",width:"100%",height:"100%",overflow:"visible",userSelect:"none"}),bt=function(e,t,n){if(n){var o=r().Spread.Sheets.Events[t];e.bind(o,n)}},Ct=function(e){var t=e.spread,n=e.dataSource,r=e.sumColumns,o=e.groupColumns,a=e.rowMerge,i=e.columnMerge,u=e.rowMergeColumns,l=void 0===u?{}:u,s=e.colMergeColumns,c=void 0===s?{}:s;t&&t.sheets.forEach((function(e){var t,u=JSON.parse(JSON.stringify(n)),s=e.tables.all(),f=[],h=[],p=null;u&&(p=new mt.Bindings.CellBindingSource(u),e.setDataSource(p)),s.length>0&&s.forEach((function(e){var t=e.name(),n=o[t],a=r[t],i=l[t]||[],s=c[t]||[];if(Array.isArray(n)&&n.length>0||Array.isArray(a)&&a.length>0){var p=e.bindingPath(),d=e.range(),v=d.row,g=d.col,y=[];if(e.BSt.forEach((function(e){y.push({code:e.dataField()})})),null!=u&&u[p]){var m=yt(u[p],n,y,a),w=m.datas,b=m.spansTree;u[p]=w;var C=function(e){var t=[],n={};return function e(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=o;r.forEach((function(r){var u=r.row,l=void 0===u?0:u,s=r.col,c=void 0===s?0:s,f=r.rowCount,h=void 0===f?1:f,p=r.colCount,d=void 0===p?1:p,v=r.children,g=void 0===v?[]:v,y=r.verticalSpans,m=void 0===y?[]:y,w=r.subtotalSpan,b=r.isTotal,C=void 0!==b&&b;if(g.length>0&&e(g,i),m.length>0&&m.forEach((function(e,r){var o=i;e.forEach((function(e){if(e.hasOwnProperty("style")){var i=e.col,u=e.style;n[o]||(n[o]={}),n[o][i]||(n[o][i]={}),n[o][i].style=vt({},u)}t.push({row:o,col:e.col+a,rowCount:e.rowCount,colCount:e.colCount}),e.subtotalSpan.colCount>1&&t.push({row:o+e.rowCount-1,col:e.subtotalSpan.col+a,rowCount:e.subtotalSpan.rowCount,colCount:e.subtotalSpan.colCount}),o+=e.rowCount+r}))})),r.hasOwnProperty("style")){var S=r.col,O=r.style;n[i]||(n[i]={}),n[i][S]||(n[i][S]={}),n[i][S].style=vt({},O)}r.hasOwnProperty("row")&&((h>1||d>1)&&(C?t.push({row:l+o,col:c+a,rowCount:h,colCount:d}):t.push({row:i,col:c+a,rowCount:h,colCount:d})),w&&t.push({row:i+h-1,col:w.col+a,rowCount:w.rowCount,colCount:w.colCount}),i+=h)}))}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),{spans:t,dataTableStyle:n}}(b,v+1,g);f.push.apply(f,U(C.spans))}}if(i.length>0||s>0){var S=e.BSt.map((function(e){return{id:e.id(),code:e.dataField(),name:e.name()}})),O=e.range(),E=function(e){var t=e.rowMergeColumns,n=e.colMergeColumns,r=e.tableColumns,o=e.row,a=void 0===o?0:o;e.col;var i=e.rowCount,u=void 0===i?0:i,l=[];if(t.length||n.length){var s=t.map((function(e){return vt(vt({},e),{},{rowMerge:!0,colMerge:!1})}));n.forEach((function(e){var t=s.find((function(t){return t.code===(null==e?void 0:e.code)}));t?t.colMerge=!0:s.push(vt(vt({},e),{},{rowMerge:!1,colMerge:!0}))})),s.sort((function(e,t){return r.findIndex((function(t){return t.code===e.code}))-r.findIndex((function(e){return e.code===t.code}))}));var c=s[0],f=c.rowMerge,h=c.colMerge,p=gt.AutoMerge.AutoMergeDirection.column,d=gt.AutoMerge.AutoMergeMode.free,v=gt.SheetArea.viewport,g=gt.AutoMerge.SelectionMode.merged;f&&h?p=gt.AutoMerge.AutoMergeDirection.rowColumn:f&&(p=gt.AutoMerge.AutoMergeDirection.row);var y={row:a,col:-1,rowCount:u,colCount:1},m=-1;s.forEach((function(e){var t=e.code,n=e.rowMerge,o=e.colMerge,a=r.findIndex((function(e){return e.code===t}));-1===y.col?y.col=a:m+1===a&&f===n?y.colCount+=1:(l.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g}),f=n,y={row:1,col:a,rowCount:u+1,colCount:1},p=gt.AutoMerge.AutoMergeDirection.column,n&&o?p=gt.AutoMerge.AutoMergeDirection.rowColumn:n&&(p=gt.AutoMerge.AutoMergeDirection.row)),m=a})),(l.length>0&&l[l.length-1]!==y&&y.col>-1||l.length<=0&&y.col>-1)&&l.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g})}return l}({rowMergeColumns:i,colMergeColumns:s,tableColumns:S,row:O.row+1,rowCount:O.rowCount});h.push.apply(h,U(E))}}));var d=e.toJSON();d.spans=Array.isArray(d.spans)?d.spans:[],(t=d.spans).push.apply(t,f),d.autoMergeRangeInfos=h,e.fromJSON(d),p&&e.setDataSource(p),function(e){var t=e.sheet,n=e.rowMerge,r=e.columnMerge,o=t.tables.all();if(o.length>0&&(n||r)){var a=mt.AutoMerge.AutoMergeDirection.column,i=mt.AutoMerge.AutoMergeMode.free,u=mt.SheetArea.viewport,l=mt.AutoMerge.SelectionMode.merged;n&&r?a=mt.AutoMerge.AutoMergeDirection.rowColumn:n&&(a=mt.AutoMerge.AutoMergeDirection.row),t.suspendPaint(),o.forEach((function(e){var n=e.range();t.autoMerge(n,a,i,u,l)})),t.resumePaint()}}({sheet:e,rowMerge:a,columnMerge:i})}))};function St(t){var a=t.newTabVisible,u=void 0===a||a,l=t.tabEditable,s=void 0===l||l,c=t.tabStripVisible,f=void 0===c||c,h=t.onInited,p=t.onEnterCell,d=t.onActiveSheetChanged,v=t.onValueChanged,g=t.onSelectionChanged,y=t.onSelectionChanging,m=t.onEditorStatusChanged,w=t.onSheetNameChanged,b=t.onSheetNameChanging,C=t.onActiveSheetChanging,S=t.onPageCompleted,O=t.onSheetChanged;t.onFetchData;var E=t.onRowChanged,A=t.onUndo,k=t.onRedo,x=t.license,T=t.enablePrint,M=void 0!==T&&T,j=t.json,R=void 0===j?null:j,I=t.onPrintHandler,N=t.children,F=t.baseUrl,H=t.dataSource,L=void 0===H?null:H,G=t.sumColumns,B=void 0===G?[]:G,U=t.groupColumns,J=void 0===U?[]:U,z=t.rowMerge,Q=void 0!==z&&z,Y=t.columnMerge,_=void 0!==Y&&Y,X=t.rowMergeColumns,K=void 0===X?{}:X,q=t.colMergeColumns,$=void 0===q?{}:q,ee=t.template,te=t.setting,re=t.onColumnWidthChanged,oe=t.onRowHeightChanged,ae=t.onLeftColumnChanged,ie=t.onTopRowChanged,ue=t.onViewZoomed;x&&function(e){ht=e}(x),F&&(n=F);var le=r(),se=ht||"593811994558535#B1dWhJlMLFTUwpXTsV6L03kcLpmNkR5VklDTz9mdnh4SmJ6c98WU9QEVrNDO5kTNOpUb9B7d9l5NjlWWsxmU9hHNmVTb9p5dU5UZmRkZXJlR4d5MENkVat4RKNWZMVlcuNmbph6SxYTUyoVcFBFeIlTe5QFSYhjShpneohmVoZTVhdFdBJGOuFDMsVDW8RjZrB5aQlFbSZVS48UNr5mY62EZ4UWYTFGbxpWZVBVMo3iaCZVNrcmYxlDZzIkWmNVc5FVRCl5KFFDMvMmSjRUUKpkTRRTdV3GOHZVY5llY9IUez2kTalFShN6cjFEOXZEeuVHcWxmWZtWViojITJCLiEkMygjR5UjI0ICSiwCO7YTMxYjM6ATM0IicfJye#4Xfd5nIVF4SRJiOiMkIsIyNx8idgMlSgQWYlJHcTJiOi8kI1tlOiQmcQJCLigDNyADOwAiNxQDM4IDMyIiOiQncDJCLiEjLw8CMucjMxIiOiMXbEJCLig1jlzahlDZmpnInmz9unHZvnfLsonLvlb1kpfbtmD0jnLiOiEmTDJCLiUzM5gTN5QTO9ETM8MTO5IiOiQWSiwSfdtlOicGbmJCLlNHbhZmOiI7ckJye0ICbuFkI1pjIEJCLi4TP7pXe62iNw34KDl5RVpHO8dVW7UESQN7Zl3ycj36V4NzbGJENV5kTtJDdEVjQjFnbutyRVhleuV6ZFVkRZxUdQZmdJlFZHpXWmhWYTZGSIF6LUJjdhZTMjNVVltbcYR";se&&(le.Spread.Sheets.LicenseKey=se);var ce=W(e.useState((function(){var e=pt(),t=!1,n=!1;return e.success||(t=e.showError,n=e.showWarn),{spread:null,showError:t,showWarn:n}})),1)[0],fe=W(e.useState(0),2);fe[0],fe[1];var he=e.useRef(null),pe=e.useMemo((function(){var e=JSON.parse(JSON.stringify(R));if(e&&L){var t=new ft({reportJson:e,datas:L,tempConfig:ee,setting:te}),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=ce.spread.getActiveSheet(),r=n.toJSON(),o=t.sheetPages[r.name];o.pageIndex+=e,o.pageIndex<0&&(o.pageIndex=0),o.pageIndex>=o.datas.length&&(o.pageIndex=o.datas.length-1);var a=o.datas[o.pageIndex];a.sheet=r,t.resetSheet(a),n.fromJSON(r)};S&&S({lastPage:function(){n(-1)},nextPage:function(){n()}})}return{json:e}}),[R,L,JSON.stringify(ee),JSON.stringify(te)]),de=pe.json,ve=function(){var e=P(D.mark((function e(){var t,n,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!M){e.next=4;break}return t=i("print"),e.next=4,V.loadScript(t);case 4:if(ce.spread||!he.current||he.showError){e.next=9;break}return n=r(),o=new n.Spread.Sheets.Workbook(he.current,{sheetCount:0,newTabVisible:u,tabEditable:s,tabStripVisible:f}),ce.spread=o,e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){if(ce.spread){var e=ce.spread;e.unbindAll(),function(e,t){if(e&&t)for(var n=0,r=Object.entries(t);n<r.length;n++){var o=W(r[n],2),a=o[0],i=o[1];bt(e,a,i)}}(e,{EnterCell:p,ActiveSheetChanged:d,ValueChanged:v,ActiveSheetChanging:C,SheetNameChanged:w,SheetNameChanging:b,SelectionChanged:g,SelectionChanging:y,EditorStatusChanged:m,WorkbookUndo:A,WorkbookRedo:k,RowChanged:E,SheetChanged:O,ColumnWidthChanged:re,RowHeightChanged:oe,LeftColumnChanged:ae,TopRowChanged:ie,ViewZoomed:ue})}},be=function(e){if(ce.spread){var t=ce.spread;o(t,e?function(){t.fromJSON(e),Oe();var n=t.sheets;n&&n.length>0&&n.forEach((function(e){e.options.sheetAreaOffset={left:1,top:1},e.recalcAll(!0),O&&O("SheetChanged",{sheet:e})}))}:function(){var e;e=N?Array.isArray(N)?N:[N]:[],t.clearSheets();var n=r();e.forEach((function(e,r){var o=e.props,a=o.name,i=void 0===a?`Sheet${r+1}`:a,u=o.rowCount,l=void 0===u?20:u,s=o.colCount,c=void 0===s?20:s,f=new n.Spread.Sheets.Worksheet(i);f.options.sheetAreaOffset={left:1,top:1},f.setRowCount(l),f.setColumnCount(c),t.addSheet(r,f),O&&O("SheetChanged",{sheet:f})}))})}},Ce=function(){if(ce.spread){var e=ce.spread;L&&Ct({spread:e,dataSource:L,sumColumns:B,groupColumns:J,rowMerge:Q,columnMerge:_,rowMergeColumns:K,colMergeColumns:$})}},Se=function(){if(ce.spread){var e=ce.spread;I&&I((function(t){return new Promise((function(n,o){e?M?(e.sheets.forEach((function(e){!function(e,t){var n=t.orientation,o=t.printQuality,a=t.scaleType,i=t.fitPagesTall,u=t.fitPagesWide,l=t.zoomFactor,s=t.firstPageNumber,c=t.paperKind,f=t.margin,h=t.headerAndFooter,p=t.showGridLine,d=t.showHeader,v=t.blackAndWhite,g=t.pageOrder,y=t.showBorder,m=t.rowStart,w=t.rowEnd,b=t.columnStart,C=t.columnEnd,S=e.printInfo(),O=function(e,t){we(e)||("string"==typeof t?S[t](e):t(e))};O(n,"orientation"),O(o,"qualityFactor"),we(a)||(1==a?(i=-1,u=-1,l/=100):0==a&&(l=1),S.zoomFactor(l),S.fitPagesWide(u),S.fitPagesTall(i)),O(s,"firstPageNumber"),O(c,(function(){var e=new(r().Spread.Sheets.Print.PaperSize)(parseInt(c));S.paperSize(e)})),O(f,(function(){var e=f.left,t=f.right,n=f.top,o=f.bottom,a=f.header,i=f.footer,u=f.centering;S.margin({left:100*e,right:100*t,top:100*n,bottom:100*o,header:100*a,footer:100*i});var l=null,s=r();l=null!=u&&u.horizontally?null!=u&&u.vertically?s.Spread.Sheets.Print.PrintCentering.both:s.Spread.Sheets.Print.PrintCentering.horizontal:null!=u&&u.vertically?s.Spread.Sheets.Print.PrintCentering.vertical:s.Spread.Sheets.Print.PrintCentering.none,S.centering(l)})),O(null==h?void 0:h.pageHeaderFooter,"pageHeaderFooter"),O(p,"showGridLine"),O(d,(function(){var e=r(),t=d?e.Spread.Sheets.Print.PrintVisibilityType.show:e.Spread.Sheets.Print.PrintVisibilityType.hide;S.showRowHeader(t),S.showColumnHeader(t)})),O(v,"blackAndWhite"),O(g,"pageOrder"),O(y,"showBorder"),m=-1==m||we(m)?0:m,S.rowStart(m),w=-1==w||we(w)?e.getRowCount():w,S.rowEnd(w),b=-1==b||we(b)?0:b,S.columnStart(b),C=-1==C||we(C)?e.getColumnCount():C,S.columnEnd(C),S.repeatRowStart(-1),S.repeatRowEnd(-1),S.repeatColumnStart(-1),S.repeatColumnEnd(-1),e.printInfo(S)}(e,t||{})})),n(e)):o(Error("打印失败，原因：初始化报表时未开启打印功能")):o(Error("打印失败，原因：报表未初始化"))}))}))}},Oe=function(){var e=ce.spread;e.suspendEvent(),e.suspendCalcService(!1),ne(ce.spread),e.resumeEvent(),e.resumeCalcService(!0)};return e.useEffect((function(){P(D.mark((function e(){var t;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve();case 2:e.sent?(ye(),be(de),Ce(),Se(),h?(t=h(ce.spread))&&t.then&&t.then((function(e){be(e),Oe()})):Oe()):Oe();case 4:case"end":return e.stop()}}),e)})))()}),[de,L,p,d,v,C,w,b,g,y,m,A,k]),Z.jsxs(wt,{children:[ce.showError?Z.jsx(ge,{}):Z.jsx("div",{style:{width:"100%",height:"100%",overflow:"visible",userSelect:"none"},ref:he}),!ce.showError&&ce.showWarn?Z.jsx(me,{}):null]})}var Ot=["onInited","ready","dataSource"];function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kt=function(){function n(e){p(this,n),A(this,"conf",{}),A(this,"spread",null),A(this,"printHandler",null),this.conf=e}return y(n,[{key:"mount",value:function(n){var a,i,u,l,s,c,f,h=this;r().Spread.Common.CultureManager.culture("zh-cn");var p=this.conf||{},d=p.onInited,v=p.ready,g=p.dataSource,y=E(p,Ot),m=null===(a=this.conf)||void 0===a||null===(a=a.json)||void 0===a?void 0:a.reportJson;m&&(m=JSON.parse(JSON.stringify(m)));var w=(null===(i=this.conf)||void 0===i||null===(i=i.json)||void 0===i||null===(i=i.context)||void 0===i?void 0:i.tableDesignSlice)||{},b=w.rowMerge,C=w.columnMerge,S=((null===(u=this.conf)||void 0===u?void 0:u.event)||{}).onFetchData,A=(null===(l=this.conf)||void 0===l||null===(l=l.json)||void 0===l||null===(l=l.context)||void 0===l?void 0:l.datasourceSlice)||{},k=A.sumColumns,P=A.tableGroups,x=A.rowMergeColumns,T=void 0===x?{}:x,M=A.colMergeColumns,j=void 0===M?{}:M,R=null===(s=this.conf)||void 0===s||null===(s=s.json)||void 0===s||null===(s=s.context)||void 0===s||null===(s=s.wizardSlice)||void 0===s?void 0:s.template,I=null===(c=this.conf)||void 0===c||null===(c=c.json)||void 0===c?void 0:c.datasourceSetting;t.createRoot(n).render(e.createElement(St,At(At({onInited:function(e){h.spread=e,d&&d(e),"function"==typeof v&&o(e,(function(){v(new O(e))}))},onPrintHandler:function(e){h.printHandler=e},baseUrl:null===(f=this.conf)||void 0===f?void 0:f.baseUrl,onFetchData:S,rowMerge:b,columnMerge:C,sumColumns:k,groupColumns:P,rowMergeColumns:T,colMergeColumns:j,dataSource:g,template:R,setting:I},y),{},{json:m})))}},{key:"exportExcel",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreFormula:!1,ignoreStyle:!1};return new Promise((function(o,a){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".xlsx")?e:e+".xlsx",V.loadScript(i("excel")).then((function(){var i=new(r().Spread.Excel.IO),u=JSON.stringify(t.spread.toJSON());i.save(u,(function(t){L(t,e),o()}),(function(e){a(e)}),{columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeBindingSource:!1,includeCalcModelCache:!1,includeEmptyRegionCells:!0,includeFormulas:!n.ignoreFormula,includeStyles:!n.ignoreStyle,includeUnusedNames:!0,password:void 0,rowHeadersAsFrozenColumns:!1,saveAsView:!1})}))):a(Error("导出excel失败，原因:没有传递导出文件名"))}))}},{key:"exportPdf",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{persistence:!0,author:"",creator:"",keywords:"",subject:"",title:"",sheetIndex:null};return new Promise((function(o,a){t.printHandler().then((function(){if("string"==typeof e&&""!==e.trim()){e=e.endsWith(".pdf")?e:e+".pdf";var u=function(){var r=n.persistence,i=n.author,u=n.creator,l=n.keywords,s=n.subject,c=n.title,f=n.sheetIndex;t.spread.savePDF((function(t){r&&L(t,e),o(t)}),(function(e){a(e)}),{author:i,creator:u,keywords:l,subject:s,title:c},null==f?void 0:f)};r().Spread.Sheets.PDF?u():V.loadScript(i("pdf")).then(u)}else a(Error("导出pdf失败，原因:没有传递导出文件名"))})).catch(a)}))}},{key:"print",value:function(e){var t=this;return new Promise((function(n,r){t.printHandler?t.printHandler(e).then((function(){t.spread.print(),n()})).catch(r):r(Error("打印失败，原因：报表未初始化"))}))}}]),n}();return{FontStyle:{normal:"normal",italic:"italic"},FontWeight:{normal:"normal",bold:"bold"},HAlign:f,LineBorder:m,LineStyle:c,Preview:kt,VAlign:h,WorkBook:O,WorkSheet:S}}));
