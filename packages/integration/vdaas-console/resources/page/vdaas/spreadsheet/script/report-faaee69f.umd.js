!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom/client")):"function"==typeof define&&define.amd?define(["react","react-dom/client"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).TOONE=e.TOONE||{},e.TOONE.Report=t(e.React,e.ReactDOM))}(this,(function(e,t){"use strict";var n=".",r=function(){return window.GC},o=function(e,t){if(e){e.suspendPaint(),e.suspendEvent();var n=e.getActiveSheet();try{t(n)}finally{e.resumePaint(),e.resumeEvent()}}},a={print:["print.min.js"],pdf:["print.min.js","pdf.min.js"],excel:["excelio.min.js"]},i=function(e){return a[e].map((function(e){return s(e)}))};var u=function(){var e=r().Spread.Sheets.productInfo.productVersion;return`${n}/vendor/excel/${e}`},s=function(e){return`${u()}/plugins/${e}`},l=r(),c={dashed:l.Spread.Sheets.LineStyle.dashed,dotted:l.Spread.Sheets.LineStyle.dotted,double:l.Spread.Sheets.LineStyle.double,empty:l.Spread.Sheets.LineStyle.empty,thick:l.Spread.Sheets.LineStyle.thick,thin:l.Spread.Sheets.LineStyle.thin},f={center:l.Spread.Sheets.HorizontalAlign.center,left:l.Spread.Sheets.HorizontalAlign.left,right:l.Spread.Sheets.HorizontalAlign.right},h={center:l.Spread.Sheets.VerticalAlign.center,bottom:l.Spread.Sheets.VerticalAlign.bottom,top:l.Spread.Sheets.VerticalAlign.top};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function y(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var m=function(){function e(t,n){p(this,e),this.color=t,this.style=n}return y(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStyle",value:function(e){this.style=e}},{key:"getStyle",value:function(){return this.style}},{key:"_to",value:function(){return new(r().Spread.Sheets.LineBorder)(this.color,this.style)}}]),e}();document.createElement("span");var w=function(e,t){return null==e?t:e},b=function(e,t,n){var o=r(),a=n.fontWeight,i=n.fontStyle,u=n.fontFamily,s=n.fontSize,l=n.textDecoration,c=n.backColor,f=n.foreColor,h=n.wordWrap;!function(e,t,n){for(var r=e.col,o=e.row,a=e.rowCount,i=e.colCount,u=0;u<a;u++)for(var s=0;s<i;s++)n(t,o+u,r+s)}(t,e,(function(e,t,n){var r=new o.Spread.Sheets.Style,p=e.getStyle(t,n),d=function(e){var t="normal",n="normal",r="normal",o="Calibri";if(e)for(var a,i=e.split(/\s+/);a=i.shift();)switch(a){case"normal":break;case"italic":case"oblique":t=a;break;case"small-caps":n=a;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":r=a;break;default:o=a,i.length&&(o+=" "+i.join(" "))}return{fontStyle:t,fontVariant:n,fontWeight:r,fontSize:11,lineHeight:"normal",fontFamily:o}}(p.font);Object.assign(r,p),u=w(u,d.fontFamily),s=w(s,d.fontSize),i=w(i,d.fontStyle),a=w(a,d.fontWeight),l=w(l,p.textDecoration),c=w(c,p.backColor),f=w(f,p.foreColor);var v=function(e){return e&&-1===e.indexOf("'")&&-1===e.indexOf('"')?`"${e}"`:e}(u),g=function(e){var t=e.fontFamily,n=void 0===t?"":t,r=e.fontStyle,o=void 0===r?"":r,a=e.fontVariant,i=void 0===a?"":a,u=e.fontWeight,s=void 0===u?"":u,l=e.fontSize,c=void 0===l?"":l,f=e.lineHeight,h=[o,i,s,c,void 0===f?"":f,n].join(" "),p=document.createElement("span");return p.style.font=h,p.style.font}({fontFamily:v,fontSize:s?`${s}pt`:"",fontStyle:i,fontWeight:a});r.font=g,r.textDecoration=l,r.backColor=c,r.foreColor=f,r.wordWrap=h,e.setStyle(t,n,r)}))},S=function(){function e(t,n){p(this,e),this.sheet=t,this.cellRange=n}return y(e,[{key:"hAlign",value:function(e){this.cellRange.hAlign(e)}},{key:"vAlign",value:function(e){this.cellRange.vAlign(e)}},{key:"setBorder",value:function(e,t){this.cellRange.setBorder(e,t)}},{key:"fontFamily",value:function(e){b(this.sheet,this.cellRange,{fontFamily:e})}},{key:"fontSize",value:function(e){b(this.sheet,this.cellRange,{fontSize:e})}},{key:"fontStyle",value:function(e){b(this.sheet,this.cellRange,{fontStyle:e})}},{key:"fontWeight",value:function(e){b(this.sheet,this.cellRange,{fontWeight:e})}},{key:"wordWrap",value:function(e){b(this.sheet,this.cellRange,{wordWrap:e})}}]),e}(),C=function(){function e(t){p(this,e),this.sheet=t}return y(e,[{key:"name",value:function(e){this.sheet.name(e)}},{key:"getCell",value:function(e,t){var n=this.sheet.getCell(e,t);return new S(this.sheet,n)}},{key:"getRange",value:function(e,t,n,r){var o=this.sheet.getRange(e,t,n,r);return new S(this.sheet,o)}},{key:"addSpan",value:function(e,t,n,r){this.sheet.addSpan(e,t,n,r)}},{key:"addRows",value:function(e,t){this.sheet.addRows(e,t)}},{key:"addColumns",value:function(e,t){this.sheet.addColumns(e,t)}},{key:"setValue",value:function(e,t,n){this.sheet.setValue(e,t,n)}},{key:"setFormula",value:function(e,t,n){this.sheet.setFormula(e,t,n)}},{key:"setRowCount",value:function(e){this.sheet.setRowCount(e)}},{key:"setRowHeight",value:function(e,t){this.sheet.setRowHeight(e,t)}},{key:"setColumnCount",value:function(e){this.sheet.setColumnCount(e)}},{key:"setColumnWidth",value:function(e,t){this.sheet.setColumnWidth(e,t)}},{key:"setDefaults",value:function(e){Object.assign(this.sheet.defaults,e)}},{key:"setOptions",value:function(e){var t=e.colHeaderVisible,n=void 0===t||t,r=e.rowHeaderVisible,o=void 0===r||r,a=e.showHorizontalGridline,i=void 0===a||a,u=e.showVerticalGridline,s=void 0===u||u,l=e.isProtected,c=void 0!==l&&l;Object.assign(this.sheet.options,{colHeaderVisible:n,rowHeaderVisible:o,isProtected:c}),Object.assign(this.sheet.options.gridline,{showHorizontalGridline:i,showVerticalGridline:s})}}]),e}(),O=function(){function e(t){p(this,e),this.spread=t}return y(e,[{key:"addSheet",value:function(e){this.spread.addSheet(e)}},{key:"getSheet",value:function(e){var t=this.spread.getSheet(e);return t?new C(t):null}},{key:"setOptions",value:function(e){var t=e.newTabVisible,n=void 0===t||t,r=e.tabStripVisible,o=void 0===r||r,a=e.showHorizontalScrollbar,i=void 0===a||a,u=e.showVerticalScrollbar,s=void 0===u||u;Object.assign(this.spread.options,{newTabVisible:n,tabStripVisible:o,showHorizontalScrollbar:i,showVerticalScrollbar:s})}}]),e}();function E(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function A(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t,n,r,o,a,i){try{var u=e[a](i),s=u.value}catch(l){return void n(l)}u.done?t(s):Promise.resolve(s).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){k(a,r,o,i,u,"next",e)}function u(e){k(a,r,o,i,u,"throw",e)}i(void 0)}))}}function P(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var T={exports:{}},M={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(M);var j=M.exports;!function(e){var t=j.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=n=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var r,o={},a=Object.prototype,i=a.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(N){h=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),i=new R(r||[]);return u(a,"_invoke",{value:T(e,n,i)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}o.wrap=p;var v="suspendedStart",g="suspendedYield",y="executing",m="completed",w={};function b(){}function S(){}function C(){}var O={};h(O,l,(function(){return this}));var E=Object.getPrototypeOf,A=E&&E(E(D([])));A&&A!==a&&i.call(A,l)&&(O=A);var k=C.prototype=b.prototype=Object.create(O);function x(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,n){function r(o,a,u,s){var l=d(e[o],e,a);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==t(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,u,s)}),(function(e){r("throw",e,u,s)})):n.resolve(f).then((function(e){c.value=e,u(c)}),(function(e){return r("throw",e,u,s)}))}s(l.arg)}var o;u(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(a,a):a()}})}function T(e,t,n){var o=v;return function(a,i){if(o===y)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:r,done:!0}}for(n.method=a,n.arg=i;;){var u=n.delegate;if(u){var s=M(u,n);if(s){if(s===w)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===v)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var l=d(e,t,n);if("normal"===l.type){if(o=n.done?m:g,l.arg===w)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function M(e,t){var n=t.method,o=e.iterator[n];if(o===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=r,M(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var a=d(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,w;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,w):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(i.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=r,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=C,u(k,"constructor",{value:C,configurable:!0}),u(C,"constructor",{value:S,configurable:!0}),S.displayName=h(C,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,h(e,f,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},x(P.prototype),h(P.prototype,c,(function(){return this})),o.AsyncIterator=P,o.async=function(e,t,n,r,a){void 0===a&&(a=Promise);var i=new P(p(e,t,n,r),a);return o.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},x(k),h(k,f,"Generator"),h(k,l,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},o.values=D,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,o){return u.type="throw",u.arg=e,t.next=n,o&&(t.method="next",t.arg=r),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),w}},o}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(T);var I=(0,T.exports)(),R=I;try{regeneratorRuntime=I}catch(jt){"object"==typeof globalThis?globalThis.regeneratorRuntime=I:Function("r","regeneratorRuntime = r")(I)}const D=P(R);var N=function(e){return e?"string"==typeof e&&(e=[e]):e=[],e},F=function(){function e(){p(this,e),this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptMaps={},this._dataPromises={}}var t,n,r,o,a,i,u,s;return y(e,[{key:"loadScript",value:(s=x(D.mark((function e(t){var n,r,o,a=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],(t=N(t)).forEach((function(e){(r=a._scriptMaps[e]=a._scriptMaps[e]||{}).promise||(r.path=e,r.promise=new Promise((function(t){(n=a.createScriptElement()).setAttribute("type","text/javascript"),n.src=e,n.addEventListener("load",t),a._head.appendChild(n)}))),o.push(r.promise)})),e.abrupt("return",Promise.all(o));case 4:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"unloadScript",value:(u=x(D.mark((function e(t){var n,r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(n=r._head.querySelectorAll('script[src="'+e+'"]')[0])&&(r._head.removeChild(n),delete r._scriptMaps[e])})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"createScriptElement",value:function(){return document.createElement("script")}},{key:"fetchData",value:(i=x(D.mark((function e(t){var n,r,o=arguments;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:{},r=t+JSON.stringify(n),n.cache=void 0===n.cache||n.cache,t){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this._dataPromises[r]&&n.cache){e.next=16;break}return e.prev=6,e.next=9,fetch(t,n);case 9:this._dataPromises[r]=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),this._dataPromises[r]=null,e.t0;case 16:return e.abrupt("return",this._dataPromises[r]);case 17:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return i.apply(this,arguments)})},{key:"loadCss",value:(a=x(D.mark((function e(t){var n=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){if(!n._cssPaths[e]){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),n._head.appendChild(t),n._cssPaths[e]=t}})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"unloadCss",value:(o=x(D.mark((function e(t){var n,r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=N(t)).forEach((function(e){(n=r._cssPaths[e])&&(r._head.removeChild(n),r._cssPaths[e]=null)})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadTemplate",value:(r=x(D.mark((function e(t,n){var r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.fetchTemplate(t);case 4:if(r=e.sent,!n){e.next=8;break}return n.innerHTML=r,e.abrupt("return",n);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"fetchTemplate",value:(n=x(D.mark((function e(t){var n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"flush",value:(t=x(D.mark((function e(){var t,n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadCss(Object.getOwnPropertyNames(this._cssPaths));case 2:this._cssPaths={},e.t0=D.keys(this._scriptMaps);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(t=e.t1.value,!this._scriptMaps.hasOwnProperty(t)){e.next=10;break}return n=this._scriptMaps[t],e.next=10,this.unloadScript(n.path);case 10:e.next=4;break;case 12:this._scriptMaps={},this._dataPromises={};case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),V=new F;function H(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");e.dispatchEvent(t)}}function L(e,t){var n=window.URL||window.webkitURL,r=document.createElement("a");r.download=t,r.rel="noopener","string"==typeof e?(r.href=e,r.origin==window.location.origin?H(r):function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return 200<=t.status&&t.status<=299}(r.href)||(r.target="_blank",H(r))):(r.href=n.createObjectURL(e),setTimeout((function(){n.revokeObjectURL(r.href)}),4e4),setTimeout((function(){H(r)}),0))}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}function U(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,u=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(c){l=!0,o=c}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return u}}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J,z={exports:{}},Q={};z.exports=function(){if(J)return Q;J=1;var t=e,n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,r){var u,s={},l=null,c=null;for(u in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,u)&&!i.hasOwnProperty(u)&&(s[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps)void 0===s[u]&&(s[u]=t[u]);return{$$typeof:n,type:e,key:l,ref:c,props:s,_owner:a.current}}return Q.Fragment=r,Q.jsx=u,Q.jsxs=u,Q}();var Z=z.exports,Y=r();function _(){this.name="TOONE.GET",this.maxArgs=2,this.minArgs=1}_.prototype=new Y.Spread.CalcEngine.Functions.Function,_.prototype.evaluate=function(e){return"[函数(Fx)]"};var X=r();function K(){this.name="TOONE.GROUPNAME",this.maxArgs=0,this.minArgs=0}K.prototype=new X.Spread.CalcEngine.Functions.Function,K.prototype.description=function(){return{description:"获取分组名称",parameters:[]}},K.prototype.evaluate=function(e){return"[函数(Fx)]"};var q=r();function $(){this.name="TOONE.PAGECOUNT",this.maxArgs=0,this.minArgs=0}$.prototype=new q.Spread.CalcEngine.Functions.Function,$.prototype.description=function(){return{description:"获取总页数",parameters:[]}},$.prototype.evaluate=function(e){return"[函数(Fx)]"};var ee=r();function te(){this.name="TOONE.PAGEINDEX",this.maxArgs=0,this.minArgs=0}te.prototype=new ee.Spread.CalcEngine.Functions.Function,te.prototype.description=function(){return{description:"获取当前页",parameters:[]}},te.prototype.evaluate=function(e){return"[函数(Fx)]"};var ne=function(e){!function(e){var t=new _;e.addCustomFunction(t);var n=new $;e.addCustomFunction(n);var r=new te;e.addCustomFunction(r);var o=new K;e.addCustomFunction(o)}(e)};const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABkCAYAAACWy14QAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlBNDFDQzUzRkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlBNDFDQzU0RkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUE0MUNDNTFGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUE0MUNDNTJGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52RmQBAAAR1klEQVR42uxd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";var oe=["children"],ae=["children"],ie=["children"];function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var le,ce=function(e){return function(t){var n=t.children,r=E(t,oe);return Z.jsx("div",se(se({style:e},r),{},{children:n}))}},fe=function(e){return function(t){var n=t.children,r=E(t,ae);return Z.jsx("span",se(se({style:e},r),{},{children:n}))}},he=ce({color:"#6a6a6a",textAlign:"center",verticalAlign:"middle",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"440px",whiteSpace:"nowrap"}),pe=(le={display:"inline-block",width:"100px",height:"105px",verticalAlign:"middle"},function(e){var t=e.children,n=E(e,ie);return Z.jsx("img",se(se({style:le},n),{},{children:t}))}),de=fe({display:"inline-block",paddingLeft:"10px",textAlign:"left",verticalAlign:"middle",fontSize:"14px"}),ve=fe({display:"inline-block",fontSize:"20px",fontWeight:"600",opacity:"0.8"});function ge(){return Z.jsxs(he,{children:[Z.jsx(pe,{src:re}),Z.jsxs(de,{children:[Z.jsx(ve,{children:"未找到有效许可证！"}),Z.jsx("br",{}),"获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询。"]})]})}var ye=ce({position:"absolute",bottom:"50px",right:"50px",color:"#6a6a6a",zIndex:"999",textAlign:"right",fontSize:"14px",pointerEvents:"none"});function me(){return Z.jsxs(ye,{children:["获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询"]})}var we=function(e){return null==e},be=function(e){return"string"==typeof e&&e.trim().length>0};function Se(e,t){return(Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Se(e,t)}function Oe(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e){return r().Spread.CalcEngine.ExpressionType[e]}function ke(e){return{lMt:!0,type:Ae("string"),value:e}}function xe(e){return{lMt:!0,originalValue:e+"",type:Ae("number"),value:e}}function Pe(e){switch(typeof e){case"number":return xe(e);case"boolean":return function(e){return{lMt:!0,type:Ae("boolean"),value:e}}(e);default:return ke(we(e)?"":e)}}var Te=function(e){return r().Spread.Sheets.CalcEngine.formulaToExpression(null,e,0,0)};var Me=function(e,t){switch(e.functionName){case"TOONE.GET":return function(e,t){var n,r,o,a=e.arguments;if(!a||0==a.length)throw Error("TOONE.GET函数未传递参数，请检查配置！");r=a[0].value,o=null===(n=a[1])||void 0===n?void 0:n.value;var i=t.getValue(r,o);return"text"==i.type?Pe(i.value):Te(i.value)}(e,t);case"TOONE.PAGECOUNT":return function(e,t){return xe(t.getPageCount())}(0,t);case"TOONE.PAGEINDEX":return function(e,t){return xe(t.getPageIndex())}(0,t);case"TOONE.GROUPNAME":return function(e,t){return ke(t.getGroupName())}(0,t)}return null},je=function(){function e(t){p(this,e),this.ast=t}return y(e,[{key:"getAST",value:function(){return this.ast}},{key:"parse",value:function(e){return this.ast}},{key:"toParser",value:function(e){return e&&"number"==typeof e.type?He(e):null}},{key:"parseValue",value:function(e,t){var n=this.toParser(e);return n?n.parse(t):e}},{key:"_getVisitChildren",value:function(){return[]}},{key:"_getVisitHandlerName",value:function(){return null}},{key:"visit",value:function(e){var t=this,n=this._getVisitHandlerName(),r=e[n],o=!0;("function"==typeof r&&(o=!1!==r.call(e,this)),o)&&this._getVisitChildren().forEach((function(n){var r=t.toParser(n);r&&r.visit(e)}))}}]),e}();function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Re=function(e){Ce(n,e);var t=Ie(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this,n=this.getAST(),r=Me(n,e);if(null!==r)return r;var o=n.arguments;if(Array.isArray(o)){var a=o.map((function(n){return t.parseValue(n,e)}));n.arguments=a}return n}},{key:"_getVisitHandlerName",value:function(){return"visitFunction"}},{key:"_getVisitChildren",value:function(){var e=this.getAST().arguments;return Array.isArray(e)?e:[]}}]),n}(je);function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Ne=function(e){Ce(n,e);var t=De(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t.value2=this.parseValue(t.value2,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitOperator"}},{key:"_getVisitChildren",value:function(){var e=this.getAST();return[e.value,e.value2]}}]),n}(je);function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Ve=function(e){Ce(n,e);var t=Fe(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitParentheses"}},{key:"_getVisitChildren",value:function(){return[this.getAST().value]}}]),n}(je),He=function(e){var t=e.type,n=r().Spread.CalcEngine.ExpressionType;switch(t){case n.operator:return new Ne(e);case n.function:return new Re(e);case n.parentheses:return new Ve(e);default:return new je(e)}},Le=function(){function e(t){p(this,e),this.handlers=t}return y(e,[{key:"_visit",value:function(e,t){var n=this.handlers[e];if(n)return n(t)}},{key:"visitFunction",value:function(e){return this._visit("function",e)}},{key:"visitOperator",value:function(e){return this._visit("operator",e)}},{key:"visitParentheses",value:function(e){return this._visit("parentheses",e)}}]),e}(),Ge=function(){function e(){p(this,e)}return y(e,[{key:"setFieldIndexHandler",value:function(e){this.fieldIndexHandler=e}},{key:"setDataCountHandler",value:function(e){this.dataCountHandler=e}},{key:"setPageHandler",value:function(e){this.pageHandler=e}},{key:"setTotalPagesHandler",value:function(e){this.totalPagesHandler=e}},{key:"setUnionDatasourceHandler",value:function(e){this.unionDatasourceHandler=e}},{key:"setDataIndex",value:function(e){this.dataIndexHandler=e}},{key:"setValueHandler",value:function(e){this.valueHandler=e}},{key:"setSettingHandler",value:function(e){this.settingHandler=e}},{key:"setGroupNameHandler",value:function(e){this.groupNameHandler=e}},{key:"setIsGroupSumAreaHandler",value:function(e){this.isGroupSumAreaHandler=e}},{key:"getFieldIndex",value:function(e,t){return this.fieldIndexHandler(e,t)}},{key:"getDataIndex",value:function(e,t){return this.dataIndexHandler(e,t)}},{key:"getDataCount",value:function(e){return this.dataCountHandler(e)}},{key:"getUnionDatasource",value:function(){return this.unionDatasourceHandler()}},{key:"getPage",value:function(){return this.pageHandler()}},{key:"getTotalPages",value:function(){return this.totalPagesHandler()}},{key:"getPageIndex",value:function(){return this.pageHandler()}},{key:"getPageCount",value:function(){return this.totalPagesHandler()}},{key:"getValue",value:function(e,t){return this.valueHandler(e,t)}},{key:"getGroupName",value:function(){return this.groupNameHandler()}},{key:"isInGroupSumArea",value:function(){return this.isGroupSumAreaHandler()}},{key:"getSetting",value:function(){return this.settingHandler()}}]),e}(),Be=function(){function e(t){p(this,e),this.plugin=t}return y(e,[{key:"getConfig",value:function(){return this.plugin?this.plugin.config:null}},{key:"execute",value:function(e,t){return e}}]),e}();function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Je=[["url",""],["mode",1],["height",0],["width",0],["clipX",0],["clipY",0],["clipHeight",0],["clipWidth",0],["vAlign",1],["hAlign",1]],ze=function(e){var t=["IMAGE("];return Je.forEach((function(n){var r,o=void 0;Array.isArray(n)?(r=n[0],o=n[1]):r=n;var a=e[r];a=a===o?void 0:a,t.push(function(e){return we(e)?"":e}(a)),t.push(",")})),t.pop(),t.push(")"),t.join("")},Qe=function(e){Ce(n,e);var t=We(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){var n=this.getConfig(),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:"formula"==e.type?e.value:`"${e.value}"`},n);return{type:"formula",value:ze(r)}}}]),n}(Be);function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var Ye=function(e){Ce(n,e);var t=Ze(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){return{type:"text",value:t.getPage()}}}]),n}(Be),_e=null,Xe=function(){if(null==_e){var e=new(r().Spread.Sheets.Workbook);_e=e.getSheet(0)}return _e},Ke=function(e){if(0==e.length)return 0;var t=e.join("+"),n=Xe();return GC.Spread.Sheets.CalcEngine.evaluateFormula(n,t)};function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var $e=function(e){Ce(n,e);var t=qe(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"groupSubTotal",value:function(e,t){var n,r,o,a=this.getConfig(),i=a.functionNum,u=a.tableCode,s=a.fieldCode,l=t.getUnionDatasource(),c=this._isTreeSumField(e,t)?l.getLeafFieldValues(u,s):l.getFieldValues(u,s),f=function(){var e=[];return c.forEach((function(t){var n=t.value;isNaN(n)||e.push(parseFloat(n))})),e},h=null;switch(i){case 101:n=Ke(f()),r=c.length,o=Xe(),h=GC.Spread.Sheets.CalcEngine.evaluateFormula(o,`${n}/${r}`);break;case 103:h=c.length;break;case 102:h=f().length;break;case 104:h=function(e){var t=void 0;return e.forEach((function(e){(void 0===t||e>t)&&(t=e)})),t}(f());break;case 105:h=min(f());break;case 109:h=Ke(f())}return{type:"text",value:h}}},{key:"_isTreeSumField",value:function(e,t){var n=this.getConfig(),r=n.tableCode,o=n.fieldCode;return t.getUnionDatasource().isTreeSumField(r,o)}},{key:"_rangesToFormulaArgs",value:function(e){var t=r().Spread.Sheets.CalcEngine,n=t.RangeReferenceRelative.allRelative;return(0,t.rangesToFormula)(e,0,0,n,!1)}},{key:"_getSubTotalRanges",value:function(e,t){var n=[],o=t.getUnionDatasource(),a=this.getConfig(),i=a.tableCode,u=a.fieldCode,s=t.getDataCount(i),l=t.getFieldIndex(i,u),c=l.row,f=l.col,h=r().Spread.Sheets.Range;if(this._isTreeSumField(e,t)){var p=t.getDataIndex(i,u);o.getLeafRanges(i,p,p+s).forEach((function(e){n.push(new h(c+(e-p),f,1,1))}))}else n.push(new h(c,f,s,1));return n}},{key:"subTotal",value:function(e,t){var n=this._getSubTotalRanges(e,t);return{type:"formula",value:`SUBTOTAL(${this.getConfig().functionNum},${this._rangesToFormulaArgs(n)})`}}},{key:"execute",value:function(e,t){return t.isInGroupSumArea()?this.groupSubTotal(e,t):this.subTotal(e,t)}}]),n}(Be);function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ee(e);if(t){var o=Ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}var tt=function(e){Ce(n,e);var t=et(n);function n(){return p(this,n),t.apply(this,arguments)}return y(n,[{key:"execute",value:function(e,t){return{type:"text",value:t.getTotalPages()}}}]),n}(Be),nt=function(e,t,n){return t.forEach((function(t){var r=function(e){switch(e.type){case"cellImage":return new Qe(e);case"cellSubTotal":return new $e(e);case"pageCellType":return new Ye(e);case"totalPagesCellType":return new tt(e);default:return null}}(t);r&&(e=r.execute(e,n))})),e},rt=function(e,t){return e&&"formula"==e.type?function(e,t){if(be(e)){var n=Te(e);return n=He(n).parse(t),{type:"formula",value:e=GC.Spread.Sheets.CalcEngine.expressionToFormula(null,n,0,0)}}return{type:"formula",value:e}}(e.value,t):e},ot=function(e){return e?function(e){var t=[];if(be(e)){var n=Te(e),r=He(n),o=new Le({function:function(e){var n=e.getAST();if("TOONE.GET"==n.functionName){var r=n.arguments;return 2==r.length&&t.push(r[0].value),!1}}});r.visit(o)}return t}(e):[]};function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var it=function(){function e(t,n){p(this,e),A(this,"datas",[]),A(this,"references",[]),A(this,"treeStruct",{}),A(this,"treeDataIndexMap",{}),A(this,"datasources",{}),this._parseBindingPaths(t),this.setting=n,this._anslysisSetting()}return y(e,[{key:"_parseBindingPaths",value:function(e){var t=this;e&&e.length>0&&e.forEach((function(e){var n=e.split("."),r=n.length;if(1==r){var o=n[0];t.datasources[o]={type:"param"}}else if(2==r){var a=n[0],i=n[1],u=t.datasources[a]||{type:"field",fields:[]},s=u.fields;-1==s.indexOf(i)&&s.push(i),t.datasources[a]=u}}))}},{key:"_containsTable",value:function(e){var t=this.datasources[e];return t&&"field"==t.type}},{key:"_analysisTreeStructSetting",value:function(){if(this.setting.treeStruct)for(var e=0,t=Object.entries(this.setting.treeStruct);e<t.length;e++){var n=W(t[e],2),r=n[0],o=n[1];this._containsTable(r)&&(this.treeStruct[r]=o)}}},{key:"_analysisReferenceSetting",value:function(){var e=this;this.setting.references&&this.setting.references.forEach((function(t){var n=t.foreignKey,r=t.references;e._containsTable(n.tableCode)&&e._containsTable(r.tableCode)&&e.references.push(t)}))}},{key:"_analysisPluginSetting",value:function(){var e=this,t=this.setting.cellPlugins;t&&t.length>0&&(this.cellPlugins=[],t.forEach((function(t){var n=t.bindingPath,r=t.plugins;if(r&&r.length>0)for(var o=0;o<r.length;o++){"cellGroupType"==r[o].type&&e.cellPlugins.push({bindingPath:n,type:"cellGroupType"})}})))}},{key:"_anslysisSetting",value:function(){this.setting&&(this._analysisTreeStructSetting(),this._analysisReferenceSetting(),this._analysisPluginSetting())}},{key:"_toUniqueKey",value:function(e,t){return`${e},${t}`}},{key:"_isLeaf",value:function(e){return e.hasOwnProperty("isLeaf")?e.isLeaf:!e.children||0==e.children.length}},{key:"_treeStructDataEnhance",value:function(e){for(var t=this,n=function(){var n=W(o[r],2),a=n[0],i=n[1],u=e[a];if(u&&u.length>0){var s=i.sumFields,l=i.idField,c=i.pidField,f=i.leafField,h=i.sortField,p=i.sortType,d=t.treeDataIndexMap[a]||{};u.forEach((function(e){var t=e[l],n={data:e,children:[]};f&&(n.isLeaf=!!e[f]),d[t]=n})),t.treeDataIndexMap[a]=d;var v={data:null,children:[]};if(u.forEach((function(e){var t=e[l],n=e[c],r=d[n];r=r||v;var o=d[t];r.children.push(o)})),s&&s.length>0){var g=function e(n){if(!t._isLeaf(n)){var r=n.children||[];r.forEach((function(t){return e(t)}));var o=n.data;s.forEach((function(e){var t=[];r.forEach((function(n){var r=n.data[e];isNaN(r)||t.push(r)}));var n=Ke(t);o[e]=n}))}};v.children.forEach((function(e){return g(e)}))}if(h){!function e(t){var n=t.children;(n=n.sort((function(e,t){var n=e.data,r=t.data,o=n[h]-r[h];return"asc"==p?o:0-o}))).forEach((function(t){return e(t)})),t.children=n}(v)}e[a]=function e(t){var n=[];return t.forEach((function(t){n.push(t.data);var r=t.children;r&&r.length>0&&(n=n.concat(e(r)))})),n}(v.children)}},r=0,o=Object.entries(this.treeStruct);r<o.length;r++)n()}},{key:"_unitDataByReferences",value:function(e,t){var n=this,r=[];if(this.references){var o={};this.references.forEach((function(a){var i=a.references,u=a.foreignKey,s=i.tableCode,l=i.fieldCode;t.push(s);var c=n._toUniqueKey(s,l),f=o[c];f||(f={},o[c]=f,e[s].forEach((function(e){f[e[l]]=e})));var h=u.tableCode;t.push(h);var p=u.fieldCode;e[h].forEach((function(e){r.push(A(A({},h,e),s,f[e[p]]))}))}))}return r}},{key:"_unitDataByIndex",value:function(e,t,n){for(var r=0,o=Object.entries(e);r<o.length;r++){var a=W(o[r],2),i=a[0],u=a[1];if(-1==n.indexOf(i))for(var s=0,l=u.length;s<l;s++){var c=u[s],f=t[s]||{};f[i]=c,t[s]=f}}return t}},{key:"_unitDataByGroup",value:function(e,t,n){var r=this;if(this.cellPlugins&&this.cellPlugins.length>0){for(var o=[],a={},i=[],u=function(){var e=W(l[s],2),t=e[0],n=e[1];"field"==n.type&&n.fields.forEach((function(e){r.cellPlugins.find((function(n){return n.bindingPath==`${t}.${e}`}))||i.push({tableCode:t,fieldCode:e})}))},s=0,l=Object.entries(this.datasources);s<l.length;s++)u();return t.forEach((function(e){var t=[],n=function(t,n){var r=e[t],o=null;return r&&(o=r[n]),o};r.cellPlugins.forEach((function(e){var r=W(e.bindingPath.split("."),2),o=r[0],a=r[1];t.push(n(o,a))})),i.forEach((function(e){var r=e.tableCode,o=e.fieldCode;t.push(n(r,o))}));var u=t.join("_@_#_$_%_^_&_*_(_)_");a[u]||(o.push(e),a[u]=!0)})),o}return t}},{key:"isTreeSumField",value:function(e,t){var n,r=this.treeStruct[e];return(null==r||null===(n=r.sumFields)||void 0===n?void 0:n.length)>0&&-1!=r.sumFields.indexOf(t)}},{key:"getLeafRanges",value:function(e,t,n){for(var r=this.treeDataIndexMap[e],o=[],a=this.setting.treeStruct[e].idField,i=t;i<=n;i++){var u=this.datas[i];if(u&&u[e]){var s=r[u[e][a]];this._isLeaf(s)&&o.push(i)}}return o}},{key:"load",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),n=[];this._treeStructDataEnhance(t);var r=this._unitDataByReferences(t,n);r=this._unitDataByIndex(t,r,n),this.datas=this._unitDataByGroup(t,r,n)}},{key:"getCount",value:function(){return this.datas.length}},{key:"getValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.datas[n],o=null;if(r){var a,i=null===(a=r[e])||void 0===a?void 0:a[t];o=void 0===i?null:i}return{type:"text",value:o}}},{key:"getFieldValues",value:function(e,t){for(var n=[],r=this.getCount(),o=0;o<r;)n.push(this.getValue(e,t,o)),o++;return n}},{key:"getLeafFieldValues",value:function(e,t){var n=this.setting.treeStruct[e];if(n&&n.idField&&n.pidField){for(var r=[],o=this.treeDataIndexMap[e],a=n.idField,i=this.getCount(),u=0;u<i;u++){var s=this.datas[u];if(s&&s[e]){var l=o[s[e][a]];if(this._isLeaf(l)){var c=l.data,f=c?c[t]:null;r.push(f)}}}return r}return this.getFieldValues(e,t)}}]),e}();function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lt=r().Spread.Sheets;function ct(e){var t=e.sheet,n=e.dataTable,r=e.rules,o=e.spans,a=e.rows,i=e.rowCount,u=e.autoMergeRanges;if(t){var s=i>0?i:t.rowCount;t.data.dataTable=Object.keys(n).length?n:t.data.dataTable,t.rowCount=s,t.conditionalFormats=t.conditionalFormats?t.conditionalFormats:{},t.conditionalFormats.rules=r,t.spans=o,function(e,t){if(e.rows)return Object.keys(e.rows).forEach((function(t){delete e.rows[t]})),void Object.entries(t).forEach((function(t){var n=W(t,2),r=n[0],o=n[1];e.rows[r]=o}));e.rows=t}(t,a),t.autoMergeRangeInfos=u}}function ft(e){var t=e.templates,n=e.isCalcTemp,r=void 0!==n&&n,o=0;return t.forEach((function(e){for(var t=e.datas,n=e.dataTables,a=ht(t),i=r?1:a.getCount()||1,u=0;u<i;u++)n.forEach((function(e){var t=e.rows,n=void 0===t?{}:t;n.hasOwnProperty("size")?o+=null==n?void 0:n.size:o+=20}))})),{height:o}}function ht(e,t,n){var r=Object.fromEntries(e),o=new it(n,t);return o.load(r),o}function pt(e,t,n){var r=lt.AutoMerge.AutoMergeDirection.column,o=lt.AutoMerge.AutoMergeMode.free,a=lt.SheetArea.viewport,i=lt.AutoMerge.SelectionMode.merged;e.columnMerge&&e.rowMerge?r=lt.AutoMerge.AutoMergeDirection.rowColumn:e.rowMerge&&(r=lt.AutoMerge.AutoMergeDirection.row);var u={row:e.row-n,col:e.col,rowCount:null==e?void 0:e.rowCount,colCount:null==e?void 0:e.colCount};t.push({range:u,direction:r,mode:o,sheetArea:a,selectionMode:i})}function dt(e){return JSON.parse(JSON.stringify(e))}var vt=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;p(this,e),this.datas=n,this.reportJson=t,this.tempConfig=r,this.newSheets={},this.setting=o,this.templatesPageInfos={},this.delayPlugins=[],this.delayFormula=[],this.groupTemplate(),this.analysisTemplate(),Object.entries(this.newSheets).forEach((function(e){var n=W(e,2),r=n[0],o=n[1];t.sheets[r]=o,t.sheetCount+=1}));var a={};for(Object.values(t.sheets).forEach((function(e){a[e.name]=e})),t.sheets=a;this.delayPlugins.length;){this.delayPlugins.pop()()}for(;this.delayFormula.length;){this.delayFormula.pop()()}}return y(e,[{key:"render",value:function(e){var t=this,n=this.headerTemplates,r=this.footerTemplates,o=this.contentTemplates;if(e.pageArea){var a=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=ft({templates:t}).height,i=ft({templates:n}).height,u=ft({templates:o,isCalcTemp:!0}).height,s=a+i,l=e.pageTotalHeight;if(s>e.pageTotalHeight){var c=s%e.pageTotalHeight;c>=u&&(l=c)}else if(s<e.pageTotalHeight){var f=e.pageTotalHeight-s;f>=u&&(l=f)}var h=Math.floor(l/u);return{pageSubtotal:Math.ceil(r/h),lastContentTempCount:r%h,contentTempCount:h}},i=[],u=[];n.forEach((function(e){e.isTotalArea||(u.push(e),!e.isGroupSumArea&&i.push(e))}));var s=[],l=[];r.forEach((function(e){e.isTotalArea||(l.push(e),!e.isGroupSumArea&&s.push(e))}));!function(i,s){for(var c,f=a(i,s,(null==o||null===(c=o[0])||void 0===c?void 0:c.dataLen)||1),h=f.pageSubtotal,p=f.lastContentTempCount,d=f.contentTempCount,v=0,g=0;v<h;){var y=v+1>=h;if(y){var m=u,w=l,b=a(m,w,p),S=b.pageSubtotal,C=b.lastContentTempCount,O=b.contentTempCount;if(S<=1)if(e.groups.indexOf(e.sheet.name)===e.groups.length-1){var E=a(n,r,C),A=E.pageSubtotal,k=E.lastContentTempCount,x=E.contentTempCount;A<=1?(i=n,s=r,p=k,d=x):h+=1}else i=m,s=w,p=C,d=O;else h+=1}t.genPageDataTables({templates:i,pageInfos:e});var P=g+d;y&&!e.isFillData&&(P=g+p),t.genPageDataTables({templates:o,pageInfos:e,startIndex:g,endIndex:P}),t.genPageDataTables({templates:s,pageInfos:e}),v+1<h&&t.onAfterPage(e),e.pageHeight=0,g+=d,v++}}(i,s)}else this.genPageDataTables({templates:n,pageInfos:e});ct(e)}},{key:"splitTemplate",value:function(e){var t=e.sheet,n=e.tag,r=void 0===n?{}:n,o=t.rowCount,a=void 0===o?200:o,i=[],u=[],s=[],l=/^\d+:\d+$/,c=r.pageArea,f=void 0===c?"":c,h=r.groupSumArea,p=void 0===h?"":h,d=r.totalArea,v=void 0===d?"":d,g=a,y=a;if(f&&l.test(f)){var m=f.split(":");g=Number(m[0])-1,y=Number(m[1])}var w=a,b=a;if(p&&l.test(p)){var S=p.split(":");w=Number(S[0])-1,b=Number(S[1])}var C=a,O=a;if(v&&l.test(v)){var E=v.split(":");C=Number(E[0])-1,O=Number(E[1])}var A=null,k=0;do{var x,P,T,M=this.parseRowDataTable({row:k,sheet:t});if(k>=w&&k<b&&(M.isGroupSumArea=!0),k>=C&&k<O&&(M.isTotalArea=!0),A&&k<A.endRow)A.height+=M.height,(x=A.dataTables).push.apply(x,U(M.dataTables)),M.endRow>A.endRow&&(A.endRow=M.endRow,A.rowCount=A.endRow-A.row),M.datas.forEach((function(e,t){e.length>A.dataLen&&(A.dataLen=e.length),A.datas.set(t,e)})),M.allDatas.forEach((function(e,t){A.allDatas.set(t,e)})),M.isGroupSumArea&&(A.isGroupSumArea=M.isGroupSumArea),(P=A.dataPath).push.apply(P,U(M.dataPath)),(T=A.dataPath).push.apply(T,U(M.cellPlugins));else A=M;k>=g&&k<y&&(A.endRow=y,A.rowCount=A.endRow-A.row),k+1===A.endRow&&(A.verticalAutoMergeRanges=[],A.dataTables.forEach((function(e){var t=e.mergeInfos,n=void 0===t?[]:t,r=n.length;if(r>0){for(var o=[],a=n[0],i=1;i<r;i++){var u=n[i];a.row===u.row&&a.rowCount===u.rowCount&&a.columnMerge===u.columnMerge&&a.rowMerge===u.rowMerge&&a.col+a.colCount===u.col?a.colCount+=u.colCount:(pt(a,o,A.row),a=u)}pt(a,o,A.row),e.autoMergeRanges=[],o.filter((function(t){t.range.rowCount===A.rowCount?A.verticalAutoMergeRanges.push(t):t.range.colCount>1&&e.autoMergeRanges.push(t)}))}})),A.row<g?i.push(A):A.row>=y?u.push(A):s.push(A),A=null),k++}while(k<a);this.headerTemplates=i,this.footerTemplates=u,this.contentTemplates=s}},{key:"setTemplateDatas",value:function(e,t,n){var r,o,a=(null===(r=this.datas)||void 0===r?void 0:r[t])||[];e.allDatas.has(t)||e.allDatas.set(t,dt(a));var i=this.nameMaps[n],u=null===(o=this.groupsDatas)||void 0===o||null===(o=o[n])||void 0===o||null===(o=o[t])||void 0===o?void 0:o[i];Array.isArray(u)&&(a=u),e.datas.has(t)||(e.datas.set(t,dt(a)),a.length>e.dataLen&&(e.dataLen=a.length))}},{key:"parseRowDataTable",value:function(e){var t,n,r=this,o=e.row,a=e.sheet,i=a.name,u=a.spans,s=void 0===u?[]:u,l=a.data,c=void 0===l?{}:l,f=a.rows,h=void 0===f?{}:f,p=a.conditionalFormats,d=void 0===p?{}:p,v=(null==d?void 0:d.rules)||[],g=(null==c?void 0:c.dataTable)||{},y=(null==g?void 0:g[o])||{},m=function(e){var t=e.rules,n=e.row,r=t;return Number.isFinite(n)&&n>=0&&(r=t.filter((function(e){return e.ranges.some((function(e){var t=e.row,r=e.rowCount;return t<=n&&n<t+r}))}))||[]),r}({rules:v,row:o}),w={spans:[],mergeInfos:[],rules:[],rows:null,rowDataTable:y},b={row:o,endRow:o+1,rowCount:1,datas:new Map,allDatas:new Map,dataTables:[w],dataLen:0,height:0,isGroupSumArea:!1,isTotalArea:!1,dataPath:[],cellPlugins:[]},S=1,C=s.filter((function(e){return e.row===o&&(e.rowCount>S&&(S=e.rowCount),!0)}));return(t=w.spans).push.apply(t,U(C)),w.rows=function(e,t){return(null==e?void 0:e[t])||{size:20}}(h,o),b.height=null==w||null===(n=w.rows)||void 0===n?void 0:n.size,Object.entries(y).forEach((function(e){var t,n=W(e,2),a=n[0],u=n[1],s=u.bindingPath,l=u.tag,c=u.formula,f=u.style,h=void 0===f?{}:f,p=Number(a);if(null==s||null===(t=s.includes)||void 0===t?void 0:t.call(s,".")){b.dataPath.push(s);var d=s.split(".")[0];r.setTemplateDatas(b,d,i);var v=C.find((function(e){return e.col===p}))||{rowCount:1,colCount:1};if(l){var g=JSON.parse(l),y=g.columnMerge||!1,S=g.rowMerge||!1;(y||S)&&w.mergeInfos.push(st(st({},v),{},{row:o,col:p,columnMerge:y,rowMerge:S}));var O=g.plugins;Array.isArray(O)&&b.cellPlugins.push({plugins:O,bindingPath:s})}}if(c){var E=ot(c);Array.isArray(E)&&E.forEach((function(e){r.setTemplateDatas(b,e,i)}))}null!=h&&h.decoration&&(null==h||delete h.decoration),function(e){var t=e.rules,n=e.col,r=e.colHandler,o=t;Number.isFinite(n)&&n>=0&&(o=o.filter((function(e){var t=e.ranges.some((function(e){var t=e.col,r=e.colCount;return t<=n&&n<t+r}));return t&&"function"==typeof r&&r(dt(e)),t})))}({rules:m,col:p,colHandler(e){w.rules.push(st({},e))}})})),b.rowCount=S,b.endRow=b.row+S,b}},{key:"groupTemplate",value:function(){var e=this.reportJson,t=this.datas,n=this.tempConfig,r=e.sheetCount,o=[],a={},i={},u=st({},n);Object.entries(n).forEach((function(n){var s,l=W(n,2),c=l[0],f=l[1],h=null==f?void 0:f.groups;if(h){var p=u[c],d={};Object.entries(h).some((function(e){var n=W(e,2),r=n[0],o=n[1];d[r]={};var a=t[r];if(Array.isArray(a)&&Array.isArray(o)&&o.length){var i,u=null==o||null===(i=o[0])||void 0===i?void 0:i.code;a.forEach((function(e){var t=e[u];Array.isArray(d[r][t])||(d[r][t]=[]),d[r][t].push(e)}))}}));var v=null==e||null===(s=e.sheets)||void 0===s?void 0:s[c];if(v&&0!==v.visible){var g=JSON.stringify(v),y=Object.values(d)[0],m=Object.keys(y),w=[];m.forEach((function(t,n){for(var s=t,l=1;e.sheets[s];)s=`${t}${l++}`;for(;m.includes(s)&&s!==t||o.includes(s);)s=`${t}${l++}`;if(s!==t){var f=d[t];delete d[t],d[s]=f}if(o.push(s),i[s]=d,a[s]=t,n<=0)v.name=s;else{var h=JSON.parse(g);h.name=s,h.isSelected=!1,h.index=r++,h.order=h.index,e.sheets[s]=h,e.sheetCount+=1}w.push(s),u[s]=st(st({},p),{},{fromTempSheet:c,groups:w})}))}return!0}})),this.template=u,this.groupsDatas=i,this.nameMaps=a}},{key:"analysisTemplate",value:function(){var e=this,t=Object.values(this.reportJson.sheets);t.sort((function(e,t){return e.order-t.order}));var n=function(){var e="wd2mn37k18jf19j8yw1q8d4pt2jpzx35xlw8nzjbj",t=document.getElementById(e);t||((t=document.createElement("div")).id=e,document.body.append(t)),t.style.width="1in";var n=getComputedStyle(t).width;return Number(n.slice(0,-2))}();t.forEach((function(t){var r,o,a,i=t.name,u=t.visible,s=void 0===u?1:u,l=t.data,c=t.printInfo,f=c.paperSize,h=f.height,p=void 0===h?1100:h,d=f.width,v=void 0===d?850:d,g=c.orientation,y=c.margin,m=void 0===y?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:y,w=t.colHeaderVisible,b=void 0===w||w;if(0!==s){var S=m.bottom;m.footer,m.header;var C=m.top;m.left,m.right;var O=e.template[i],E=!1,A=null==l||null===(r=l.defaultDataNode)||void 0===r?void 0:r.tag,k={};if(A){var x=JSON.parse(A);E=null==x?void 0:x.isFillData,k=x}null!=t&&null!==(o=t.rowHeaderData)&&void 0!==o&&o.dataTable&&(t.rowHeaderData.dataTable={}),e.splitTemplate({sheet:t,tag:k});var P=0;S=n*S/100,C=n*C/100;var T=b?20:0;P=2===g?n*(v||850)/100-S-C-T:n*(p||1100)/100-S-C-T;var M=!!O,j=null==O?void 0:O.fromTempSheet,I=(null==O?void 0:O.groups)||[];M&&(e.templatesPageInfos[j]||(e.templatesPageInfos[j]={pageIndex:0,pageTotal:0}),e.templatesPageInfos[j].pageIndex+=1,e.templatesPageInfos[j].pageTotal+=1);var R={sheet:t,spans:[],rows:[],rules:[],dataTable:{},autoMergeRanges:[],rowCount:0,pageIndex:1,pageTotal:1,pageArea:null===(a=k)||void 0===a?void 0:a.pageArea,pageTotalHeight:P,pageHeight:0,isFillData:E,isCurrentSheet:null==O?void 0:O.isCurrentSheet,isTemplate:M,cobySheet:JSON.stringify(t),page:{},fromTempSheet:j,groups:I};e.render(R)}}))}},{key:"getSheetCount",value:function(){return this.reportJson.sheetCount+Object.keys(this.newSheets).length}},{key:"genPageDataTables",value:function(e){var t=this,n=e.templates,r=e.pageInfos,o=e.startIndex,a=void 0===o?0:o,i=e.endIndex,u=void 0===i?0:i;n.forEach((function(e){var n=e.datas,o=e.allDatas,i=e.dataTables,s=e.height,l=e.isGroupSumArea,c=e.isTotalArea,f=e.dataPath,h=e.cellPlugins,p=e.verticalAutoMergeRanges,d=st(st({},t.setting),{},{cellPlugins:h}),v=ht(n,d,f),g=ht(o,d,f),y=u||v.getCount()||1;(p=dt(p)).forEach((function(e){e.range.row=r.rowCount}));for(var m=r.page,w=r.rowCount,b=a,S=function(e){r.pageArea&&(r.pageHeight+s>r.pageTotalHeight?(w=r.rowCount,b=e,t.onAfterPage(r,s)):r.pageHeight+=s),i.forEach((function(n){var o=n.rows,a=void 0===o?{}:o,i=n.rowDataTable,u=n.spans,s=void 0===u?[]:u,f=n.rules,h=void 0===f?[]:f,p=n.autoMergeRanges,d=void 0===p?[]:p,y=dt(i);if(Object.entries(y).forEach((function(n){var o,a=W(n,2),i=a[0],u=a[1],s=Number(i),f=u.bindingPath,h=u.tag,p=u.formula;if(null!=f&&null!==(o=f.includes)&&void 0!==o&&o.call(f,".")){var d=W(f.split("."),2),y=d[0],S=d[1];delete u.bindingPath;var C=v.getValue(y,S,e),O=C.type,E=C.value;"text"===O&&(u.value=E)}var A=new Ge;if(A.setGroupNameHandler((function(){return r.sheet.name})),A.setIsGroupSumAreaHandler((function(){return l||c})),h){var k=JSON.parse(h),x=k.instanceId;m[r.pageIndex]=m[r.pageIndex]||{},m[r.pageIndex][x]=m[r.pageIndex][x]||{};var P=m[r.pageIndex][x];P.row=w,P.col=s,P.count=P.count||0,P.count+=1,P.dataIndex=b,P.unionDatasource=v,P.unionDatasourceAll=g;var T=k.hyperlinkInfo||{};"document"===(null==T?void 0:T.type)&&null!=T&&T.isAutoDoc&&(u.hyperlink.url=`sjs://${u.value}!A1`,u.hyperlink.tooltip&&(u.hyperlink.tooltip=u.value));var M=k.plugins;if(Array.isArray(M)){let e=function(){var e,t=null==m||null===(e=m[R])||void 0===e?void 0:e[j];A.setFieldIndexHandler((function(){return{row:null==t?void 0:t.row,col:null==t?void 0:t.col}})),A.setDataCountHandler((function(){return null==t?void 0:t.count})),A.setDataIndex((function(){return null==t?void 0:t.dataIndex})),A.setUnionDatasourceHandler((function(){return c?null==t?void 0:t.unionDatasourceAll:null==t?void 0:t.unionDatasource}));var n=function(e,t,n){return nt(e,t,n)}({type:"text",value:u.value},M,A),r=n.type,o=n.value;u["formula"===r?r:"value"]=o};var j="",I=M.some((function(e){var t=e.type,n=e.config;return"cellSubTotal"===t&&(j=null==n?void 0:n.instanceId),["cellSubTotal"].includes(t)})),R=r.pageIndex;I?t.delayPlugins.push(e):e()}}var D=r.pageIndex,N=r.fromTempSheet;t.templatesPageInfos[N]&&(D=t.templatesPageInfos[N].pageIndex);var F,V=(F=D,function(){return F});if(p){t.delayFormula.push((function(){A.setPageHandler(V),A.setTotalPagesHandler((function(){return t.templatesPageInfos[N]?t.templatesPageInfos[N].pageTotal:r.pageTotal})),A.setValueHandler((function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return 1===r.length?{type:"text",value:t.datas[r[0]]}:v.getValue(r[0],r[1],e)}));var n=rt({type:"formula",value:p},A),o=n.type,a=n.value;u["formula"===o?o:"value"]=a}))}})),r){var S=r.rowCount;r.dataTable[S]=y,s.forEach((function(e){r.spans.push(st(st({},e),{},{row:S}))})),h.forEach((function(e){r.rules.push(st(st({},e),{},{ranges:[st(st({},e.ranges[0]),{},{row:S})]}))})),r.rows[S]=st(st({},r.rows[S]||{}),a),d.forEach((function(e){var t=dt(e);t.range.row=S,r.autoMergeRanges.push(t)})),r.rowCount+=1}}))},C=a;C<y;C++)S(C);p.forEach((function(e){e.range.rowCount=r.rowCount-e.range.row,r.autoMergeRanges.push(e)}))}))}},{key:"onAfterPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.isTemplate&&!e.isCurrentSheet)ct(e),e.sheet=JSON.parse(e.cobySheet),e.sheet.name+=`_${e.pageIndex}`,e.sheet.index=this.getSheetCount(),e.sheet.isSelected=!1,this.newSheets[e.sheet.name]=e.sheet,e.dataTable={},e.spans=[],e.rows={},e.rules=[],e.autoMergeRanges=[],e.rowCount=0;else{var n,r=e.rowCount,o=(null===(n=e.rows)||void 0===n?void 0:n[r])||{};o.pageBreak=!0,e.rows[r]=o}e.pageHeight=t,e.pageIndex+=1,e.pageTotal+=1,null!=e&&e.fromTempSheet&&(this.templatesPageInfos[null==e?void 0:e.fromTempSheet].pageIndex+=1,this.templatesPageInfos[null==e?void 0:e.fromTempSheet].pageTotal+=1)}}]),e}(),gt=null,yt=function(){var e,t=r();try{(new t.Spread.Sheets.Workbook).getSheet(0).setValue(0,0,"test")}catch(n){return{success:!1,showError:!0}}return e=location.hostname,/^(127\.0\.0\.1|localhost)/g.test(e)?{success:!1,showWarn:!0}:{success:!0}};function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var bt=r().Spread.Sheets;function St(e,t,n,r){if(!e)return{datas:[],spansTree:[]};var o=t.map((function(e){return e.code})),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.length>0?function e(t,n){var r=U(n),o=new Map,a=r.shift();return t.forEach((function(e){var t=e[a];o.has(t)||o.set(t,{groupName:t,groupCode:a,allChildrens:[]}),o.get(t).allChildrens.push(e)})),o.forEach((function(t){r.length>0&&t.allChildrens.length>0&&(t.childrenGroups=e(t.allChildrens,r))})),o}(e,t):void 0;return new Map([["总",{groupName:"总",groupCode:null,allChildrens:U(e),childrenGroups:n}]])}(e,o),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).map((function(e){return e.code})),a=o.length>0,i=n.filter((function(e){var n=e.code;return!t.includes(n)&&!o.includes(n)})),u=i.length,s=function e(n){var s=null,l=0,c=[];return n.forEach((function(n,f,h){var p={children:[],verticalSpans:[]},d=n.childrenGroups,v=n.allChildrens,g=n.groupCode,y=n.groupName,m=0,w=t.indexOf(g);if(d){var b,S=e(d);s=S.lastChild,m+=S.totalRowCount,l+=S.totalRowCount,(b=p.children).push.apply(b,U(S.spansTree))}else v.forEach((function(e){s=e;var n=[];if(a){var c={};t.forEach((function(t){c[t]=e[t]}));for(var f=function(){var t=i[h].code;c[t]=e[t];var r=i[h+1].code,a=wt(wt({},c),{},A({},r,"小计"));o.forEach((function(t){var n=Number(e[t]);e[t]=Number.isNaN(n)?0:n,Object.defineProperty(a,t,{get:()=>e[t]})})),n.unshift(a),p.verticalSpans[h]||(p.verticalSpans[h]=[]),p.verticalSpans[h].push({rowCount:u-h,col:w+h+1,colCount:1,row:0,subtotalSpan:{rowCount:1,col:w+h+1+1,colCount:u-h-1,row:0},style:{vAlign:1}}),m++,l++},h=0;h<u-1;h++)f()}m++,l++,r.push.apply(r,[e].concat(n))}));var C={};if(g){if(a){var O=t.indexOf(g);t.forEach((function(e,t){t<=O&&(C[e]=s[e])}));var E=t[O+1];O+1===t.length&&(E=i[0].code),C[g]=y,C[E]="小计",p.subtotalSpan={row:0,col:O+1,rowCount:1,colCount:u+(t.length-O)-1},m++,l++}var k={rowCount:m,col:w,colCount:1,row:0,style:{vAlign:1}};p=wt(wt({},p),k)}else a&&(C[t[0]||(null==i?void 0:i[0].code)]="小计",p=wt(wt({},p),{},{row:l,rowCount:1,col:0,colCount:t.length+u,isTotal:!0}));a&&(o.forEach((function(e){Object.defineProperty(C,e,{get:()=>v.reduce((function(t,n){return t+n[e]}),0)})})),r.push(C)),c.push(p)})),{lastChild:s,totalRowCount:l,spansTree:c}}(e),l=s.spansTree;return{datas:r,spansTree:l}}(a,o,n,r);return{datas:i.datas,spansTree:i.spansTree}}var Ct=r().Spread.Sheets,Ot=ce({position:"relative",width:"100%",height:"100%",overflow:"visible",userSelect:"none"}),Et=function(e,t,n){if(n){var o=r().Spread.Sheets.Events[t];e.bind(o,n)}},At=function(e){var t=e.spread,n=e.dataSource,r=e.sumColumns,o=e.groupColumns,a=e.rowMerge,i=e.columnMerge,u=e.rowMergeColumns,s=void 0===u?{}:u,l=e.colMergeColumns,c=void 0===l?{}:l;t&&t.sheets.forEach((function(e){var t,u=JSON.parse(JSON.stringify(n)),l=e.tables.all(),f=[],h=[],p=null;u&&(p=new Ct.Bindings.CellBindingSource(u),e.setDataSource(p)),l.length>0&&l.forEach((function(e){var t=e.name(),n=o[t],a=r[t],i=s[t]||[],l=c[t]||[];if(Array.isArray(n)&&n.length>0||Array.isArray(a)&&a.length>0){var p=e.bindingPath(),d=e.range(),v=d.row,g=d.col,y=[];if(e.BSt.forEach((function(e){y.push({code:e.dataField()})})),null!=u&&u[p]){var m=St(u[p],n,y,a),w=m.datas,b=m.spansTree;u[p]=w;var S=function(e){var t=[],n={};return function e(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=o;r.forEach((function(r){var u=r.row,s=void 0===u?0:u,l=r.col,c=void 0===l?0:l,f=r.rowCount,h=void 0===f?1:f,p=r.colCount,d=void 0===p?1:p,v=r.children,g=void 0===v?[]:v,y=r.verticalSpans,m=void 0===y?[]:y,w=r.subtotalSpan,b=r.isTotal,S=void 0!==b&&b;if(g.length>0&&e(g,i),m.length>0&&m.forEach((function(e,r){var o=i;e.forEach((function(e){if(e.hasOwnProperty("style")){var i=e.col,u=e.style;n[o]||(n[o]={}),n[o][i]||(n[o][i]={}),n[o][i].style=wt({},u)}t.push({row:o,col:e.col+a,rowCount:e.rowCount,colCount:e.colCount}),e.subtotalSpan.colCount>1&&t.push({row:o+e.rowCount-1,col:e.subtotalSpan.col+a,rowCount:e.subtotalSpan.rowCount,colCount:e.subtotalSpan.colCount}),o+=e.rowCount+r}))})),r.hasOwnProperty("style")){var C=r.col,O=r.style;n[i]||(n[i]={}),n[i][C]||(n[i][C]={}),n[i][C].style=wt({},O)}r.hasOwnProperty("row")&&((h>1||d>1)&&(S?t.push({row:s+o,col:c+a,rowCount:h,colCount:d}):t.push({row:i,col:c+a,rowCount:h,colCount:d})),w&&t.push({row:i+h-1,col:w.col+a,rowCount:w.rowCount,colCount:w.colCount}),i+=h)}))}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),{spans:t,dataTableStyle:n}}(b,v+1,g);f.push.apply(f,U(S.spans))}}if(i.length>0||l>0){var C=e.BSt.map((function(e){return{id:e.id(),code:e.dataField(),name:e.name()}})),O=e.range(),E=function(e){var t=e.rowMergeColumns,n=e.colMergeColumns,r=e.tableColumns,o=e.row,a=void 0===o?0:o;e.col;var i=e.rowCount,u=void 0===i?0:i,s=[];if(t.length||n.length){var l=t.map((function(e){return wt(wt({},e),{},{rowMerge:!0,colMerge:!1})}));n.forEach((function(e){var t=l.find((function(t){return t.code===(null==e?void 0:e.code)}));t?t.colMerge=!0:l.push(wt(wt({},e),{},{rowMerge:!1,colMerge:!0}))})),l.sort((function(e,t){return r.findIndex((function(t){return t.code===e.code}))-r.findIndex((function(e){return e.code===t.code}))}));var c=l[0],f=c.rowMerge,h=c.colMerge,p=bt.AutoMerge.AutoMergeDirection.column,d=bt.AutoMerge.AutoMergeMode.free,v=bt.SheetArea.viewport,g=bt.AutoMerge.SelectionMode.merged;f&&h?p=bt.AutoMerge.AutoMergeDirection.rowColumn:f&&(p=bt.AutoMerge.AutoMergeDirection.row);var y={row:a,col:-1,rowCount:u,colCount:1},m=-1;l.forEach((function(e){var t=e.code,n=e.rowMerge,o=e.colMerge,a=r.findIndex((function(e){return e.code===t}));-1===y.col?y.col=a:m+1===a&&f===n?y.colCount+=1:(s.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g}),f=n,y={row:1,col:a,rowCount:u+1,colCount:1},p=bt.AutoMerge.AutoMergeDirection.column,n&&o?p=bt.AutoMerge.AutoMergeDirection.rowColumn:n&&(p=bt.AutoMerge.AutoMergeDirection.row)),m=a})),(s.length>0&&s[s.length-1]!==y&&y.col>-1||s.length<=0&&y.col>-1)&&s.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g})}return s}({rowMergeColumns:i,colMergeColumns:l,tableColumns:C,row:O.row+1,rowCount:O.rowCount});h.push.apply(h,U(E))}}));var d=e.toJSON();d.spans=Array.isArray(d.spans)?d.spans:[],(t=d.spans).push.apply(t,f),d.autoMergeRangeInfos=h,e.fromJSON(d),p&&e.setDataSource(p),function(e){var t=e.sheet,n=e.rowMerge,r=e.columnMerge,o=t.tables.all();if(o.length>0&&(n||r)){var a=Ct.AutoMerge.AutoMergeDirection.column,i=Ct.AutoMerge.AutoMergeMode.free,u=Ct.SheetArea.viewport,s=Ct.AutoMerge.SelectionMode.merged;n&&r?a=Ct.AutoMerge.AutoMergeDirection.rowColumn:n&&(a=Ct.AutoMerge.AutoMergeDirection.row),t.suspendPaint(),o.forEach((function(e){var n=e.range();t.autoMerge(n,a,i,u,s)})),t.resumePaint()}}({sheet:e,rowMerge:a,columnMerge:i})}))};function kt(t){var a=t.newTabVisible,u=void 0===a||a,s=t.tabEditable,l=void 0===s||s,c=t.tabStripVisible,f=void 0===c||c,h=t.onInited,p=t.onEnterCell,d=t.onActiveSheetChanged,v=t.onValueChanged,g=t.onSelectionChanged,y=t.onSelectionChanging,m=t.onEditorStatusChanged,w=t.onSheetNameChanged,b=t.onSheetNameChanging,S=t.onActiveSheetChanging,C=t.onSheetChanged;t.onFetchData;var O=t.onRowChanged,E=t.onUndo,A=t.onRedo,k=t.license,P=t.enablePrint,T=void 0!==P&&P,M=t.json,j=void 0===M?null:M,I=t.onPrintHandler,R=t.children,N=t.baseUrl,F=t.dataSource,H=void 0===F?null:F,L=t.sumColumns,G=void 0===L?[]:L,B=t.groupColumns,U=void 0===B?[]:B,J=t.rowMerge,z=void 0!==J&&J,Q=t.columnMerge,Y=void 0!==Q&&Q,_=t.rowMergeColumns,X=void 0===_?{}:_,K=t.colMergeColumns,q=void 0===K?{}:K,$=t.template,ee=t.setting,te=t.onColumnWidthChanged,re=t.onRowHeightChanged,oe=t.onLeftColumnChanged,ae=t.onTopRowChanged,ie=t.onViewZoomed;k&&function(e){gt=e}(k),N&&(n=N);var ue=r(),se=gt||"593811994558535#B1dWhJlMLFTUwpXTsV6L03kcLpmNkR5VklDTz9mdnh4SmJ6c98WU9QEVrNDO5kTNOpUb9B7d9l5NjlWWsxmU9hHNmVTb9p5dU5UZmRkZXJlR4d5MENkVat4RKNWZMVlcuNmbph6SxYTUyoVcFBFeIlTe5QFSYhjShpneohmVoZTVhdFdBJGOuFDMsVDW8RjZrB5aQlFbSZVS48UNr5mY62EZ4UWYTFGbxpWZVBVMo3iaCZVNrcmYxlDZzIkWmNVc5FVRCl5KFFDMvMmSjRUUKpkTRRTdV3GOHZVY5llY9IUez2kTalFShN6cjFEOXZEeuVHcWxmWZtWViojITJCLiEkMygjR5UjI0ICSiwCO7YTMxYjM6ATM0IicfJye#4Xfd5nIVF4SRJiOiMkIsIyNx8idgMlSgQWYlJHcTJiOi8kI1tlOiQmcQJCLigDNyADOwAiNxQDM4IDMyIiOiQncDJCLiEjLw8CMucjMxIiOiMXbEJCLig1jlzahlDZmpnInmz9unHZvnfLsonLvlb1kpfbtmD0jnLiOiEmTDJCLiUzM5gTN5QTO9ETM8MTO5IiOiQWSiwSfdtlOicGbmJCLlNHbhZmOiI7ckJye0ICbuFkI1pjIEJCLi4TP7pXe62iNw34KDl5RVpHO8dVW7UESQN7Zl3ycj36V4NzbGJENV5kTtJDdEVjQjFnbutyRVhleuV6ZFVkRZxUdQZmdJlFZHpXWmhWYTZGSIF6LUJjdhZTMjNVVltbcYR";se&&(ue.Spread.Sheets.LicenseKey=se);var le=W(e.useState((function(){var e=yt(),t=!1,n=!1;return e.success||(t=e.showError,n=e.showWarn),{spread:null,showError:t,showWarn:n}})),1)[0],ce=e.useRef(null),fe=e.useMemo((function(){var e=JSON.parse(JSON.stringify(j));return e&&H&&new vt(e,H,$,ee),{json:e}}),[j,H,JSON.stringify($),JSON.stringify(ee)]).json,he=function(){var e=x(D.mark((function e(){var t,n,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!T){e.next=4;break}return t=i("print"),e.next=4,V.loadScript(t);case 4:if(le.spread||!ce.current||ce.showError){e.next=9;break}return n=r(),o=new n.Spread.Sheets.Workbook(ce.current,{sheetCount:0,newTabVisible:u,tabEditable:l,tabStripVisible:f}),le.spread=o,e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(){if(le.spread){var e=le.spread;e.unbindAll(),function(e,t){if(e&&t)for(var n=0,r=Object.entries(t);n<r.length;n++){var o=W(r[n],2),a=o[0],i=o[1];Et(e,a,i)}}(e,{EnterCell:p,ActiveSheetChanged:d,ValueChanged:v,ActiveSheetChanging:S,SheetNameChanged:w,SheetNameChanging:b,SelectionChanged:g,SelectionChanging:y,EditorStatusChanged:m,WorkbookUndo:E,WorkbookRedo:A,RowChanged:O,SheetChanged:C,ColumnWidthChanged:te,RowHeightChanged:re,LeftColumnChanged:oe,TopRowChanged:ae,ViewZoomed:ie})}},de=function(e){if(le.spread){var t=le.spread;o(t,e?function(){t.fromJSON(e),be();var n=t.sheets;n&&n.length>0&&n.forEach((function(e){e.options.sheetAreaOffset={left:1,top:1},e.recalcAll(!0),C&&C("SheetChanged",{sheet:e})}))}:function(){var e;e=R?Array.isArray(R)?R:[R]:[],t.clearSheets();var n=r();e.forEach((function(e,r){var o=e.props,a=o.name,i=void 0===a?`Sheet${r+1}`:a,u=o.rowCount,s=void 0===u?20:u,l=o.colCount,c=void 0===l?20:l,f=new n.Spread.Sheets.Worksheet(i);f.options.sheetAreaOffset={left:1,top:1},f.setRowCount(s),f.setColumnCount(c),t.addSheet(r,f),C&&C("SheetChanged",{sheet:f})}))})}},ve=function(){if(le.spread){var e=le.spread;H&&At({spread:e,dataSource:H,sumColumns:G,groupColumns:U,rowMerge:z,columnMerge:Y,rowMergeColumns:X,colMergeColumns:q})}},ye=function(){if(le.spread){var e=le.spread;I&&I((function(t){return new Promise((function(n,o){e?T?(e.sheets.forEach((function(e){!function(e,t){var n=t.orientation,o=t.printQuality,a=t.scaleType,i=t.fitPagesTall,u=t.fitPagesWide,s=t.zoomFactor,l=t.firstPageNumber,c=t.paperKind,f=t.margin,h=t.headerAndFooter,p=t.showGridLine,d=t.showHeader,v=t.blackAndWhite,g=t.pageOrder,y=t.showBorder,m=t.rowStart,w=t.rowEnd,b=t.columnStart,S=t.columnEnd,C=e.printInfo(),O=function(e,t){we(e)||("string"==typeof t?C[t](e):t(e))};O(n,"orientation"),O(o,"qualityFactor"),we(a)||(1==a?(i=-1,u=-1,s/=100):0==a&&(s=1),C.zoomFactor(s),C.fitPagesWide(u),C.fitPagesTall(i)),O(l,"firstPageNumber"),O(c,(function(){var e=new(r().Spread.Sheets.Print.PaperSize)(parseInt(c));C.paperSize(e)})),O(f,(function(){var e=f.left,t=f.right,n=f.top,o=f.bottom,a=f.header,i=f.footer,u=f.centering;C.margin({left:100*e,right:100*t,top:100*n,bottom:100*o,header:100*a,footer:100*i});var s=null,l=r();s=null!=u&&u.horizontally?null!=u&&u.vertically?l.Spread.Sheets.Print.PrintCentering.both:l.Spread.Sheets.Print.PrintCentering.horizontal:null!=u&&u.vertically?l.Spread.Sheets.Print.PrintCentering.vertical:l.Spread.Sheets.Print.PrintCentering.none,C.centering(s)})),O(null==h?void 0:h.pageHeaderFooter,"pageHeaderFooter"),O(p,"showGridLine"),O(d,(function(){var e=r(),t=d?e.Spread.Sheets.Print.PrintVisibilityType.show:e.Spread.Sheets.Print.PrintVisibilityType.hide;C.showRowHeader(t),C.showColumnHeader(t)})),O(v,"blackAndWhite"),O(g,"pageOrder"),O(y,"showBorder"),m=-1==m||we(m)?0:m,C.rowStart(m),w=-1==w||we(w)?e.getRowCount():w,C.rowEnd(w),b=-1==b||we(b)?0:b,C.columnStart(b),S=-1==S||we(S)?e.getColumnCount():S,C.columnEnd(S),C.repeatRowStart(-1),C.repeatRowEnd(-1),C.repeatColumnStart(-1),C.repeatColumnEnd(-1),e.printInfo(C)}(e,t||{})})),e.print(),n()):o(Error("打印失败，原因：初始化报表时未开启打印功能")):o(Error("打印失败，原因：报表未初始化"))}))}))}},be=function(){var e=le.spread;e.suspendEvent(),e.suspendCalcService(!1),ne(le.spread),e.resumeEvent(),e.resumeCalcService(!0)};return e.useEffect((function(){x(D.mark((function e(){var t;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he();case 2:e.sent?(pe(),de(fe),ve(),ye(),h?(t=h(le.spread))&&t.then&&t.then((function(e){de(e),be()})):be()):be();case 4:case"end":return e.stop()}}),e)})))()}),[fe,H,p,d,v,S,w,b,g,y,m,E,A]),Z.jsxs(Ot,{children:[le.showError?Z.jsx(ge,{}):Z.jsx("div",{style:{width:"100%",height:"100%",overflow:"visible",userSelect:"none"},ref:ce}),!le.showError&&le.showWarn?Z.jsx(me,{}):null]})}var xt=["onInited","ready","dataSource"];function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mt=function(){function n(e){p(this,n),A(this,"conf",{}),A(this,"spread",null),A(this,"printHandler",null),this.conf=e}return y(n,[{key:"mount",value:function(n){var a,i,u,s,l,c=this;r().Spread.Common.CultureManager.culture("zh-cn");var f=this.conf||{},h=f.onInited,p=f.ready,d=f.dataSource,v=E(f,xt),g=null===(a=this.conf)||void 0===a||null===(a=a.json)||void 0===a?void 0:a.reportJson;g&&(g=JSON.parse(JSON.stringify(g)));var y=(null===(i=this.conf)||void 0===i||null===(i=i.json)||void 0===i||null===(i=i.context)||void 0===i?void 0:i.tableDesignSlice)||{},m=y.rowMerge,w=y.columnMerge,b=((null===(u=this.conf)||void 0===u?void 0:u.event)||{}).onFetchData,S=(null===(s=this.conf)||void 0===s||null===(s=s.json)||void 0===s||null===(s=s.context)||void 0===s?void 0:s.datasourceSlice)||{},C=S.sumColumns,A=S.tableGroups,k=S.rowMergeColumns,x=void 0===k?{}:k,P=S.colMergeColumns,T=void 0===P?{}:P;t.createRoot(n).render(e.createElement(kt,Tt(Tt({onInited:function(e){c.spread=e,h&&h(e),"function"==typeof p&&o(e,(function(){p(new O(e))}))},onPrintHandler:function(e){c.printHandler=e},baseUrl:null===(l=this.conf)||void 0===l?void 0:l.baseUrl,onFetchData:b,rowMerge:m,columnMerge:w,sumColumns:C,groupColumns:A,rowMergeColumns:x,colMergeColumns:T,dataSource:d},v),{},{json:g})))}},{key:"exportExcel",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreFormula:!1,ignoreStyle:!1};return new Promise((function(o,a){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".xlsx")?e:e+".xlsx",V.loadScript(i("excel")).then((function(){var i=new(r().Spread.Excel.IO),u=JSON.stringify(t.spread.toJSON());i.save(u,(function(t){L(t,e),o()}),(function(e){a(e)}),{columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeBindingSource:!1,includeCalcModelCache:!1,includeEmptyRegionCells:!0,includeFormulas:!n.ignoreFormula,includeStyles:!n.ignoreStyle,includeUnusedNames:!0,password:void 0,rowHeadersAsFrozenColumns:!1,saveAsView:!1})}))):a(Error("导出excel失败，原因:没有传递导出文件名"))}))}},{key:"exportPdf",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{persistence:!0,author:"",creator:"",keywords:"",subject:"",title:"",sheetIndex:null};return new Promise((function(o,a){if("string"==typeof e&&""!==e.trim()){e=e.endsWith(".pdf")?e:e+".pdf";var u=function(){var r=n.persistence,i=n.author,u=n.creator,s=n.keywords,l=n.subject,c=n.title,f=n.sheetIndex;t.spread.savePDF((function(t){r&&L(t,e),o(t)}),(function(e){a(e)}),{author:i,creator:u,keywords:s,subject:l,title:c},null==f?void 0:f)};r().Spread.Sheets.PDF?u():V.loadScript(i("pdf")).then(u)}else a(Error("导出pdf失败，原因:没有传递导出文件名"))}))}},{key:"print",value:function(e){var t=this;return new Promise((function(n,r){t.printHandler?t.printHandler(e).then(n).catch(r):r(Error("打印失败，原因：报表未初始化"))}))}}]),n}();return{FontStyle:{normal:"normal",italic:"italic"},FontWeight:{normal:"normal",bold:"bold"},HAlign:f,LineBorder:m,LineStyle:c,Preview:Mt,VAlign:h,WorkBook:O,WorkSheet:C}}));
