!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom/client")):"function"==typeof define&&define.amd?define(["react","react-dom/client"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).TOONE=e.TOONE||{},e.TOONE.Report=t(e.React,e.ReactDOM))}(this,(function(e,t){"use strict";var r=".",n=function(){return window.GC},o=function(e,t){if(e){e.suspendPaint(),e.suspendEvent();var r=e.getActiveSheet();try{t(r)}finally{e.resumePaint(),e.resumeEvent()}}},a={print:["print.min.js"],pdf:["print.min.js","pdf.min.js"],excel:["excelio.min.js"]},i=function(e){return a[e].map((function(e){return s(e)}))};var u=function(){var e=n().Spread.Sheets.productInfo.productVersion;return`${r}/vendor/excel/${e}`},s=function(e){return`${u()}/plugins/${e}`},l=n(),c={dashed:l.Spread.Sheets.LineStyle.dashed,dotted:l.Spread.Sheets.LineStyle.dotted,double:l.Spread.Sheets.LineStyle.double,empty:l.Spread.Sheets.LineStyle.empty,thick:l.Spread.Sheets.LineStyle.thick,thin:l.Spread.Sheets.LineStyle.thin},f={center:l.Spread.Sheets.HorizontalAlign.center,left:l.Spread.Sheets.HorizontalAlign.left,right:l.Spread.Sheets.HorizontalAlign.right},h={center:l.Spread.Sheets.VerticalAlign.center,bottom:l.Spread.Sheets.VerticalAlign.bottom,top:l.Spread.Sheets.VerticalAlign.top};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function y(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var m=function(){function e(t,r){p(this,e),this.color=t,this.style=r}return y(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStyle",value:function(e){this.style=e}},{key:"getStyle",value:function(){return this.style}},{key:"_to",value:function(){return new(n().Spread.Sheets.LineBorder)(this.color,this.style)}}]),e}();document.createElement("span");var w=function(e,t){return null==e?t:e},b=function(e,t,r){var o=n(),a=r.fontWeight,i=r.fontStyle,u=r.fontFamily,s=r.fontSize,l=r.textDecoration,c=r.backColor,f=r.foreColor,h=r.wordWrap;!function(e,t,r){for(var n=e.col,o=e.row,a=e.rowCount,i=e.colCount,u=0;u<a;u++)for(var s=0;s<i;s++)r(t,o+u,n+s)}(t,e,(function(e,t,r){var n=new o.Spread.Sheets.Style,p=e.getStyle(t,r),d=function(e){var t="normal",r="normal",n="normal",o="Calibri";if(e)for(var a,i=e.split(/\s+/);a=i.shift();)switch(a){case"normal":break;case"italic":case"oblique":t=a;break;case"small-caps":r=a;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":n=a;break;default:o=a,i.length&&(o+=" "+i.join(" "))}return{fontStyle:t,fontVariant:r,fontWeight:n,fontSize:11,lineHeight:"normal",fontFamily:o}}(p.font);Object.assign(n,p),u=w(u,d.fontFamily),s=w(s,d.fontSize),i=w(i,d.fontStyle),a=w(a,d.fontWeight),l=w(l,p.textDecoration),c=w(c,p.backColor),f=w(f,p.foreColor);var v=function(e){return e&&-1===e.indexOf("'")&&-1===e.indexOf('"')?`"${e}"`:e}(u),g=function(e){var t=e.fontFamily,r=void 0===t?"":t,n=e.fontStyle,o=void 0===n?"":n,a=e.fontVariant,i=void 0===a?"":a,u=e.fontWeight,s=void 0===u?"":u,l=e.fontSize,c=void 0===l?"":l,f=e.lineHeight,h=[o,i,s,c,void 0===f?"":f,r].join(" "),p=document.createElement("span");return p.style.font=h,p.style.font}({fontFamily:v,fontSize:s?`${s}pt`:"",fontStyle:i,fontWeight:a});n.font=g,n.textDecoration=l,n.backColor=c,n.foreColor=f,n.wordWrap=h,e.setStyle(t,r,n)}))},S=function(){function e(t,r){p(this,e),this.sheet=t,this.cellRange=r}return y(e,[{key:"hAlign",value:function(e){this.cellRange.hAlign(e)}},{key:"vAlign",value:function(e){this.cellRange.vAlign(e)}},{key:"setBorder",value:function(e,t){this.cellRange.setBorder(e,t)}},{key:"fontFamily",value:function(e){b(this.sheet,this.cellRange,{fontFamily:e})}},{key:"fontSize",value:function(e){b(this.sheet,this.cellRange,{fontSize:e})}},{key:"fontStyle",value:function(e){b(this.sheet,this.cellRange,{fontStyle:e})}},{key:"fontWeight",value:function(e){b(this.sheet,this.cellRange,{fontWeight:e})}},{key:"wordWrap",value:function(e){b(this.sheet,this.cellRange,{wordWrap:e})}}]),e}(),C=function(){function e(t){p(this,e),this.sheet=t}return y(e,[{key:"name",value:function(e){this.sheet.name(e)}},{key:"getCell",value:function(e,t){var r=this.sheet.getCell(e,t);return new S(this.sheet,r)}},{key:"getRange",value:function(e,t,r,n){var o=this.sheet.getRange(e,t,r,n);return new S(this.sheet,o)}},{key:"addSpan",value:function(e,t,r,n){this.sheet.addSpan(e,t,r,n)}},{key:"addRows",value:function(e,t){this.sheet.addRows(e,t)}},{key:"addColumns",value:function(e,t){this.sheet.addColumns(e,t)}},{key:"setValue",value:function(e,t,r){this.sheet.setValue(e,t,r)}},{key:"setFormula",value:function(e,t,r){this.sheet.setFormula(e,t,r)}},{key:"setRowCount",value:function(e){this.sheet.setRowCount(e)}},{key:"setRowHeight",value:function(e,t){this.sheet.setRowHeight(e,t)}},{key:"setColumnCount",value:function(e){this.sheet.setColumnCount(e)}},{key:"setColumnWidth",value:function(e,t){this.sheet.setColumnWidth(e,t)}},{key:"setDefaults",value:function(e){Object.assign(this.sheet.defaults,e)}},{key:"setOptions",value:function(e){var t=e.colHeaderVisible,r=void 0===t||t,n=e.rowHeaderVisible,o=void 0===n||n,a=e.showHorizontalGridline,i=void 0===a||a,u=e.showVerticalGridline,s=void 0===u||u,l=e.isProtected,c=void 0!==l&&l;Object.assign(this.sheet.options,{colHeaderVisible:r,rowHeaderVisible:o,isProtected:c}),Object.assign(this.sheet.options.gridline,{showHorizontalGridline:i,showVerticalGridline:s})}}]),e}(),O=function(){function e(t){p(this,e),this.spread=t}return y(e,[{key:"addSheet",value:function(e){this.spread.addSheet(e)}},{key:"getSheet",value:function(e){var t=this.spread.getSheet(e);return t?new C(t):null}},{key:"setOptions",value:function(e){var t=e.newTabVisible,r=void 0===t||t,n=e.tabStripVisible,o=void 0===n||n,a=e.showHorizontalScrollbar,i=void 0===a||a,u=e.showVerticalScrollbar,s=void 0===u||u;Object.assign(this.spread.options,{newTabVisible:r,tabStripVisible:o,showHorizontalScrollbar:i,showVerticalScrollbar:s})}}]),e}();function E(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function A(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t,r,n,o,a,i){try{var u=e[a](i),s=u.value}catch(l){return void r(l)}u.done?t(s):Promise.resolve(s).then(n,o)}function x(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){k(a,n,o,i,u,"next",e)}function u(e){k(a,n,o,i,u,"throw",e)}i(void 0)}))}}function T(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var M={exports:{}},P={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(P);var j=P.exports;!function(e){var t=j.default;function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=r=function(){return o},e.exports.__esModule=!0,e.exports.default=e.exports;var n,o={},a=Object.prototype,i=a.hasOwnProperty,u=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(F){h=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),i=new R(n||[]);return u(a,"_invoke",{value:M(e,r,i)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}o.wrap=p;var v="suspendedStart",g="suspendedYield",y="executing",m="completed",w={};function b(){}function S(){}function C(){}var O={};h(O,l,(function(){return this}));var E=Object.getPrototypeOf,A=E&&E(E(D([])));A&&A!==a&&i.call(A,l)&&(O=A);var k=C.prototype=b.prototype=Object.create(O);function x(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,r){function n(o,a,u,s){var l=d(e[o],e,a);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==t(f)&&i.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,u,s)}),(function(e){n("throw",e,u,s)})):r.resolve(f).then((function(e){c.value=e,u(c)}),(function(e){return n("throw",e,u,s)}))}s(l.arg)}var o;u(this,"_invoke",{value:function(e,t){function a(){return new r((function(r,o){n(e,t,r,o)}))}return o=o?o.then(a,a):a()}})}function M(e,t,r){var o=v;return function(a,i){if(o===y)throw new Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:n,done:!0}}for(r.method=a,r.arg=i;;){var u=r.delegate;if(u){var s=P(u,r);if(s){if(s===w)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===v)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=y;var l=d(e,t,r);if("normal"===l.type){if(o=r.done?m:g,l.arg===w)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function P(e,t){var r=t.method,o=e.iterator[r];if(o===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),w;var a=d(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,w;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,w):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(i.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=C,u(k,"constructor",{value:C,configurable:!0}),u(C,"constructor",{value:S,configurable:!0}),S.displayName=h(C,f,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,h(e,f,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},x(T.prototype),h(T.prototype,c,(function(){return this})),o.AsyncIterator=T,o.async=function(e,t,r,n,a){void 0===a&&(a=Promise);var i=new T(p(e,t,r,n),a);return o.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},x(k),h(k,f,"Generator"),h(k,l,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},o.values=D,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return u.type="throw",u.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),w}},o}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(M);var I=(0,M.exports)(),R=I;try{regeneratorRuntime=I}catch(jt){"object"==typeof globalThis?globalThis.regeneratorRuntime=I:Function("r","regeneratorRuntime = r")(I)}const D=T(R);var F=function(e){return e?"string"==typeof e&&(e=[e]):e=[],e},N=function(){function e(){p(this,e),this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptMaps={},this._dataPromises={}}var t,r,n,o,a,i,u,s;return y(e,[{key:"loadScript",value:(s=x(D.mark((function e(t){var r,n,o,a=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],(t=F(t)).forEach((function(e){(n=a._scriptMaps[e]=a._scriptMaps[e]||{}).promise||(n.path=e,n.promise=new Promise((function(t){(r=a.createScriptElement()).setAttribute("type","text/javascript"),r.src=e,r.addEventListener("load",t),a._head.appendChild(r)}))),o.push(n.promise)})),e.abrupt("return",Promise.all(o));case 4:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"unloadScript",value:(u=x(D.mark((function e(t){var r,n=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=F(t)).forEach((function(e){(r=n._head.querySelectorAll('script[src="'+e+'"]')[0])&&(n._head.removeChild(r),delete n._scriptMaps[e])})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"createScriptElement",value:function(){return document.createElement("script")}},{key:"fetchData",value:(i=x(D.mark((function e(t){var r,n,o=arguments;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:{},n=t+JSON.stringify(r),r.cache=void 0===r.cache||r.cache,t){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:if(this._dataPromises[n]&&r.cache){e.next=16;break}return e.prev=6,e.next=9,fetch(t,r);case 9:this._dataPromises[n]=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),this._dataPromises[n]=null,e.t0;case 16:return e.abrupt("return",this._dataPromises[n]);case 17:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e){return i.apply(this,arguments)})},{key:"loadCss",value:(a=x(D.mark((function e(t){var r=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=F(t)).forEach((function(e){if(!r._cssPaths[e]){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),r._head.appendChild(t),r._cssPaths[e]=t}})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"unloadCss",value:(o=x(D.mark((function e(t){var r,n=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){(t=F(t)).forEach((function(e){(r=n._cssPaths[e])&&(n._head.removeChild(r),n._cssPaths[e]=null)})),e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadTemplate",value:(n=x(D.mark((function e(t,r){var n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.next=4,this.fetchTemplate(t);case 4:if(n=e.sent,!r){e.next=8;break}return r.innerHTML=n,e.abrupt("return",r);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchTemplate",value:(r=x(D.mark((function e(t){var r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"flush",value:(t=x(D.mark((function e(){var t,r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadCss(Object.getOwnPropertyNames(this._cssPaths));case 2:this._cssPaths={},e.t0=D.keys(this._scriptMaps);case 4:if((e.t1=e.t0()).done){e.next=12;break}if(t=e.t1.value,!this._scriptMaps.hasOwnProperty(t)){e.next=10;break}return r=this._scriptMaps[t],e.next=10,this.unloadScript(r.path);case 10:e.next=4;break;case 12:this._scriptMaps={},this._dataPromises={};case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),V=new N;function H(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");e.dispatchEvent(t)}}function L(e,t){var r=window.URL||window.webkitURL,n=document.createElement("a");n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin==window.location.origin?H(n):function(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return 200<=t.status&&t.status<=299}(n.href)||(n.target="_blank",H(n))):(n.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(n.href)}),4e4),setTimeout((function(){H(n)}),0))}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e,t){if(e){if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(e,t):void 0}}function U(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,u=[],s=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(u.push(n.value),u.length!==t);s=!0);}catch(c){l=!0,o=c}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return u}}(e,t)||B(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J,Q={exports:{}},z={};Q.exports=function(){if(J)return z;J=1;var t=e,r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var u,s={},l=null,c=null;for(u in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,u)&&!i.hasOwnProperty(u)&&(s[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps)void 0===s[u]&&(s[u]=t[u]);return{$$typeof:r,type:e,key:l,ref:c,props:s,_owner:a.current}}return z.Fragment=n,z.jsx=u,z.jsxs=u,z}();var Z=Q.exports,Y=n();function _(){this.name="TOONE.GET",this.maxArgs=2,this.minArgs=1}_.prototype=new Y.Spread.CalcEngine.Functions.Function,_.prototype.evaluate=function(e){return"[函数(Fx)]"};var X=n();function K(){this.name="TOONE.GROUPNAME",this.maxArgs=0,this.minArgs=0}K.prototype=new X.Spread.CalcEngine.Functions.Function,K.prototype.description=function(){return{description:"获取分组名称",parameters:[]}},K.prototype.evaluate=function(e){return"[函数(Fx)]"};var q=n();function $(){this.name="TOONE.PAGECOUNT",this.maxArgs=0,this.minArgs=0}$.prototype=new q.Spread.CalcEngine.Functions.Function,$.prototype.description=function(){return{description:"获取总页数",parameters:[]}},$.prototype.evaluate=function(e){return"[函数(Fx)]"};var ee=n();function te(){this.name="TOONE.PAGEINDEX",this.maxArgs=0,this.minArgs=0}te.prototype=new ee.Spread.CalcEngine.Functions.Function,te.prototype.description=function(){return{description:"获取当前页",parameters:[]}},te.prototype.evaluate=function(e){return"[函数(Fx)]"};var re=function(e){!function(e){var t=new _;e.addCustomFunction(t);var r=new $;e.addCustomFunction(r);var n=new te;e.addCustomFunction(n);var o=new K;e.addCustomFunction(o)}(e)};const ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABkCAYAAACWy14QAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlBNDFDQzUzRkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlBNDFDQzU0RkQyOTExRTg4NUQ4ODBGMTZCQjVFMjE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUE0MUNDNTFGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUE0MUNDNTJGRDI5MTFFODg1RDg4MEYxNkJCNUUyMTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52RmQBAAAR1klEQVR42uxdC7hV0xae51Hp5XZKhfJIcrkckUJ187w3t6S4JNGVbhRfpAei9FAeSbiU9yMihOQRpUh0c1OhSHI66dKTUEpC7jnmf8+/WM095lpz77324xyN7xtf7bXW3mut+c85xj/GHHOenNLSUuUqD01fpX4ncqjW+7U20fq01uFav072R3u2ayQez1W7xJQ9tE7R2kprXa19tL6idZ9U3XAXCDvLnuz5fzSOH631pVQBkV/BG7VAa2OtDdjhVmtdqXWzVr8drqy1ndbrtR5m+a2mWl/UeprWNbtACJe2Ws/jv7XZyJCfCMByreuo9bU2F3q/JEf4gFi7CwRZCrXepPVUy3mAUY/qIhsIUo7v2JEEomNUQFQkn/BPrXMCAIhXRtE09dRaYpxrRiD23gVCmaCXjgaDpumJQiZpHUZaOkHrjcI1kQGRXwEAuFPrpZbz27TO1vqO1lXs0QDqKK2n0GHbzJBfhtEsXWQcx++8QNO0/vcIQhAAP2q9S+s9Wost30ej9tU6UGsV49wlWosYsCkyqd78vwlEc5+z3pCt5ugU2tfLtdaKEIB/WQD4mHRzYAAAkC+0DmEvXmecq6b1Pt5DGUA8JPxWc46IPbMRhLFaZ2i9li+E/zeKCIC+wjlEtidofSOO35sZQDnRcW4zgMBIeFi49mgCUT+bQLiVvdEvx2idmoQDzWGj9LU4079r/TKB331P61+0LhPO9ee7xANEvWwAAQ89ICDyfI7RbCIjq59wHL7hfPqCRGU5TdPHwjm8yy2+zyUE4hHhWnS055l3yhgIYwMA8OT4BIAYZPndO2k2SiJ49pU0TQuFc1cIQCCGeFS4tiVHRN1MgHCLYIJsAts9xdGGDmQsIJmgyyN+BwDRXuu/LUCMEYCYaAECI2KPdIIwhg9pyqc0T08L507U+ipTATYKPZZqyquMklMhX9G/zBPOXan1Zt/n//E5HhOubeUCRFQg3MyHMwW96TiC04UsSfIRbzIg8kefh9OJSyPrM60XqrKEXKpko9aztH4gnLuK6geih9bHhWtbh5GRnAhm1kbTXpuCXnQGX8YvI7UOtdxiPRlKdVWWjKsuXPMze+lLaQoKD+K9DhLOdaNJ9I/cCTxuylytp/ds1+ibqEfCTRYA3mZDbRTOjWAkK8leWk/WeqwFAMizDgDgvQ7QmhcBCEVkTSuEc/eSDfk7CEbEOOHaNhgRuiPXjhIEJLWutjz0uQF8Hc6sj4XehckWghgkdekvFmidT3OQrHyi9RyhU9Xge9QxgEAcc7vwO8cRiIIoQLhB6zXC8RXsNZ+FfL+Uzgx+4Ls47vsiGyRILmDgVYfphPFaK0UABAK6s7V+bxw/mD0/R4gtRliAeM4PRCIgYApwsHC8mAB84vg7pcwpteSoQvpgFp3bE1q3C77gQYffPc74XEtI0CUqc7R2F2KSrnTiplxnsRb/p+caiFqJOOZRFoZTzCBneYQOcQaTf36T0EzoiabMN+z0W3zp0gifzQzcvPiiGU2mKcMIiClIs5+RGwcAIy0A4OadIgYA8q3xeZkDAFW11jSOLYkYAC8rMMk4hoIC27zGKPopU07SOjzXEYDrLLRyJU3QshRQwwKhh7t8x/xePZUaQVxkpsAvswRmpcwOSHJargMAIzicpEi4U4oAyBMab7XD92oKI6G1wV6ikvUqdtpzTwalktii5o9yQwBA+d9w4dQqjoCPUtTLagiNuckRhGrGsYYW5xiFTFSxE0cXCWzsSCWn39cGmiMNwFALxSrmCEgVAJA/EAi/uNSC1rEwvgGkrlHLViEnVmjkwpAMnKZiZ93WMYL+IF9o/JyASPh9rWdyJKRSCgiEX1wmghoERNCYrtwhONRk5Rm2VZ7vXq0ZLPZnWqeyYFrP1AAs8nIdJgCYIL/EAgBM0BqVeikQuL0LCEFOGA3hzYZFCcRy+sVCIw6AM75NuH4ZAVhuC9bGWQBYQhOUDgCUMApcZa+Q8x4QXSN81h+0vmsca29JW2DWrqMfgF9BwAjQOp45HXEE6C+uVukTqUd/n+D3EG9sM4CYwERbVPKh8TnfMmLQjislWwkZYwEA+ZIO+oufq/SKVBqzOgEQ8B1kZDsbqYYqHBH9I3reMJqOxN85uh3FEpxcPQJOV/KMGOpyztZfXKfSL/UFTh5WWJUr0NpV7IHTSR3NyBk2u18Ez7tG2ee4vZm3JUEP3tNy7mFp6GTIHK1X8tyEXzD/sLvAw399nwAgkp2n3hwAwl2kqIG95wfLua9V5qRAeJYdId/ZXQDBHD2onutlAJFDJ5oMEDsMv+PJJ5ZgNwYElIxI9ToXalNVN0MgVBVe0oVR1Q4YCZ4gHd7bOOYBcVkSDGmTZRRsDgVBm5y5NEkmEJismKaBaJwBELYKpiZMDhJiC1tQ+YDWiwUg7lD2TGiQVBFG7yYlV5iIIwFLOxG8dBNME8r6xmsg0l29vUroEGHZ0E7GZ3SqFQHXI4K+VgDizgSA2EMwha+R3LiBQCAwgS7V9xwimIdUy9sCW+oTcD3WkpkzW0UhIEAwTTvSAkQ8rKmBip3enO765VzBcW0TOO6PGQDBLBQYTCdX12gwTI8+pWITfpMCSIdfhluAgI+4PsFIHW34ZqIggE2Yc7vrHB1jlLKO5sKMQkcwgkfJy2QO+TkqduXlWiVXTQcBMUo4PkQASBKz3B9pjE9db54vMAwzF/6NNlWlKv0C/o6EYVNh6DcI+e4Ah7jClGEcAaafGMpOcW/Adw82Pj8fz43NkYAV69UEc5QJAbXrKuRllAMATyd4TzT43cJx1NKebPlOTaZG/HR1RjIgNBBGwgaVOfGWPk108EtLyZBuT/KeyCc9YhxDx3xc6PEQ1Djt7/u8UMlrHJzN0V42usi5Bux68meykTpsGNjoZ1IIFuw7an2QZu+gygq6GrGzoK5zsSora0Fh2HcR3O8nRtU5vK8nmBnzVmp6tVUIDq9LxhRJIJiT0Si4QpIPOZcuBMAMiHrQBFxFMFIli6iQymykn5kgi1p2MM8ES/EPIyB8hf5jI4lCoQHg3GRB2FswV486RKz70w4PiMAcuPbWVMsOZhJASs73HT9AySXwXo4r7vqr3JCRkOuYMvAzmh6q4og3Il5wvP5zIeXiDoI2OXnKfR0uZrm2KLmyDdFmmwoExE/sWK87XFsiRM5xjYRKDvx7I+1hIU0QmMFU45oaDJT2rUBAIBnX2QGISiqBkku/T6iugivV5pI1+G3ebCrSHf71YwfygSczsbUf77Wd9G0WGU15BAI5tpMs1+A9C5RbodpvORKvKlubIxQszVexNTKKjKCrkiuOIY1JFWs43heMBktoB6nU1zBFLbUJxImW851Il2PEZSPC/S0AIPrrqn9gS8CDYRq0KI4XyWOvmmUJgLJZvuGz2wqUL07GJ0ib7CEJ1T0EAH/vjlcwgp6IYwRli4CKYvmUVAraTtmLgp1GgimDNQAue0W0MIIWyZ+8YImqYQavLYfOGkvCsDBmmYWqN0kEBHNmaIUjP4bDxeTIbhYz1Zb2E6U1WMlyh3AdJtlPKYdArCIQHwlB7xTluIVnfkD0/KVjZAoA/iocX8Ih62dTKF3pR5/gn0LcjVT3SVVWcFbiYySLVfSrgKIUb50G5jgO8R0vpIP+mwqZ5vQ3vDmZg+GENO23Ad8fpXZe2e7JAvZ825ZkQ3m+oe9YVdJcc6sERKCYacOuAW9kKRDexiQgGn4KdARjpo5BPjPXGFp+wcT6uZbvgQvfa7HlaKgzVPCecJgrmOf4gjVpql5T9p0AsgWIzoLfax/mqP0gzBTQukXHD921enMMldnACMR6C783R8nbmUmyewJMbmSWA4FpTamk9NygdMZOS2h1Y8OudRCue59Iw+YdavmtRbSNLgA0ZcRsA+JLAm7bM+8EFcdEepqlEv3Yn3zH4BMaaaa5PWwkQK5hMCLRyLMCAHiPNt4FACQJJ1gAWEbTA1t6OJ33V8J1V6vs3dMVmVdzSraKCshG5xph9VLatXgqsYtpoly2LK5FxiDtb/QO6exM+hOUtaOM8FQVWxfbhoFeOuVIjsAw8L3NTUxgtjuBQCCQkMPWBJNU+JZm+GFMeLisX6hBCtrCwqZsQC4QCED1gFGZCrmYROINUtGgXYFB148yjhXFBQKBWKkVZZGoIrhV2Vdq/ofqYifHkzOb8mYInfVIwxYhIEqHgEaPU79VIYLtTBcaGoL57/uEdp0W1KEDh5YGYqFWePuW7I1mrtx1Yh1Tnt2F4y+TX4dtcZwjsIt0VQWWCEEr/BUsBir0sKkitlnDCn9snbCfcS182uOuFDUIjK1ab6DdNllO2CI/0Mo+FgC6KLfpwDNV7CqcvDSBAP843EKxh5CWY5s5LDmTVpiC7KxJGgSfmEWuQN02p1yVQ1Pi9a8wpbHN4Z6t+bLS8XQJCqVvDBmpypLIC90eKF4QZggBHRae91U7l643ZUP3sgDZxdGUHUCCINHZs1VsOXwqZYhyr6wDzR+oHLcnjReEBYJ9Q/INmVFUns2nE51DOmfK63EAADb1hGBj/fedzB5aM01AjFBltU42KWLvb6XkheShCTxX6c+GMRt5XxU8uY+ou5ujD6jOBj4m5LoqtLkoSkOR1mcpBmEpc2xNhMYfRse8Od4fTSTq3MT80APKvbJgMU2HS6lkNQLQPo5nasMgMNE1dgj8XHL/eSp2wcx/GWROTgSAREFQ7M29SC/fdbCP5ym3xeBV+TLS38VB1DyLKlFa0MbRCbzLBTSz0EtCrm2ndk6/e843qRGYbP7lZZqCfpYcD+Q15bYxlQeAlEB8kZF2W2oLpjRMgbk7LI7nP5QjujZzWncTyFwLyGOFjMH0ZG1cFEmwH+iYj1XyJt8ue1LAjEzlyDJlIvNZ/vkOpDeQ3JtgXFs5TsZUIPjFQWxY+Lz67PkX0N43FHxEcTaA4AlS3dgV2NyS8ygVvCUmnDzmsqU5ZmwC3lPZp1lvFXIyreJke9IGgW2ZJ1pInaDkEtE7omi4qNPBKJM0JzUKlb0WpwVpa0vh3DgCEEQJ0QvNtWHx/JUSgNs7oDfvo+z1uaDPT2UjCF6yygxqbuQwr+9jGZ3pU6SU9F0MAMMWLCKWqCWQhngETjWoutCUHRwBF6mI1kakapE4Vq9gjVclH+0czRxSERvvmIAeNsDxPmArZhHzewk87yKanMuN55hFM9mYKRYEo88p+S+NZB0I8+lQewrDO4iPP8lclEupTUNLXurlBJ95qgEC/BQWvjyS6jA8lVOEgxglu8qsOACoRzpr/k2D2Sq2RtS1o21LY9uk7UZfky669Myv6Lxd5gjq0iS0Ejj71YYf6UHajPKcsA1qOwjPVO5BUIyS8XLHM9CxVW7PVm4r4D0ApDT2lYatBs9/kL6nN1lYU8vvgkZfpjIk6Rpyb7GRsGvMJMtIcDFBUxihmzJGiKBbG+/XlDHBheq3bXEQv2Bu+yWD2m5XEf7R62wBwZNvGema1RxHhzzLgYxi21gAGGRx0Kadr880BYI0zHfM48gy12+/q9z/DkS5AwGymSzIL80DzEET5o6aCecGWwCALFb2LdUOJL2VJusxpzxCRfPH87IWBEVmE1NyyVHi7a2RQ46OEXCI8Bv4I6g3hdwHa+lujuO5Shjxv57OxsgUCAiOZhrHKjFVMY85o9kEwFbk5ZoyGOloWkCnkUK/Pd2NkSkQSmlGpLJ7lEB2I7sJWhPczfFe3yv7YpdisrZOpLwzMtEYmfzL5B8yNngswee4lIHdFSp8hk+aBMIow2TTJpVhyXRRLUwKqu8SXYmDHNN9DtcdbnzGHMhV2QBApkeCn0piYSGyqifRB8BBriCVRMBXmUwGHN/cf8Pb9be35fdhZs4SfNJSlSWSnyXPsYVM5iGfHzBNzLM8f7+KXcjdiwGYuTj9BJo7syRmisoiyVfZJ0H23SvDhxkzi4sxklBNPo2xCNaOdRTe8QsV0WRMRQbBJeo+h0zmWCEi7ulAWTdk0wvlqvIpAAJlkHPi/B7K8+/JtpcpryAoOuyO9BNhgp7fj6mR0mx7kXxVvmUrGRNmwFA+j0QgMqPIgm5kfLCQwdrabH2JXwQYAO1UPxYIHgsFAAAAAElFTkSuQmCC";var oe=["children"],ae=["children"],ie=["children"];function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var le,ce=function(e){return function(t){var r=t.children,n=E(t,oe);return Z.jsx("div",se(se({style:e},n),{},{children:r}))}},fe=function(e){return function(t){var r=t.children,n=E(t,ae);return Z.jsx("span",se(se({style:e},n),{},{children:r}))}},he=ce({color:"#6a6a6a",textAlign:"center",verticalAlign:"middle",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"440px",whiteSpace:"nowrap"}),pe=(le={display:"inline-block",width:"100px",height:"105px",verticalAlign:"middle"},function(e){var t=e.children,r=E(e,ie);return Z.jsx("img",se(se({style:le},r),{},{children:t}))}),de=fe({display:"inline-block",paddingLeft:"10px",textAlign:"left",verticalAlign:"middle",fontSize:"14px"}),ve=fe({display:"inline-block",fontSize:"20px",fontWeight:"600",opacity:"0.8"});function ge(){return Z.jsxs(he,{children:[Z.jsx(pe,{src:ne}),Z.jsxs(de,{children:[Z.jsx(ve,{children:"未找到有效许可证！"}),Z.jsx("br",{}),"获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询。"]})]})}var ye=ce({position:"absolute",bottom:"50px",right:"50px",color:"#6a6a6a",zIndex:"999",textAlign:"right",fontSize:"14px",pointerEvents:"none"});function me(){return Z.jsxs(ye,{children:["获取正式商业授权涉及费用，收费标准请发送邮件到",Z.jsx("br",{}),"vdept@toone.com.cn咨询"]})}var we=function(e){return null==e},be=function(e){return"string"==typeof e&&e.trim().length>0};function Se(e,t){return(Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Se(e,t)}function Oe(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e){return n().Spread.CalcEngine.ExpressionType[e]}function ke(e){return{lMt:!0,type:Ae("string"),value:e}}function xe(e){return{lMt:!0,originalValue:e+"",type:Ae("number"),value:e}}function Te(e){switch(typeof e){case"number":return xe(e);case"boolean":return function(e){return{lMt:!0,type:Ae("boolean"),value:e}}(e);default:return ke(we(e)?"":e)}}var Me=function(e){return n().Spread.Sheets.CalcEngine.formulaToExpression(null,e,0,0)};var Pe=function(e,t){switch(e.functionName){case"TOONE.GET":return function(e,t){var r,n,o,a=e.arguments;if(!a||0==a.length)throw Error("TOONE.GET函数未传递参数，请检查配置！");n=a[0].value,o=null===(r=a[1])||void 0===r?void 0:r.value;var i=t.getValue(n,o);return"text"==i.type?Te(i.value):Me(i.value)}(e,t);case"TOONE.PAGECOUNT":return function(e,t){return xe(t.getPageCount())}(0,t);case"TOONE.PAGEINDEX":return function(e,t){return xe(t.getPageIndex())}(0,t);case"TOONE.GROUPNAME":return function(e,t){return ke(t.getGroupName())}(0,t)}return null},je=function(){function e(t){p(this,e),this.ast=t}return y(e,[{key:"getAST",value:function(){return this.ast}},{key:"parse",value:function(e){return this.ast}},{key:"toParser",value:function(e){return e&&"number"==typeof e.type?He(e):null}},{key:"parseValue",value:function(e,t){var r=this.toParser(e);return r?r.parse(t):e}},{key:"_getVisitChildren",value:function(){return[]}},{key:"_getVisitHandlerName",value:function(){return null}},{key:"visit",value:function(e){var t=this,r=this._getVisitHandlerName(),n=e[r],o=!0;("function"==typeof n&&(o=!1!==n.call(e,this)),o)&&this._getVisitChildren().forEach((function(r){var n=t.toParser(r);n&&n.visit(e)}))}}]),e}();function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ee(e);if(t){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}var Re=function(e){Ce(r,e);var t=Ie(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"parse",value:function(e){var t=this,r=this.getAST(),n=Pe(r,e);if(null!==n)return n;var o=r.arguments;if(Array.isArray(o)){var a=o.map((function(r){return t.parseValue(r,e)}));r.arguments=a}return r}},{key:"_getVisitHandlerName",value:function(){return"visitFunction"}},{key:"_getVisitChildren",value:function(){var e=this.getAST().arguments;return Array.isArray(e)?e:[]}}]),r}(je);function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ee(e);if(t){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}var Fe=function(e){Ce(r,e);var t=De(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t.value2=this.parseValue(t.value2,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitOperator"}},{key:"_getVisitChildren",value:function(){var e=this.getAST();return[e.value,e.value2]}}]),r}(je);function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ee(e);if(t){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}var Ve=function(e){Ce(r,e);var t=Ne(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"parse",value:function(e){var t=this.getAST();return t.value=this.parseValue(t.value,e),t}},{key:"_getVisitHandlerName",value:function(){return"visitParentheses"}},{key:"_getVisitChildren",value:function(){return[this.getAST().value]}}]),r}(je),He=function(e){var t=e.type,r=n().Spread.CalcEngine.ExpressionType;switch(t){case r.operator:return new Fe(e);case r.function:return new Re(e);case r.parentheses:return new Ve(e);default:return new je(e)}},Le=function(){function e(t){p(this,e),this.handlers=t}return y(e,[{key:"_visit",value:function(e,t){var r=this.handlers[e];if(r)return r(t)}},{key:"visitFunction",value:function(e){return this._visit("function",e)}},{key:"visitOperator",value:function(e){return this._visit("operator",e)}},{key:"visitParentheses",value:function(e){return this._visit("parentheses",e)}}]),e}(),Ge=function(){function e(){p(this,e)}return y(e,[{key:"setFieldIndexHandler",value:function(e){this.fieldIndexHandler=e}},{key:"setDataCountHandler",value:function(e){this.dataCountHandler=e}},{key:"setPageHandler",value:function(e){this.pageHandler=e}},{key:"setTotalPagesHandler",value:function(e){this.totalPagesHandler=e}},{key:"setUnionDatasourceHandler",value:function(e){this.unionDatasourceHandler=e}},{key:"setDataIndex",value:function(e){this.dataIndexHandler=e}},{key:"setValueHandler",value:function(e){this.valueHandler=e}},{key:"setSettingHandler",value:function(e){this.settingHandler=e}},{key:"setGroupNameHandler",value:function(e){this.groupNameHandler=e}},{key:"setIsGroupSumAreaHandler",value:function(e){this.isGroupSumAreaHandler=e}},{key:"getFieldIndex",value:function(e,t){return this.fieldIndexHandler(e,t)}},{key:"getDataIndex",value:function(e,t){return this.dataIndexHandler(e,t)}},{key:"getDataCount",value:function(e){return this.dataCountHandler(e)}},{key:"getUnionDatasource",value:function(){return this.unionDatasourceHandler()}},{key:"getPage",value:function(){return this.pageHandler()}},{key:"getTotalPages",value:function(){return this.totalPagesHandler()}},{key:"getPageIndex",value:function(){return this.pageHandler()}},{key:"getPageCount",value:function(){return this.totalPagesHandler()}},{key:"getValue",value:function(e,t){return this.valueHandler(e,t)}},{key:"getGroupName",value:function(){return this.groupNameHandler()}},{key:"isInGroupSumArea",value:function(){return this.isGroupSumAreaHandler()}},{key:"getSetting",value:function(){return this.settingHandler()}}]),e}(),Be=function(){function e(t){p(this,e),this.plugin=t}return y(e,[{key:"getConfig",value:function(){return this.plugin?this.plugin.config:null}},{key:"execute",value:function(e,t){return e}}]),e}();function Ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ee(e);if(t){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}var Je=[["url",""],["mode",1],["height",0],["width",0],["clipX",0],["clipY",0],["clipHeight",0],["clipWidth",0],["vAlign",1],["hAlign",1]],Qe=function(e){var t=["IMAGE("];return Je.forEach((function(r){var n,o=void 0;Array.isArray(r)?(n=r[0],o=r[1]):n=r;var a=e[n];a=a===o?void 0:a,t.push(function(e){return we(e)?"":e}(a)),t.push(",")})),t.pop(),t.push(")"),t.join("")},ze=function(e){Ce(r,e);var t=We(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"execute",value:function(e,t){var r=this.getConfig(),n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({url:"formula"==e.type?e.value:`"${e.value}"`},r);return{type:"formula",value:Qe(n)}}}]),r}(Be);function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ee(e);if(t){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}var Ye=function(e){Ce(r,e);var t=Ze(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"execute",value:function(e,t){return{type:"text",value:t.getPage()}}}]),r}(Be),_e=null,Xe=function(){if(null==_e){var e=new(n().Spread.Sheets.Workbook);_e=e.getSheet(0)}return _e},Ke=function(e){if(0==e.length)return 0;var t=e.join("+"),r=Xe();return GC.Spread.Sheets.CalcEngine.evaluateFormula(r,t)};function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ee(e);if(t){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}var $e=function(e){Ce(r,e);var t=qe(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"groupSubTotal",value:function(e,t){var r,n,o,a=this.getConfig(),i=a.functionNum,u=a.tableCode,s=a.fieldCode,l=t.getUnionDatasource(),c=this._isTreeSumField(e,t)?l.getLeafFieldValues(u,s):l.getFieldValues(u,s),f=function(){var e=[];return c.forEach((function(t){isNaN(t)||e.push(parseFloat(t))})),e},h=null;switch(i){case 101:r=Ke(f()),n=c.length,o=Xe(),h=GC.Spread.Sheets.CalcEngine.evaluateFormula(o,`${r}/${n}`);break;case 103:h=c.length;break;case 102:h=f().length;break;case 104:h=function(e){var t=void 0;return e.forEach((function(e){(void 0===t||e>t)&&(t=e)})),t}(f());break;case 105:h=min(f());break;case 109:h=Ke(f())}return{type:"text",value:h}}},{key:"_isTreeSumField",value:function(e,t){var r=this.getConfig(),n=r.tableCode,o=r.fieldCode;return t.getUnionDatasource().isTreeSumField(n,o)}},{key:"_rangesToFormulaArgs",value:function(e){var t=n().Spread.Sheets.CalcEngine,r=t.RangeReferenceRelative.allRelative;return(0,t.rangesToFormula)(e,0,0,r,!1)}},{key:"_getSubTotalRanges",value:function(e,t){var r=[],o=t.getUnionDatasource(),a=this.getConfig(),i=a.tableCode,u=a.fieldCode,s=t.getDataCount(i),l=t.getFieldIndex(i,u),c=l.row,f=l.col,h=n().Spread.Sheets.Range;if(this._isTreeSumField(e,t)){var p=t.getDataIndex(i,u);o.getLeafRanges(i,p,p+s).forEach((function(e){r.push(new h(c+(e-p),f,1,1))}))}else r.push(new h(c,f,s,1));return r}},{key:"subTotal",value:function(e,t){var r=this._getSubTotalRanges(e,t);return{type:"formula",value:`SUBTOTAL(${this.getConfig().functionNum},${this._rangesToFormulaArgs(r)})`}}},{key:"execute",value:function(e,t){return t.isInGroupSumArea()?this.groupSubTotal(e,t):this.subTotal(e,t)}}]),r}(Be);function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ee(e);if(t){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oe(this,r)}}var tt=function(e){Ce(r,e);var t=et(r);function r(){return p(this,r),t.apply(this,arguments)}return y(r,[{key:"execute",value:function(e,t){return{type:"text",value:t.getTotalPages()}}}]),r}(Be),rt=function(e,t,r){return t.forEach((function(t){var n=function(e){var t=e.type;switch(t){case"cellImage":return new ze(e);case"cellSubTotal":return new $e(e);case"pageCellType":return new Ye(e);case"totalPagesCellType":return new tt(e);default:throw Error("未识别插件类型【"+t+"】，请检查！")}}(t);e=n.execute(e,r)})),e},nt=function(e,t){return e&&"formula"==e.type?function(e,t){if(be(e)){var r=Me(e);return r=He(r).parse(t),{type:"formula",value:e=GC.Spread.Sheets.CalcEngine.expressionToFormula(null,r,0,0)}}return{type:"formula",value:e}}(e.value,t):e},ot=function(e){return e?function(e){var t=[];if(be(e)){var r=Me(e),n=He(r),o=new Le({function:function(e){var r=e.getAST();if("TOONE.GET"==r.functionName){var n=r.arguments;return 2==n.length&&t.push(n[0].value),!1}}});n.visit(o)}return t}(e):[]};function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var it=function(){function e(t,r){p(this,e),A(this,"datas",[]),A(this,"references",[]),A(this,"treeStruct",{}),A(this,"treeDataIndexMap",{}),this.datasources=t,this.setting=r,this._anslysisSetting()}return y(e,[{key:"_containsTable",value:function(e){return-1!=this.datasources.indexOf(e)}},{key:"_analysisTreeStructSetting",value:function(){if(this.setting.treeStruct)for(var e=0,t=Object.entries(this.setting.treeStruct);e<t.length;e++){var r=W(t[e],2),n=r[0],o=r[1];this._containsTable(n)&&(this.treeStruct[n]=o)}}},{key:"_analysisReferenceSetting",value:function(){var e=this;this.setting.references&&this.setting.references.forEach((function(t){var r=t.foreignKey,n=t.references;e._containsTable(r.tableCode)&&e._containsTable(n.tableCode)&&e.references.push(t)}))}},{key:"_anslysisSetting",value:function(){this.setting&&(this._analysisTreeStructSetting(),this._analysisReferenceSetting())}},{key:"_toUniqueKey",value:function(e,t){return`${e},${t}`}},{key:"_isLeaf",value:function(e){return e.hasOwnProperty("isLeaf")?e.isLeaf:!e.children||0==e.children.length}},{key:"_treeStructDataEnhance",value:function(e){for(var t=this,r=function(){var r=W(o[n],2),a=r[0],i=r[1],u=e[a];if(u&&u.length>0){var s=i.sumFields,l=i.idField,c=i.pidField,f=i.leafField,h=i.sortField,p=i.sortType,d=t.treeDataIndexMap[a]||{};u.forEach((function(e){var t=e[l],r={data:e,children:[]};f&&(r.isLeaf=!!e[f]),d[t]=r})),t.treeDataIndexMap[a]=d;var v={data:null,children:[]};if(u.forEach((function(e){var t=e[l],r=e[c],n=d[r];n=n||v;var o=d[t];n.children.push(o)})),s&&s.length>0){var g=function e(r){if(!t._isLeaf(r)){var n=r.children||[];n.forEach((function(t){return e(t)}));var o=r.data;s.forEach((function(e){var t=[];n.forEach((function(r){var n=r.data[e];isNaN(n)||t.push(n)}));var r=Ke(t);o[e]=r}))}};v.children.forEach((function(e){return g(e)}))}if(h){!function e(t){var r=t.children;(r=r.sort((function(e,t){var r=e.data,n=t.data,o=r[h]-n[h];return"asc"==p?o:0-o}))).forEach((function(t){return e(t)})),t.children=r}(v)}e[a]=function e(t){var r=[];return t.forEach((function(t){r.push(t.data);var n=t.children;n&&n.length>0&&(r=r.concat(e(n)))})),r}(v.children)}},n=0,o=Object.entries(this.treeStruct);n<o.length;n++)r()}},{key:"_unitDataByReferences",value:function(e,t){var r=this,n=[];if(this.references){var o={};this.references.forEach((function(a){var i=a.references,u=a.foreignKey,s=i.tableCode,l=i.fieldCode;t.push(s);var c=r._toUniqueKey(s,l),f=o[c];f||(f={},o[c]=f,e[s].forEach((function(e){f[e[l]]=e})));var h=u.tableCode;t.push(h);var p=u.fieldCode;e[h].forEach((function(e){n.push(A(A({},h,e),s,f[e[p]]))}))}))}return n}},{key:"_unitDataByIndex",value:function(e,t,r){for(var n=0,o=Object.entries(e);n<o.length;n++){var a=W(o[n],2),i=a[0],u=a[1];if(-1==r.indexOf(i))for(var s=0,l=u.length;s<l;s++){var c=u[s],f=t[s]||{};f[i]=c,t[s]=f}}return t}},{key:"isTreeSumField",value:function(e,t){var r,n=this.treeStruct[e];return(null==n||null===(r=n.sumFields)||void 0===r?void 0:r.length)>0&&-1!=n.sumFields.indexOf(t)}},{key:"getLeafRanges",value:function(e,t,r){for(var n=this.treeDataIndexMap[e],o=[],a=this.setting.treeStruct[e].idField,i=t;i<=r;i++){var u=this.datas[i];if(u&&u[e]){var s=n[u[e][a]];this._isLeaf(s)&&o.push(i)}}return o}},{key:"load",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),r=[];this._treeStructDataEnhance(t);var n=this._unitDataByReferences(t,r);this.datas=this._unitDataByIndex(t,n,r)}},{key:"getCount",value:function(){return this.datas.length}},{key:"getValue",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.datas[r],o=null;if(n){var a,i=null===(a=n[e])||void 0===a?void 0:a[t];o=void 0===i?null:i}return{type:"text",value:o}}},{key:"getFieldValues",value:function(e,t){for(var r=[],n=this.getCount(),o=0;o<n;)r.push(this.getValue(e,t,o)),o++;return r}},{key:"getLeafFieldValues",value:function(e,t){var r=this.setting.treeStruct[e];if(r&&r.idField&&r.pidField){for(var n=[],o=this.treeDataIndexMap[e],a=r.idField,i=this.getCount(),u=0;u<i;u++){var s=this.datas[u];if(s&&s[e]){var l=o[s[e][a]];if(this._isLeaf(l)){var c=l.data,f=c?c[t]:null;n.push(f)}}}return n}return this.getFieldValues(e,t)}}]),e}();function ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function st(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var lt=n().Spread.Sheets;function ct(e){var t=e.sheet,r=e.dataTable,n=e.rules,o=e.spans,a=e.rows,i=e.rowCount,u=e.autoMergeRanges;if(t){var s=i>0?i:t.rowCount;t.data.dataTable=Object.keys(r).length?r:t.data.dataTable,t.rowCount=s,t.conditionalFormats=t.conditionalFormats?t.conditionalFormats:{},t.conditionalFormats.rules=n,t.spans=o,function(e,t){if(e.rows)return Object.keys(e.rows).forEach((function(t){delete e.rows[t]})),void Object.entries(t).forEach((function(t){var r=W(t,2),n=r[0],o=r[1];e.rows[n]=o}));e.rows=t}(t,a),t.autoMergeRangeInfos=u}}function ft(e){var t=e.templates,r=e.isCalcTemp,n=void 0!==r&&r,o=0;return t.forEach((function(e){for(var t=e.datas,r=e.dataTables,a=ht(t),i=n?1:a.getCount()||1,u=0;u<i;u++)r.forEach((function(e){var t=e.rows,r=void 0===t?{}:t;r.hasOwnProperty("size")?o+=null==r?void 0:r.size:o+=20}))})),{height:o}}function ht(e,t){var r=Object.fromEntries(e),n=new it(Object.keys(r),t);return n.load(r),n}function pt(e,t,r){var n=lt.AutoMerge.AutoMergeDirection.column,o=lt.AutoMerge.AutoMergeMode.free,a=lt.SheetArea.viewport,i=lt.AutoMerge.SelectionMode.merged;e.columnMerge&&e.rowMerge?n=lt.AutoMerge.AutoMergeDirection.rowColumn:e.rowMerge&&(n=lt.AutoMerge.AutoMergeDirection.row);var u={row:e.row-r,col:e.col,rowCount:null==e?void 0:e.rowCount,colCount:null==e?void 0:e.colCount};t.push({range:u,direction:n,mode:o,sheetArea:a,selectionMode:i})}function dt(e){return JSON.parse(JSON.stringify(e))}var vt=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;p(this,e),this.datas=r,this.reportJson=t,this.tempConfig=n,this.newSheets={},this.setting=o,this.templatesPageInfos={},this.delayPlugins=[],this.delayFormula=[],this.groupSumFooterTemplates=[],this.groupSumHeaderTemplates=[],this.hasGroupSumArea=!1,this.groupTemplate(),this.analysisTemplate(),Object.entries(this.newSheets).forEach((function(e){var r=W(e,2),n=r[0],o=r[1];t.sheets[n]=o,t.sheetCount+=1}));var a={};for(Object.values(t.sheets).forEach((function(e){a[e.name]=e})),t.sheets=a;this.delayPlugins.length;){this.delayPlugins.pop()()}for(;this.delayFormula.length;){this.delayFormula.pop()()}}return y(e,[{key:"render",value:function(e){var t=this,r=this.headerTemplates,n=this.footerTemplates,o=this.contentTemplates;if(e.pageArea){var a=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=ft({templates:t}).height,i=ft({templates:r}).height,u=ft({templates:o,isCalcTemp:!0}).height,s=a+i,l=e.pageTotalHeight;if(s>e.pageTotalHeight){var c=s%e.pageTotalHeight;c>=u&&(l=c)}else if(s<e.pageTotalHeight){var f=e.pageTotalHeight-s;f>=u&&(l=f)}var h=Math.floor(l/u);return{pageSubtotal:Math.ceil(n/h),lastContentTempCount:n%h,contentTempCount:h}};!function(r,n,i){for(var u,s=a(r,n,(null==o||null===(u=o[0])||void 0===u?void 0:u.dataLen)||1),l=s.pageSubtotal,c=s.lastContentTempCount,f=s.contentTempCount,h=0,p=0;h<l;){var d=h+1>=l;if(d){var v=a(t.groupSumHeaderTemplates,t.groupSumFooterTemplates,c),g=v.pageSubtotal,y=v.lastContentTempCount;v.contentTempCount,1===g?(r=t.groupSumHeaderTemplates,n=t.groupSumFooterTemplates,c=y,f=y):l+=1}t.genPageDataTables({templates:r,pageInfos:e});var m=p+f;d&&!e.isFillData&&(m=p+c),t.genPageDataTables({templates:o,pageInfos:e,startIndex:p,endIndex:m}),t.genPageDataTables({templates:n,pageInfos:e}),h+1<l&&t.onAfterPage(e),e.pageHeight=0,p+=f,h++}}(r,n)}else this.genPageDataTables({templates:r,pageInfos:e});ct(e)}},{key:"splitTemplate",value:function(e){var t=e.sheet,r=e.pageArea,n=e.groupSumArea,o=t.rowCount,a=void 0===o?200:o,i=[],u=[],s=[];this.groupSumHeaderTemplates=[],this.groupSumFooterTemplates=[];var l=/^\d+:\d+$/,c=a,f=a;if(r&&l.test(r)){var h=r.split(":");c=Number(h[0])-1,f=Number(h[1])}var p=a,d=a;if(n&&l.test(n)){var v=n.split(":");p=Number(v[0])-1,d=Number(v[1])}var g=null,y=0;do{var m,w=this.parseRowDataTable({row:y,sheet:t});if(y>=p&&y<d&&(w.isGroupSumArea=!0),g&&y<g.endRow)g.height+=w.height,(m=g.dataTables).push.apply(m,U(w.dataTables)),w.endRow>g.endRow&&(g.endRow=w.endRow,g.rowCount=g.endRow-g.row),w.datas.forEach((function(e,t){e.length>g.dataLen&&(g.dataLen=e.length),g.datas.set(t,e)})),w.isGroupSumArea&&(g.isGroupSumArea=w.isGroupSumArea);else g=w;y>=c&&y<f&&(g.endRow=f,g.rowCount=g.endRow-g.row),y+1===g.endRow&&(g.verticalAutoMergeRanges=[],g.dataTables.forEach((function(e){var t=e.mergeInfos,r=void 0===t?[]:t,n=r.length;if(n>0){for(var o=[],a=r[0],i=1;i<n;i++){var u=r[i];a.row===u.row&&a.rowCount===u.rowCount&&a.columnMerge===u.columnMerge&&a.rowMerge===u.rowMerge&&a.col+a.colCount===u.col?a.colCount+=u.colCount:(pt(a,o,g.row),a=u)}pt(a,o,g.row),e.autoMergeRanges=[],o.filter((function(t){t.range.rowCount===g.rowCount?g.verticalAutoMergeRanges.push(t):t.range.colCount>1&&e.autoMergeRanges.push(t)}))}})),g.row<c?(this.groupSumHeaderTemplates.push(g),g.isGroupSumArea?this.hasGroupSumArea=!0:i.push(g)):g.row>=f?(this.groupSumFooterTemplates.push(g),g.isGroupSumArea?this.hasGroupSumArea=!0:u.push(g)):s.push(g),g=null),y++}while(y<a);this.headerTemplates=i,this.footerTemplates=u,this.contentTemplates=s}},{key:"setTemplateDatas",value:function(e,t,r){var n,o,a=(null===(n=this.datas)||void 0===n?void 0:n[t])||[],i=this.nameMaps[r],u=null===(o=this.groupsDatas)||void 0===o||null===(o=o[r])||void 0===o||null===(o=o[t])||void 0===o?void 0:o[i];Array.isArray(u)&&(a=u),e.datas.has(t)||(e.datas.set(t,dt(a)),a.length>e.dataLen&&(e.dataLen=a.length))}},{key:"parseRowDataTable",value:function(e){var t,r,n=this,o=e.row,a=e.sheet,i=a.name,u=a.spans,s=void 0===u?[]:u,l=a.data,c=void 0===l?{}:l,f=a.rows,h=void 0===f?{}:f,p=a.conditionalFormats,d=void 0===p?{}:p,v=(null==d?void 0:d.rules)||[],g=(null==c?void 0:c.dataTable)||{},y=(null==g?void 0:g[o])||{},m=function(e){var t=e.rules,r=e.row,n=t;return Number.isFinite(r)&&r>=0&&(n=t.filter((function(e){return e.ranges.some((function(e){var t=e.row,n=e.rowCount;return t<=r&&r<t+n}))}))||[]),n}({rules:v,row:o}),w={spans:[],mergeInfos:[],rules:[],rows:null,rowDataTable:y},b={row:o,endRow:o+1,rowCount:1,datas:new Map,dataTables:[w],dataLen:0,height:0,isGroupSumArea:!1},S=1,C=s.filter((function(e){return e.row===o&&(e.rowCount>S&&(S=e.rowCount),!0)}));return(t=w.spans).push.apply(t,U(C)),w.rows=function(e,t){return(null==e?void 0:e[t])||{size:20}}(h,o),b.height=null==w||null===(r=w.rows)||void 0===r?void 0:r.size,Object.entries(y).forEach((function(e){var t,r=W(e,2),a=r[0],u=r[1],s=u.bindingPath,l=u.tag,c=u.formula,f=u.style,h=void 0===f?{}:f,p=Number(a);if(null==s||null===(t=s.includes)||void 0===t?void 0:t.call(s,".")){var d=s.split(".")[0];n.setTemplateDatas(b,d,i);var v=C.find((function(e){return e.col===p}))||{rowCount:1,colCount:1};if(l){var g=JSON.parse(l),y=g.columnMerge||!1,S=g.rowMerge||!1;(y||S)&&w.mergeInfos.push(st(st({},v),{},{row:o,col:p,columnMerge:y,rowMerge:S}))}}if(c){var O=ot(c);Array.isArray(O)&&O.forEach((function(e){n.setTemplateDatas(b,e,i)}))}null!=h&&h.decoration&&(null==h||delete h.decoration),function(e){var t=e.rules,r=e.col,n=e.colHandler,o=t;Number.isFinite(r)&&r>=0&&(o=o.filter((function(e){var t=e.ranges.some((function(e){var t=e.col,n=e.colCount;return t<=r&&r<t+n}));return t&&"function"==typeof n&&n(dt(e)),t})))}({rules:m,col:p,colHandler(e){w.rules.push(st({},e))}})})),b.rowCount=S,b.endRow=b.row+S,b}},{key:"groupTemplate",value:function(){var e=this.reportJson,t=this.datas,r=this.tempConfig,n=e.sheetCount,o=[],a={},i={},u=st({},r);Object.entries(r).forEach((function(r){var s,l=W(r,2),c=l[0],f=l[1],h=null==f?void 0:f.groups;if(h){var p=u[c],d={};Object.entries(h).some((function(e){var r=W(e,2),n=r[0],o=r[1];d[n]={};var a=t[n];if(Array.isArray(a)&&Array.isArray(o)&&o.length){var i,u=null==o||null===(i=o[0])||void 0===i?void 0:i.code;a.forEach((function(e){var t=e[u];Array.isArray(d[n][t])||(d[n][t]=[]),d[n][t].push(e)}))}}));var v=null==e||null===(s=e.sheets)||void 0===s?void 0:s[c];if(v&&0!==v.visible){var g=JSON.stringify(v),y=Object.values(d)[0],m=Object.keys(y);m.forEach((function(t,r){for(var s=t,l=1;e.sheets[s];)s=`${t}${l++}`;for(;m.includes(s)&&s!==t||o.includes(s);)s=`${t}${l++}`;if(s!==t){var f=d[t];delete d[t],d[s]=f}if(o.push(s),i[s]=d,a[s]=t,r<=0)v.name=s;else{var h=JSON.parse(g);h.name=s,h.isSelected=!1,h.index=n++,h.order=h.index,e.sheets[s]=h,e.sheetCount+=1}u[s]=st(st({},p),{},{fromTempSheet:c})}))}return!0}})),this.template=u,this.groupsDatas=i,this.nameMaps=a}},{key:"analysisTemplate",value:function(){var e=this;Object.values(this.reportJson.sheets).forEach((function(t){var r,n,o=t.name,a=t.visible,i=void 0===a?1:a,u=t.data,s=t.printInfo,l=s.paperSize,c=l.height,f=void 0===c?1100:c,h=l.width,p=void 0===h?850:h,d=s.orientation,v=s.margin,g=void 0===v?{bottom:75,footer:30,header:30,left:70,right:70,top:75}:v;if(0!==i){var y=g.bottom,m=g.footer,w=g.header,b=g.top,S=g.left,C=g.right,O=e.template[o],E="",A=!1,k="",x=null==u||null===(r=u.defaultDataNode)||void 0===r?void 0:r.tag;if(x){var T=JSON.parse(x);E=(null==T?void 0:T.pageArea)||"",A=null==T?void 0:T.isFillData,k=(null==T?void 0:T.groupSumArea)||""}null!=t&&null!==(n=t.rowHeaderData)&&void 0!==n&&n.dataTable&&(t.rowHeaderData.dataTable={}),e.splitTemplate({sheet:t,pageArea:E,groupSumArea:k});var M=0;M=2===d?p-S-m-w-C:f-y-m-w-b;var P=!!O,j=null==O?void 0:O.fromTempSheet;P&&(e.templatesPageInfos[j]||(e.templatesPageInfos[j]={pageIndex:0,pageTotal:0}),e.templatesPageInfos[j].pageIndex+=1,e.templatesPageInfos[j].pageTotal+=1);var I={sheet:t,spans:[],rows:{},rules:[],dataTable:{},autoMergeRanges:[],rowCount:0,pageIndex:1,pageTotal:1,pageArea:E,pageTotalHeight:M,pageHeight:0,isFillData:A,isCurrentSheet:null==O?void 0:O.isCurrentSheet,isTemplate:P,cobySheet:JSON.stringify(t),page:{},fromTempSheet:j};e.render(I)}}))}},{key:"getSheetCount",value:function(){return this.reportJson.sheetCount+Object.keys(this.newSheets).length}},{key:"genPageDataTables",value:function(e){var t=this,r=e.templates,n=e.pageInfos,o=e.startIndex,a=void 0===o?0:o,i=e.endIndex,u=void 0===i?0:i;r.forEach((function(e){var r=e.datas,o=e.dataTables,i=e.height,s=e.isGroupSumArea,l=e.verticalAutoMergeRanges,c=ht(r,t.setting),f=u||c.getCount()||1;(l=dt(l)).forEach((function(e){e.range.row=n.rowCount}));for(var h=n.page,p=n.rowCount,d=a,v=function(e){n.pageArea&&(n.pageHeight+i>n.pageTotalHeight?(p=n.rowCount,d=e,t.onAfterPage(n,i)):n.pageHeight+=i),o.forEach((function(r){var o=r.rows,a=void 0===o?{}:o,i=r.rowDataTable,u=r.spans,l=void 0===u?[]:u,f=r.rules,v=void 0===f?[]:f,g=r.autoMergeRanges,y=void 0===g?[]:g,m=dt(i);if(Object.entries(m).forEach((function(r){var o,a=W(r,2),i=a[0],u=a[1],l=Number(i),f=u.bindingPath,v=u.tag,g=u.formula;if(null!=f&&null!==(o=f.includes)&&void 0!==o&&o.call(f,".")){var y=W(f.split("."),2),m=y[0],w=y[1];delete u.bindingPath;var b=c.getValue(m,w,e),S=b.type,C=b.value;"text"===S&&(u.value=C)}var O=new Ge;if(O.setGroupNameHandler((function(){return n.sheet.name})),O.setIsGroupSumAreaHandler((function(){return s})),v){var E=JSON.parse(v),A=E.instanceId;h[n.pageIndex]=h[n.pageIndex]||{},h[n.pageIndex][A]=h[n.pageIndex][A]||{};var k=h[n.pageIndex][A];k.row=p,k.col=l,k.count=k.count||0,k.count+=1,k.dataIndex=d,k.unionDatasource=c;var x=E.hyperlinkInfo||{};"document"===(null==x?void 0:x.type)&&null!=x&&x.isAutoDoc&&(u.hyperlink.url=`sjs://${u.value}!A1`,u.hyperlink.tooltip&&(u.hyperlink.tooltip=u.value));var T=E.plugins;if(Array.isArray(T)){let e=function(){var e,t=null==h||null===(e=h[j])||void 0===e?void 0:e[M];O.setFieldIndexHandler((function(){return{row:null==t?void 0:t.row,col:null==t?void 0:t.col}})),O.setDataCountHandler((function(){return null==t?void 0:t.count})),O.setDataIndex((function(){return null==t?void 0:t.dataIndex})),O.setUnionDatasourceHandler((function(){return null==t?void 0:t.unionDatasource}));var r=function(e,t,r){return rt(e,t,r)}({type:"text",value:u.value},T,O),n=r.type,o=r.value;u["formula"===n?n:"value"]=o};var M="",P=T.some((function(e){var t=e.type,r=e.config;return"cellSubTotal"===t&&(M=null==r?void 0:r.instanceId),["cellSubTotal"].includes(t)})),j=n.pageIndex;P?t.delayPlugins.push(e):e()}}var I=n.pageIndex,R=n.fromTempSheet;t.templatesPageInfos[R]&&(I=t.templatesPageInfos[R].pageIndex);var D,F=(D=I,function(){return D});if(g){t.delayFormula.push((function(){O.setPageHandler(F),O.setTotalPagesHandler((function(){return t.templatesPageInfos[R]?t.templatesPageInfos[R].pageTotal:n.pageTotal})),O.setValueHandler((function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return 1===n.length?{type:"text",value:t.datas[n[0]]}:c.getValue(n[0],n[1],e)}));var r=nt({type:"formula",value:g},O),o=r.type,a=r.value;u["formula"===o?o:"value"]=a}))}})),n){var w=n.rowCount;n.dataTable[w]=m,l.forEach((function(e){n.spans.push(st(st({},e),{},{row:w}))})),v.forEach((function(e){n.rules.push(st(st({},e),{},{ranges:[st(st({},e.ranges[0]),{},{row:w})]}))})),n.rows[w]=a,y.forEach((function(e){var t=dt(e);t.range.row=w,n.autoMergeRanges.push(t)})),n.rowCount+=1}}))},g=a;g<f;g++)v(g);l.forEach((function(e){e.range.rowCount=n.rowCount-e.range.row,n.autoMergeRanges.push(e)}))}))}},{key:"onAfterPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.isTemplate&&!e.isCurrentSheet)ct(e),e.sheet=JSON.parse(e.cobySheet),e.sheet.name+=`_${e.pageIndex}`,e.sheet.index=this.getSheetCount(),e.sheet.isSelected=!1,this.newSheets[e.sheet.name]=e.sheet,e.dataTable={},e.spans=[],e.rows={},e.rules=[],e.autoMergeRanges=[],e.rowCount=0;else{var r=e.pageTotalHeight-e.pageHeight;if(r>0){var n=e.rowCount;e.dataTable[n]={},e.rows[n]={size:r},e.rowCount+=1}}e.pageHeight=t,e.pageIndex+=1,e.pageTotal+=1,null!=e&&e.fromTempSheet&&(this.templatesPageInfos[null==e?void 0:e.fromTempSheet].pageIndex+=1,this.templatesPageInfos[null==e?void 0:e.fromTempSheet].pageTotal+=1)}}]),e}(),gt=null,yt=function(){var e,t=n();try{(new t.Spread.Sheets.Workbook).getSheet(0).setValue(0,0,"test")}catch(r){return{success:!1,showError:!0}}return e=location.hostname,/^(127\.0\.0\.1|localhost)/g.test(e)?{success:!1,showWarn:!0}:{success:!0}};function mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var bt=n().Spread.Sheets;function St(e,t,r,n){if(!e)return{datas:[],spansTree:[]};var o=t.map((function(e){return e.code})),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.length>0?function e(t,r){var n=U(r),o=new Map,a=n.shift();return t.forEach((function(e){var t=e[a];o.has(t)||o.set(t,{groupName:t,groupCode:a,allChildrens:[]}),o.get(t).allChildrens.push(e)})),o.forEach((function(t){n.length>0&&t.allChildrens.length>0&&(t.childrenGroups=e(t.allChildrens,n))})),o}(e,t):void 0;return new Map([["总",{groupName:"总",groupCode:null,allChildrens:U(e),childrenGroups:r}]])}(e,o),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=[],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).map((function(e){return e.code})),a=o.length>0,i=r.filter((function(e){var r=e.code;return!t.includes(r)&&!o.includes(r)})),u=i.length,s=function e(r){var s=null,l=0,c=[];return r.forEach((function(r,f,h){var p={children:[],verticalSpans:[]},d=r.childrenGroups,v=r.allChildrens,g=r.groupCode,y=r.groupName,m=0,w=t.indexOf(g);if(d){var b,S=e(d);s=S.lastChild,m+=S.totalRowCount,l+=S.totalRowCount,(b=p.children).push.apply(b,U(S.spansTree))}else v.forEach((function(e){s=e;var r=[];if(a){var c={};t.forEach((function(t){c[t]=e[t]}));for(var f=function(){var t=i[h].code;c[t]=e[t];var n=i[h+1].code,a=wt(wt({},c),{},A({},n,"小计"));o.forEach((function(t){var r=Number(e[t]);e[t]=Number.isNaN(r)?0:r,Object.defineProperty(a,t,{get:()=>e[t]})})),r.unshift(a),p.verticalSpans[h]||(p.verticalSpans[h]=[]),p.verticalSpans[h].push({rowCount:u-h,col:w+h+1,colCount:1,row:0,subtotalSpan:{rowCount:1,col:w+h+1+1,colCount:u-h-1,row:0},style:{vAlign:1}}),m++,l++},h=0;h<u-1;h++)f()}m++,l++,n.push.apply(n,[e].concat(r))}));var C={};if(g){if(a){var O=t.indexOf(g);t.forEach((function(e,t){t<=O&&(C[e]=s[e])}));var E=t[O+1];O+1===t.length&&(E=i[0].code),C[g]=y,C[E]="小计",p.subtotalSpan={row:0,col:O+1,rowCount:1,colCount:u+(t.length-O)-1},m++,l++}var k={rowCount:m,col:w,colCount:1,row:0,style:{vAlign:1}};p=wt(wt({},p),k)}else a&&(C[t[0]||(null==i?void 0:i[0].code)]="小计",p=wt(wt({},p),{},{row:l,rowCount:1,col:0,colCount:t.length+u,isTotal:!0}));a&&(o.forEach((function(e){Object.defineProperty(C,e,{get:()=>v.reduce((function(t,r){return t+r[e]}),0)})})),n.push(C)),c.push(p)})),{lastChild:s,totalRowCount:l,spansTree:c}}(e),l=s.spansTree;return{datas:n,spansTree:l}}(a,o,r,n);return{datas:i.datas,spansTree:i.spansTree}}var Ct=n().Spread.Sheets,Ot=ce({position:"relative",width:"100%",height:"100%",overflow:"visible",userSelect:"none"}),Et=function(e,t,r){if(r){var o=n().Spread.Sheets.Events[t];e.bind(o,r)}},At=function(e){var t=e.spread,r=e.dataSource,n=e.sumColumns,o=e.groupColumns,a=e.rowMerge,i=e.columnMerge,u=e.rowMergeColumns,s=void 0===u?{}:u,l=e.colMergeColumns,c=void 0===l?{}:l;t&&t.sheets.forEach((function(e){var t,u=JSON.parse(JSON.stringify(r)),l=e.tables.all(),f=[],h=[],p=null;u&&(p=new Ct.Bindings.CellBindingSource(u),e.setDataSource(p)),l.length>0&&l.forEach((function(e){var t=e.name(),r=o[t],a=n[t],i=s[t]||[],l=c[t]||[];if(Array.isArray(r)&&r.length>0||Array.isArray(a)&&a.length>0){var p=e.bindingPath(),d=e.range(),v=d.row,g=d.col,y=[];if(e.BSt.forEach((function(e){y.push({code:e.dataField()})})),null!=u&&u[p]){var m=St(u[p],r,y,a),w=m.datas,b=m.spansTree;u[p]=w;var S=function(e){var t=[],r={};return function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=o;n.forEach((function(n){var u=n.row,s=void 0===u?0:u,l=n.col,c=void 0===l?0:l,f=n.rowCount,h=void 0===f?1:f,p=n.colCount,d=void 0===p?1:p,v=n.children,g=void 0===v?[]:v,y=n.verticalSpans,m=void 0===y?[]:y,w=n.subtotalSpan,b=n.isTotal,S=void 0!==b&&b;if(g.length>0&&e(g,i),m.length>0&&m.forEach((function(e,n){var o=i;e.forEach((function(e){if(e.hasOwnProperty("style")){var i=e.col,u=e.style;r[o]||(r[o]={}),r[o][i]||(r[o][i]={}),r[o][i].style=wt({},u)}t.push({row:o,col:e.col+a,rowCount:e.rowCount,colCount:e.colCount}),e.subtotalSpan.colCount>1&&t.push({row:o+e.rowCount-1,col:e.subtotalSpan.col+a,rowCount:e.subtotalSpan.rowCount,colCount:e.subtotalSpan.colCount}),o+=e.rowCount+n}))})),n.hasOwnProperty("style")){var C=n.col,O=n.style;r[i]||(r[i]={}),r[i][C]||(r[i][C]={}),r[i][C].style=wt({},O)}n.hasOwnProperty("row")&&((h>1||d>1)&&(S?t.push({row:s+o,col:c+a,rowCount:h,colCount:d}):t.push({row:i,col:c+a,rowCount:h,colCount:d})),w&&t.push({row:i+h-1,col:w.col+a,rowCount:w.rowCount,colCount:w.colCount}),i+=h)}))}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),{spans:t,dataTableStyle:r}}(b,v+1,g);f.push.apply(f,U(S.spans))}}if(i.length>0||l>0){var C=e.BSt.map((function(e){return{id:e.id(),code:e.dataField(),name:e.name()}})),O=e.range(),E=function(e){var t=e.rowMergeColumns,r=e.colMergeColumns,n=e.tableColumns,o=e.row,a=void 0===o?0:o;e.col;var i=e.rowCount,u=void 0===i?0:i,s=[];if(t.length||r.length){var l=t.map((function(e){return wt(wt({},e),{},{rowMerge:!0,colMerge:!1})}));r.forEach((function(e){var t=l.find((function(t){return t.code===(null==e?void 0:e.code)}));t?t.colMerge=!0:l.push(wt(wt({},e),{},{rowMerge:!1,colMerge:!0}))})),l.sort((function(e,t){return n.findIndex((function(t){return t.code===e.code}))-n.findIndex((function(e){return e.code===t.code}))}));var c=l[0],f=c.rowMerge,h=c.colMerge,p=bt.AutoMerge.AutoMergeDirection.column,d=bt.AutoMerge.AutoMergeMode.free,v=bt.SheetArea.viewport,g=bt.AutoMerge.SelectionMode.merged;f&&h?p=bt.AutoMerge.AutoMergeDirection.rowColumn:f&&(p=bt.AutoMerge.AutoMergeDirection.row);var y={row:a,col:-1,rowCount:u,colCount:1},m=-1;l.forEach((function(e){var t=e.code,r=e.rowMerge,o=e.colMerge,a=n.findIndex((function(e){return e.code===t}));-1===y.col?y.col=a:m+1===a&&f===r?y.colCount+=1:(s.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g}),f=r,y={row:1,col:a,rowCount:u+1,colCount:1},p=bt.AutoMerge.AutoMergeDirection.column,r&&o?p=bt.AutoMerge.AutoMergeDirection.rowColumn:r&&(p=bt.AutoMerge.AutoMergeDirection.row)),m=a})),(s.length>0&&s[s.length-1]!==y&&y.col>-1||s.length<=0&&y.col>-1)&&s.push({range:y,direction:p,mode:d,sheetArea:v,selectionMode:g})}return s}({rowMergeColumns:i,colMergeColumns:l,tableColumns:C,row:O.row+1,rowCount:O.rowCount});h.push.apply(h,U(E))}}));var d=e.toJSON();d.spans=Array.isArray(d.spans)?d.spans:[],(t=d.spans).push.apply(t,f),d.autoMergeRangeInfos=h,e.fromJSON(d),p&&e.setDataSource(p),function(e){var t=e.sheet,r=e.rowMerge,n=e.columnMerge,o=t.tables.all();if(o.length>0&&(r||n)){var a=Ct.AutoMerge.AutoMergeDirection.column,i=Ct.AutoMerge.AutoMergeMode.free,u=Ct.SheetArea.viewport,s=Ct.AutoMerge.SelectionMode.merged;r&&n?a=Ct.AutoMerge.AutoMergeDirection.rowColumn:r&&(a=Ct.AutoMerge.AutoMergeDirection.row),t.suspendPaint(),o.forEach((function(e){var r=e.range();t.autoMerge(r,a,i,u,s)})),t.resumePaint()}}({sheet:e,rowMerge:a,columnMerge:i})}))};function kt(t){var a=t.newTabVisible,u=void 0===a||a,s=t.tabEditable,l=void 0===s||s,c=t.tabStripVisible,f=void 0===c||c,h=t.onInited,p=t.onEnterCell,d=t.onActiveSheetChanged,v=t.onValueChanged,g=t.onSelectionChanged,y=t.onSelectionChanging,m=t.onEditorStatusChanged,w=t.onSheetNameChanged,b=t.onSheetNameChanging,S=t.onActiveSheetChanging;t.onFetchData;var C=t.onRowChanged,O=t.onUndo,E=t.onRedo,A=t.license,k=t.enablePrint,T=void 0!==k&&k,M=t.json,P=void 0===M?null:M,j=t.onPrintHandler,I=t.children,R=t.baseUrl,F=t.dataSource,N=void 0===F?null:F,H=t.sumColumns,L=void 0===H?[]:H,G=t.groupColumns,B=void 0===G?[]:G,U=t.rowMerge,J=void 0!==U&&U,Q=t.columnMerge,z=void 0!==Q&&Q,Y=t.rowMergeColumns,_=void 0===Y?{}:Y,X=t.colMergeColumns,K=void 0===X?{}:X,q=t.template,$=t.setting;A&&function(e){gt=e}(A),R&&(r=R);var ee=n(),te=gt||"593811994558535#B1dWhJlMLFTUwpXTsV6L03kcLpmNkR5VklDTz9mdnh4SmJ6c98WU9QEVrNDO5kTNOpUb9B7d9l5NjlWWsxmU9hHNmVTb9p5dU5UZmRkZXJlR4d5MENkVat4RKNWZMVlcuNmbph6SxYTUyoVcFBFeIlTe5QFSYhjShpneohmVoZTVhdFdBJGOuFDMsVDW8RjZrB5aQlFbSZVS48UNr5mY62EZ4UWYTFGbxpWZVBVMo3iaCZVNrcmYxlDZzIkWmNVc5FVRCl5KFFDMvMmSjRUUKpkTRRTdV3GOHZVY5llY9IUez2kTalFShN6cjFEOXZEeuVHcWxmWZtWViojITJCLiEkMygjR5UjI0ICSiwCO7YTMxYjM6ATM0IicfJye#4Xfd5nIVF4SRJiOiMkIsIyNx8idgMlSgQWYlJHcTJiOi8kI1tlOiQmcQJCLigDNyADOwAiNxQDM4IDMyIiOiQncDJCLiEjLw8CMucjMxIiOiMXbEJCLig1jlzahlDZmpnInmz9unHZvnfLsonLvlb1kpfbtmD0jnLiOiEmTDJCLiUzM5gTN5QTO9ETM8MTO5IiOiQWSiwSfdtlOicGbmJCLlNHbhZmOiI7ckJye0ICbuFkI1pjIEJCLi4TP7pXe62iNw34KDl5RVpHO8dVW7UESQN7Zl3ycj36V4NzbGJENV5kTtJDdEVjQjFnbutyRVhleuV6ZFVkRZxUdQZmdJlFZHpXWmhWYTZGSIF6LUJjdhZTMjNVVltbcYR";te&&(ee.Spread.Sheets.LicenseKey=te);var ne=W(e.useState((function(){var e=yt(),t=!1,r=!1;return e.success||(t=e.showError,r=e.showWarn),{spread:null,showError:t,showWarn:r}})),1)[0],oe=e.useRef(null),ae=e.useMemo((function(){var e=JSON.parse(JSON.stringify(P));return e&&N&&new vt(e,N,q,$),{json:e}}),[P,N,JSON.stringify(q),JSON.stringify($)]).json,ie=function(){var e=x(D.mark((function e(){var t,r,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!T){e.next=4;break}return t=i("print"),e.next=4,V.loadScript(t);case 4:if(ne.spread||!oe.current||oe.showError){e.next=9;break}return r=n(),o=new r.Spread.Sheets.Workbook(oe.current,{sheetCount:0,newTabVisible:u,tabEditable:l,tabStripVisible:f}),ne.spread=o,e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(){if(ne.spread){var e=ne.spread;e.unbindAll(),function(e,t){if(e&&t)for(var r=0,n=Object.entries(t);r<n.length;r++){var o=W(n[r],2),a=o[0],i=o[1];Et(e,a,i)}}(e,{EnterCell:p,ActiveSheetChanged:d,ValueChanged:v,ActiveSheetChanging:S,SheetNameChanged:w,SheetNameChanging:b,SelectionChanged:g,SelectionChanging:y,EditorStatusChanged:m,WorkbookUndo:O,WorkbookRedo:E,RowChanged:C})}},se=function(e){if(ne.spread){var t=ne.spread;o(t,e?function(){t.fromJSON(e),fe();var r=t.sheets;r&&r.length>0&&r.forEach((function(e){e.options.sheetAreaOffset={left:1,top:1},e.recalcAll(!0)}))}:function(){var e;e=I?Array.isArray(I)?I:[I]:[],t.clearSheets();var r=n();e.forEach((function(e,n){var o=e.props,a=o.name,i=void 0===a?`Sheet${n+1}`:a,u=o.rowCount,s=void 0===u?20:u,l=o.colCount,c=void 0===l?20:l,f=new r.Spread.Sheets.Worksheet(i);f.options.sheetAreaOffset={left:1,top:1},f.setRowCount(s),f.setColumnCount(c),t.addSheet(n,f)}))})}},le=function(){if(ne.spread){var e=ne.spread;N&&At({spread:e,dataSource:N,sumColumns:L,groupColumns:B,rowMerge:J,columnMerge:z,rowMergeColumns:_,colMergeColumns:K})}},ce=function(){if(ne.spread){var e=ne.spread;j&&j((function(t){return new Promise((function(r,o){e?T?(e.sheets.forEach((function(e){!function(e,t){var r=t.orientation,o=t.printQuality,a=t.scaleType,i=t.fitPagesTall,u=t.fitPagesWide,s=t.zoomFactor,l=t.firstPageNumber,c=t.paperKind,f=t.margin,h=t.headerAndFooter,p=t.showGridLine,d=t.showHeader,v=t.blackAndWhite,g=t.pageOrder,y=t.showBorder,m=t.rowStart,w=t.rowEnd,b=t.columnStart,S=t.columnEnd,C=e.printInfo(),O=function(e,t){we(e)||("string"==typeof t?C[t](e):t(e))};O(r,"orientation"),O(o,"qualityFactor"),we(a)||(1==a?(i=-1,u=-1,s/=100):0==a&&(s=1),C.zoomFactor(s),C.fitPagesWide(u),C.fitPagesTall(i)),O(l,"firstPageNumber"),O(c,(function(){var e=new(n().Spread.Sheets.Print.PaperSize)(parseInt(c));C.paperSize(e)})),O(f,(function(){var e=f.left,t=f.right,r=f.top,o=f.bottom,a=f.header,i=f.footer,u=f.centering;C.margin({left:100*e,right:100*t,top:100*r,bottom:100*o,header:100*a,footer:100*i});var s=null,l=n();s=null!=u&&u.horizontally?null!=u&&u.vertically?l.Spread.Sheets.Print.PrintCentering.both:l.Spread.Sheets.Print.PrintCentering.horizontal:null!=u&&u.vertically?l.Spread.Sheets.Print.PrintCentering.vertical:l.Spread.Sheets.Print.PrintCentering.none,C.centering(s)})),O(null==h?void 0:h.pageHeaderFooter,"pageHeaderFooter"),O(p,"showGridLine"),O(d,(function(){var e=n(),t=d?e.Spread.Sheets.Print.PrintVisibilityType.show:e.Spread.Sheets.Print.PrintVisibilityType.hide;C.showRowHeader(t),C.showColumnHeader(t)})),O(v,"blackAndWhite"),O(g,"pageOrder"),O(y,"showBorder"),m=-1==m||we(m)?0:m,C.rowStart(m),w=-1==w||we(w)?e.getRowCount():w,C.rowEnd(w),b=-1==b||we(b)?0:b,C.columnStart(b),S=-1==S||we(S)?e.getColumnCount():S,C.columnEnd(S),e.printInfo(C)}(e,t||{})})),e.print(),r()):o(Error("打印失败，原因：初始化报表时未开启打印功能")):o(Error("打印失败，原因：报表未初始化"))}))}))}},fe=function(){var e=ne.spread;e.suspendEvent(),e.suspendCalcService(!1),re(ne.spread),e.resumeEvent(),e.resumeCalcService(!0)};return e.useEffect((function(){x(D.mark((function e(){var t;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:e.sent?(ue(),se(ae),le(),ce(),h?(t=h(ne.spread))&&t.then&&t.then((function(e){se(e),fe()})):fe()):fe();case 4:case"end":return e.stop()}}),e)})))()}),[ae,N,p,d,v,S,w,b,g,y,m,O,E]),Z.jsxs(Ot,{children:[ne.showError?Z.jsx(ge,{}):Z.jsx("div",{style:{width:"100%",height:"100%",overflow:"visible",userSelect:"none"},ref:oe}),!ne.showError&&ne.showWarn?Z.jsx(me,{}):null]})}var xt=["onInited","ready","dataSource"];function Tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pt=function(){function r(e){p(this,r),A(this,"conf",{}),A(this,"spread",null),A(this,"printHandler",null),this.conf=e}return y(r,[{key:"mount",value:function(r){var a,i,u,s,l,c=this;n().Spread.Common.CultureManager.culture("zh-cn");var f=this.conf||{},h=f.onInited,p=f.ready,d=f.dataSource,v=E(f,xt),g=null===(a=this.conf)||void 0===a||null===(a=a.json)||void 0===a?void 0:a.reportJson;g&&(g=JSON.parse(JSON.stringify(g)));var y=(null===(i=this.conf)||void 0===i||null===(i=i.json)||void 0===i||null===(i=i.context)||void 0===i?void 0:i.tableDesignSlice)||{},m=y.rowMerge,w=y.columnMerge,b=((null===(u=this.conf)||void 0===u?void 0:u.event)||{}).onFetchData,S=(null===(s=this.conf)||void 0===s||null===(s=s.json)||void 0===s||null===(s=s.context)||void 0===s?void 0:s.datasourceSlice)||{},C=S.sumColumns,A=S.tableGroups,k=S.rowMergeColumns,x=void 0===k?{}:k,T=S.colMergeColumns,M=void 0===T?{}:T;t.createRoot(r).render(e.createElement(kt,Mt(Mt({onInited:function(e){c.spread=e,h&&h(e),"function"==typeof p&&o(e,(function(){p(new O(e))}))},onPrintHandler:function(e){c.printHandler=e},baseUrl:null===(l=this.conf)||void 0===l?void 0:l.baseUrl,onFetchData:b,rowMerge:m,columnMerge:w,sumColumns:C,groupColumns:A,rowMergeColumns:x,colMergeColumns:M,dataSource:d},v),{},{json:g})))}},{key:"exportExcel",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreFormula:!1,ignoreStyle:!1};return new Promise((function(o,a){"string"==typeof e&&""!==e.trim()?(e=e.endsWith(".xlsx")?e:e+".xlsx",V.loadScript(i("excel")).then((function(){var i=new(n().Spread.Excel.IO),u=JSON.stringify(t.spread.toJSON());i.save(u,(function(t){L(t,e),o()}),(function(e){a(e)}),{columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeBindingSource:!1,includeCalcModelCache:!1,includeEmptyRegionCells:!0,includeFormulas:!r.ignoreFormula,includeStyles:!r.ignoreStyle,includeUnusedNames:!0,password:void 0,rowHeadersAsFrozenColumns:!1,saveAsView:!1})}))):a(Error("导出excel失败，原因:没有传递导出文件名"))}))}},{key:"exportPdf",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{persistence:!0,author:"",creator:"",keywords:"",subject:"",title:"",sheetIndex:null};return new Promise((function(o,a){if("string"==typeof e&&""!==e.trim()){e=e.endsWith(".pdf")?e:e+".pdf";var u=function(){var n=r.persistence,i=r.author,u=r.creator,s=r.keywords,l=r.subject,c=r.title,f=r.sheetIndex;t.spread.savePDF((function(t){n&&L(t,e),o(t)}),(function(e){a(e)}),{author:i,creator:u,keywords:s,subject:l,title:c},null==f?void 0:f)};n().Spread.Sheets.PDF?u():V.loadScript(i("pdf")).then(u)}else a(Error("导出pdf失败，原因:没有传递导出文件名"))}))}},{key:"print",value:function(e){var t=this;return new Promise((function(r,n){t.printHandler?t.printHandler(e).then(r).catch(n):n(Error("打印失败，原因：报表未初始化"))}))}}]),r}();return{FontStyle:{normal:"normal",italic:"italic"},FontWeight:{normal:"normal",bold:"bold"},HAlign:f,LineBorder:m,LineStyle:c,Preview:Pt,VAlign:h,WorkBook:O,WorkSheet:C}}));
